var hh=Object.create;var Gn=Object.defineProperty;var vh=Object.getOwnPropertyDescriptor;var gh=Object.getOwnPropertyNames;var mh=Object.getPrototypeOf,yh=Object.prototype.hasOwnProperty;var h=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),_h=(e,t)=>{for(var r in t)Gn(e,r,{get:t[r],enumerable:!0})},$o=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of gh(t))!yh.call(e,i)&&i!==r&&Gn(e,i,{get:()=>t[i],enumerable:!(n=vh(t,i))||n.enumerable});return e};var Rt=(e,t,r)=>(r=e!=null?hh(mh(e)):{},$o(t||!e||!e.__esModule?Gn(r,"default",{value:e,enumerable:!0}):r,e)),Ch=e=>$o(Gn({},"__esModule",{value:!0}),e);var E=(e,t,r)=>new Promise((n,i)=>{var s=u=>{try{o(r.next(u))}catch(c){i(c)}},a=u=>{try{o(r.throw(u))}catch(c){i(c)}},o=u=>u.done?n(u.value):Promise.resolve(u.value).then(s,a);o((r=r.apply(e,t)).next())});var ls=h(Bo=>{var Vo=require("url"),Eh=require("child_process").spawn,ur=require("fs");Bo.XMLHttpRequest=function(){"use strict";var e=this,t=require("http"),r=require("https"),n,i,s={},a=!1,o={"User-Agent":"node-XMLHttpRequest",Accept:"*/*"},u={},c={},l=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","content-transfer-encoding","cookie","cookie2","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","via"],p=["TRACE","TRACK","CONNECT"],f=!1,d=!1,g={};this.UNSENT=0,this.OPENED=1,this.HEADERS_RECEIVED=2,this.LOADING=3,this.DONE=4,this.readyState=this.UNSENT,this.onreadystatechange=null,this.responseText="",this.responseXML="",this.status=null,this.statusText=null,this.withCredentials=!1;var b=function(y){return a||y&&l.indexOf(y.toLowerCase())===-1},x=function(y){return y&&p.indexOf(y)===-1};this.open=function(y,w,B,$,oe){if(this.abort(),d=!1,!x(y))throw new Error("SecurityError: Request method not allowed");s={method:y,url:w.toString(),async:typeof B!="boolean"?!0:B,user:$||null,password:oe||null},A(this.OPENED)},this.setDisableHeaderCheck=function(y){a=y},this.setRequestHeader=function(y,w){if(this.readyState!==this.OPENED)throw new Error("INVALID_STATE_ERR: setRequestHeader can only be called when state is OPEN");if(!b(y)){console.warn('Refused to set unsafe header "'+y+'"');return}if(f)throw new Error("INVALID_STATE_ERR: send flag is true");y=c[y.toLowerCase()]||y,c[y.toLowerCase()]=y,u[y]=u[y]?u[y]+", "+w:w},this.getResponseHeader=function(y){return typeof y=="string"&&this.readyState>this.OPENED&&i&&i.headers&&i.headers[y.toLowerCase()]&&!d?i.headers[y.toLowerCase()]:null},this.getAllResponseHeaders=function(){if(this.readyState<this.HEADERS_RECEIVED||d)return"";var y="";for(var w in i.headers)w!=="set-cookie"&&w!=="set-cookie2"&&(y+=w+": "+i.headers[w]+`\r
`);return y.substr(0,y.length-2)},this.getRequestHeader=function(y){return typeof y=="string"&&c[y.toLowerCase()]?u[c[y.toLowerCase()]]:""},this.send=function(y){if(this.readyState!==this.OPENED)throw new Error("INVALID_STATE_ERR: connection must be opened before send() is called");if(f)throw new Error("INVALID_STATE_ERR: send has already been called");var w=!1,B=!1,$=Vo.parse(s.url),oe;switch($.protocol){case"https:":w=!0;case"http:":oe=$.hostname;break;case"file:":B=!0;break;case void 0:case null:case"":oe="localhost";break;default:throw new Error("Protocol not supported.")}if(B){if(s.method!=="GET")throw new Error("XMLHttpRequest: Only GET method is supported");if(s.async)ur.readFile($.pathname,"utf8",function(Ye,$e){Ye?e.handleError(Ye):(e.status=200,e.responseText=$e,A(e.DONE))});else try{this.responseText=ur.readFileSync($.pathname,"utf8"),this.status=200,A(e.DONE)}catch(Ye){this.handleError(Ye)}return}var xe=$.port||(w?443:80),Je=$.pathname+($.search?$.search:"");for(var Ue in o)c[Ue.toLowerCase()]||(u[Ue]=o[Ue]);if(u.Host=oe,w&&xe===443||xe===80||(u.Host+=":"+$.port),s.user){typeof s.password>"u"&&(s.password="");var nr=new Buffer(s.user+":"+s.password);u.Authorization="Basic "+nr.toString("base64")}s.method==="GET"||s.method==="HEAD"?y=null:y?(u["Content-Length"]=Buffer.isBuffer(y)?y.length:Buffer.byteLength(y),u["Content-Type"]||(u["Content-Type"]="text/plain;charset=UTF-8")):s.method==="POST"&&(u["Content-Length"]=0);var st={host:oe,port:xe,path:Je,method:s.method,headers:u,agent:!1,withCredentials:e.withCredentials};if(d=!1,s.async){var at=w?r.request:t.request;f=!0,e.dispatchEvent("readystatechange");var kt=function Ye($e){if(i=$e,i.statusCode===301||i.statusCode===302||i.statusCode===303||i.statusCode===307){s.url=i.headers.location;var ir=Vo.parse(s.url);oe=ir.hostname;var Ve={hostname:ir.hostname,port:ir.port,path:ir.path,method:i.statusCode===303?"GET":s.method,headers:u,withCredentials:e.withCredentials};n=at(Ve,Ye).on("error",ot),n.end();return}i.setEncoding("utf8"),A(e.HEADERS_RECEIVED),e.status=i.statusCode,i.on("data",function(ne){ne&&(e.responseText+=ne),f&&A(e.LOADING)}),i.on("end",function(){f&&(A(e.DONE),f=!1)}),i.on("error",function(ne){e.handleError(ne)})},ot=function($e){e.handleError($e)};n=at(st,kt).on("error",ot),y&&n.write(y),n.end(),e.dispatchEvent("loadstart")}else{var Pt=".node-xmlhttprequest-content-"+process.pid,At=".node-xmlhttprequest-sync-"+process.pid;ur.writeFileSync(At,"","utf8");for(var ns="var http = require('http'), https = require('https'), fs = require('fs');var doRequest = http"+(w?"s":"")+".request;var options = "+JSON.stringify(st)+";var responseText = '';var req = doRequest(options, function(response) {response.setEncoding('utf8');response.on('data', function(chunk) {  responseText += chunk;});response.on('end', function() {fs.writeFileSync('"+Pt+"', JSON.stringify({err: null, data: {statusCode: response.statusCode, headers: response.headers, text: responseText}}), 'utf8');fs.unlinkSync('"+At+"');});response.on('error', function(error) {fs.writeFileSync('"+Pt+"', JSON.stringify({err: error}), 'utf8');fs.unlinkSync('"+At+"');});}).on('error', function(error) {fs.writeFileSync('"+Pt+"', JSON.stringify({err: error}), 'utf8');fs.unlinkSync('"+At+"');});"+(y?"req.write('"+JSON.stringify(y).slice(1,-1).replace(/'/g,"\\'")+"');":"")+"req.end();",is=Eh(process.argv[0],["-e",ns]);ur.existsSync(At););var Dt=JSON.parse(ur.readFileSync(Pt,"utf8"));is.stdin.end(),ur.unlinkSync(Pt),Dt.err?e.handleError(Dt.err):(i=Dt.data,e.status=Dt.data.statusCode,e.responseText=Dt.data.text,A(e.DONE))}},this.handleError=function(y){this.status=0,this.statusText=y,this.responseText=y.stack,d=!0,A(this.DONE),this.dispatchEvent("error")},this.abort=function(){n&&(n.abort(),n=null),u=o,this.status=0,this.responseText="",this.responseXML="",d=!0,this.readyState!==this.UNSENT&&(this.readyState!==this.OPENED||f)&&this.readyState!==this.DONE&&(f=!1,A(this.DONE)),this.readyState=this.UNSENT,this.dispatchEvent("abort")},this.addEventListener=function(y,w){y in g||(g[y]=[]),g[y].push(w)},this.removeEventListener=function(y,w){y in g&&(g[y]=g[y].filter(function(B){return B!==w}))},this.dispatchEvent=function(y){if(typeof e["on"+y]=="function"&&e["on"+y](),y in g)for(var w=0,B=g[y].length;w<B;w++)g[y][w].call(e)};var A=function(y){(y==e.LOADING||e.readyState!==y)&&(e.readyState=y,(s.async||e.readyState<e.OPENED||e.readyState===e.DONE)&&e.dispatchEvent("readystatechange"),e.readyState===e.DONE&&!d&&(e.dispatchEvent("load"),e.dispatchEvent("loadend")))}}});var au=h(()=>{"use strict";var su=require("url"),qt=require("https"),iu="__agent_base_https_request_patched__";qt.request[iu]||(qt.request=function(e){return function(t,r){let n;return typeof t=="string"?n=su.parse(t):n=Object.assign({},t),n.port==null&&(n.port=443),n.secureEndpoint=!0,e.call(qt,n,r)}}(qt.request),qt.request[iu]=!0);qt.get=function(e,t,r){let n;typeof e=="string"&&t&&typeof t!="function"?n=Object.assign({},su.parse(e),t):!t&&!r?n=e:r||(n=e,r=t);let i=qt.request(n,r);return i.end(),i}});var ou=h((gs,ms)=>{(function(e,t){typeof gs=="object"&&typeof ms<"u"?ms.exports=t():typeof define=="function"&&define.amd?define(t):e.ES6Promise=t()})(gs,function(){"use strict";function e(v){var _=typeof v;return v!==null&&(_==="object"||_==="function")}function t(v){return typeof v=="function"}var r=void 0;Array.isArray?r=Array.isArray:r=function(v){return Object.prototype.toString.call(v)==="[object Array]"};var n=r,i=0,s=void 0,a=void 0,o=function(_,C){B[i]=_,B[i+1]=C,i+=2,i===2&&(a?a($):xe())};function u(v){a=v}function c(v){o=v}var l=typeof window<"u"?window:void 0,p=l||{},f=p.MutationObserver||p.WebKitMutationObserver,d=typeof self>"u"&&typeof process<"u"&&{}.toString.call(process)==="[object process]",g=typeof Uint8ClampedArray<"u"&&typeof importScripts<"u"&&typeof MessageChannel<"u";function b(){return function(){return process.nextTick($)}}function x(){return typeof s<"u"?function(){s($)}:w()}function A(){var v=0,_=new f($),C=document.createTextNode("");return _.observe(C,{characterData:!0}),function(){C.data=v=++v%2}}function y(){var v=new MessageChannel;return v.port1.onmessage=$,function(){return v.port2.postMessage(0)}}function w(){var v=setTimeout;return function(){return v($,1)}}var B=new Array(1e3);function $(){for(var v=0;v<i;v+=2){var _=B[v],C=B[v+1];_(C),B[v]=void 0,B[v+1]=void 0}i=0}function oe(){try{var v=Function("return this")().require("vertx");return s=v.runOnLoop||v.runOnContext,x()}catch{return w()}}var xe=void 0;d?xe=b():f?xe=A():g?xe=y():l===void 0&&typeof require=="function"?xe=oe():xe=w();function Je(v,_){var C=this,T=new this.constructor(st);T[nr]===void 0&&Uo(T);var D=C._state;if(D){var R=arguments[D-1];o(function(){return Ho(D,T,R,C._result)})}else ss(C,T,v,_);return T}function Ue(v){var _=this;if(v&&typeof v=="object"&&v.constructor===_)return v;var C=new _(st);return $e(C,v),C}var nr=Math.random().toString(36).substring(2);function st(){}var at=void 0,kt=1,ot=2;function Pt(){return new TypeError("You cannot resolve a promise with itself")}function At(){return new TypeError("A promises callback cannot return that same promise.")}function ns(v,_,C,T){try{v.call(_,C,T)}catch(D){return D}}function is(v,_,C){o(function(T){var D=!1,R=ns(C,_,function(ue){D||(D=!0,_!==ue?$e(T,ue):Ve(T,ue))},function(ue){D||(D=!0,ne(T,ue))},"Settle: "+(T._label||" unknown promise"));!D&&R&&(D=!0,ne(T,R))},v)}function Dt(v,_){_._state===kt?Ve(v,_._result):_._state===ot?ne(v,_._result):ss(_,void 0,function(C){return $e(v,C)},function(C){return ne(v,C)})}function Ye(v,_,C){_.constructor===v.constructor&&C===Je&&_.constructor.resolve===Ue?Dt(v,_):C===void 0?Ve(v,_):t(C)?is(v,_,C):Ve(v,_)}function $e(v,_){if(v===_)ne(v,Pt());else if(e(_)){var C=void 0;try{C=_.then}catch(T){ne(v,T);return}Ye(v,_,C)}else Ve(v,_)}function ir(v){v._onerror&&v._onerror(v._result),as(v)}function Ve(v,_){v._state===at&&(v._result=_,v._state=kt,v._subscribers.length!==0&&o(as,v))}function ne(v,_){v._state===at&&(v._state=ot,v._result=_,o(ir,v))}function ss(v,_,C,T){var D=v._subscribers,R=D.length;v._onerror=null,D[R]=_,D[R+kt]=C,D[R+ot]=T,R===0&&v._state&&o(as,v)}function as(v){var _=v._subscribers,C=v._state;if(_.length!==0){for(var T=void 0,D=void 0,R=v._result,ue=0;ue<_.length;ue+=3)T=_[ue],D=_[ue+C],T?Ho(C,T,D,R):D(R);v._subscribers.length=0}}function Ho(v,_,C,T){var D=t(C),R=void 0,ue=void 0,sr=!0;if(D){try{R=C(T)}catch(Bn){sr=!1,ue=Bn}if(_===R){ne(_,At());return}}else R=T;_._state!==at||(D&&sr?$e(_,R):sr===!1?ne(_,ue):v===kt?Ve(_,R):v===ot&&ne(_,R))}function ih(v,_){try{_(function(T){$e(v,T)},function(T){ne(v,T)})}catch(C){ne(v,C)}}var jo=0;function sh(){return jo++}function Uo(v){v[nr]=jo++,v._state=void 0,v._result=void 0,v._subscribers=[]}function ah(){return new Error("Array Methods must be provided an Array")}var oh=function(){function v(_,C){this._instanceConstructor=_,this.promise=new _(st),this.promise[nr]||Uo(this.promise),n(C)?(this.length=C.length,this._remaining=C.length,this._result=new Array(this.length),this.length===0?Ve(this.promise,this._result):(this.length=this.length||0,this._enumerate(C),this._remaining===0&&Ve(this.promise,this._result))):ne(this.promise,ah())}return v.prototype._enumerate=function(C){for(var T=0;this._state===at&&T<C.length;T++)this._eachEntry(C[T],T)},v.prototype._eachEntry=function(C,T){var D=this._instanceConstructor,R=D.resolve;if(R===Ue){var ue=void 0,sr=void 0,Bn=!1;try{ue=C.then}catch(us){Bn=!0,sr=us}if(ue===Je&&C._state!==at)this._settledAt(C._state,T,C._result);else if(typeof ue!="function")this._remaining--,this._result[T]=C;else if(D===Se){var os=new D(st);Bn?ne(os,sr):Ye(os,C,ue),this._willSettleAt(os,T)}else this._willSettleAt(new D(function(us){return us(C)}),T)}else this._willSettleAt(R(C),T)},v.prototype._settledAt=function(C,T,D){var R=this.promise;R._state===at&&(this._remaining--,C===ot?ne(R,D):this._result[T]=D),this._remaining===0&&Ve(R,this._result)},v.prototype._willSettleAt=function(C,T){var D=this;ss(C,void 0,function(R){return D._settledAt(kt,T,R)},function(R){return D._settledAt(ot,T,R)})},v}();function uh(v){return new oh(this,v).promise}function ch(v){var _=this;return n(v)?new _(function(C,T){for(var D=v.length,R=0;R<D;R++)_.resolve(v[R]).then(C,T)}):new _(function(C,T){return T(new TypeError("You must pass an array to race."))})}function lh(v){var _=this,C=new _(st);return ne(C,v),C}function ph(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function fh(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var Se=function(){function v(_){this[nr]=sh(),this._result=this._state=void 0,this._subscribers=[],st!==_&&(typeof _!="function"&&ph(),this instanceof v?ih(this,_):fh())}return v.prototype.catch=function(C){return this.then(null,C)},v.prototype.finally=function(C){var T=this,D=T.constructor;return t(C)?T.then(function(R){return D.resolve(C()).then(function(){return R})},function(R){return D.resolve(C()).then(function(){throw R})}):T.then(C,C)},v}();Se.prototype.then=Je,Se.all=uh,Se.race=ch,Se.resolve=Ue,Se.reject=lh,Se._setScheduler=u,Se._setAsap=c,Se._asap=o;function dh(){var v=void 0;if(typeof global<"u")v=global;else if(typeof self<"u")v=self;else try{v=Function("return this")()}catch{throw new Error("polyfill failed because global object is unavailable in this environment")}var _=v.Promise;if(_){var C=null;try{C=Object.prototype.toString.call(_.resolve())}catch{}if(C==="[object Promise]"&&!_.cast)return}v.Promise=Se}return Se.polyfill=dh,Se.Promise=Se,Se})});var cu=h((JE,uu)=>{"use strict";uu.exports=function(){"use strict";var e=void 0;function t(n){return typeof n=="function"}global!==void 0?e=global:window!==void 0&&window.document?e=window:e=self;var r=function(){if(!e.hasOwnProperty("Promise"))return!1;var n=e.Promise;return!n.hasOwnProperty("resolve")||!n.hasOwnProperty("reject")||!n.hasOwnProperty("all")||!n.hasOwnProperty("race")?!1:function(){var i=void 0,s=new e.Promise(function(a){i=a});return s?t(i):!1}()}();return r?e.Promise:ou().Promise}()});var pu=h((YE,lu)=>{"use strict";lu.exports=function(){"use strict";var e=cu();function t(r){return r&&typeof r.then=="function"&&typeof r.catch=="function"}return function(n,i){return function(){for(var s=arguments.length,a=Array(s),o=0;o<s;o++)a[o]=arguments[o];var u=i&&i.multiArgs,c=void 0;return i&&i.thisArg?c=i.thisArg:i&&(c=i),new e(function(l,p){a.push(function(g){if(g)return p(g);for(var b=arguments.length,x=Array(b>1?b-1:0),A=1;A<b;A++)x[A-1]=arguments[A];if(!u)return l(x[0]);l(x)});var f=n.apply(c,a);t(f)&&l(f)})}}}()});var ys=h((ZE,du)=>{"use strict";au();var Ah=require("util").inherits,Dh=pu(),fu=require("events").EventEmitter;du.exports=Nt;function Rh(e){return e&&typeof e.addRequest=="function"}function Nt(e,t){if(!(this instanceof Nt))return new Nt(e,t);fu.call(this),this._promisifiedCallback=!1;let r=t;typeof e=="function"?this.callback=e:e&&(r=e),this.timeout=r&&r.timeout||null,this.options=r}Ah(Nt,fu);Nt.prototype.callback=function(t,r){throw new Error('"agent-base" has no default implementation, you must subclass and override `callback()`')};Nt.prototype.addRequest=function(t,r){let n=Object.assign({},r);n.host==null&&(n.host="localhost"),n.port==null&&(n.port=n.secureEndpoint?443:80);let i=Object.assign({},this.options,n);i.host&&i.path&&delete i.path,delete i.agent,delete i.hostname,delete i._defaultAgent,delete i.defaultPort,delete i.createConnection,t._last=!0,t.shouldKeepAlive=!1;let s,a=!1,o=this.timeout,u=this.freeSocket;function c(d){t._hadError||(t.emit("error",d),t._hadError=!0)}function l(){s=null,a=!0;let d=new Error('A "socket" was not created for HTTP request before '+o+"ms");d.code="ETIMEOUT",c(d)}function p(d){a||(s!=null&&(clearTimeout(s),s=null),c(d))}function f(d){if(!a)if(s!=null&&(clearTimeout(s),s=null),Rh(d))d.addRequest(t,i);else if(d){let g=function(){u(d,i)};d.on("free",g),t.onSocket(d)}else{let g=new Error("no Duplex stream was returned to agent-base for `"+t.method+" "+t.path+"`");c(g)}}!this._promisifiedCallback&&this.callback.length>=3&&(this.callback=Dh(this.callback,this),this._promisifiedCallback=!0),o>0&&(s=setTimeout(l,o));try{Promise.resolve(this.callback(t,i)).then(f,p)}catch(d){Promise.reject(d).catch(p)}};Nt.prototype.freeSocket=function(t,r){t.destroy()}});var vu=h((eb,hu)=>{var Gr=1e3,zr=Gr*60,Qr=zr*60,Wr=Qr*24,Oh=Wr*365.25;hu.exports=function(e,t){t=t||{};var r=typeof e;if(r==="string"&&e.length>0)return qh(e);if(r==="number"&&isNaN(e)===!1)return t.long?Lh(e):Nh(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function qh(e){if(e=String(e),!(e.length>100)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(!!t){var r=parseFloat(t[1]),n=(t[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*Oh;case"days":case"day":case"d":return r*Wr;case"hours":case"hour":case"hrs":case"hr":case"h":return r*Qr;case"minutes":case"minute":case"mins":case"min":case"m":return r*zr;case"seconds":case"second":case"secs":case"sec":case"s":return r*Gr;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function Nh(e){return e>=Wr?Math.round(e/Wr)+"d":e>=Qr?Math.round(e/Qr)+"h":e>=zr?Math.round(e/zr)+"m":e>=Gr?Math.round(e/Gr)+"s":e+"ms"}function Lh(e){return Kn(e,Wr,"day")||Kn(e,Qr,"hour")||Kn(e,zr,"minute")||Kn(e,Gr,"second")||e+" ms"}function Kn(e,t,r){if(!(e<t))return e<t*1.5?Math.floor(e/t)+" "+r:Math.ceil(e/t)+" "+r+"s"}});var Cs=h((O,gu)=>{O=gu.exports=_s.debug=_s.default=_s;O.coerce=$h;O.disable=jh;O.enable=Hh;O.enabled=Uh;O.humanize=vu();O.instances=[];O.names=[];O.skips=[];O.formatters={};function Mh(e){var t=0,r;for(r in e)t=(t<<5)-t+e.charCodeAt(r),t|=0;return O.colors[Math.abs(t)%O.colors.length]}function _s(e){var t;function r(){if(!!r.enabled){var n=r,i=+new Date,s=i-(t||i);n.diff=s,n.prev=t,n.curr=i,t=i;for(var a=new Array(arguments.length),o=0;o<a.length;o++)a[o]=arguments[o];a[0]=O.coerce(a[0]),typeof a[0]!="string"&&a.unshift("%O");var u=0;a[0]=a[0].replace(/%([a-zA-Z%])/g,function(l,p){if(l==="%%")return l;u++;var f=O.formatters[p];if(typeof f=="function"){var d=a[u];l=f.call(n,d),a.splice(u,1),u--}return l}),O.formatArgs.call(n,a);var c=r.log||O.log||console.log.bind(console);c.apply(n,a)}}return r.namespace=e,r.enabled=O.enabled(e),r.useColors=O.useColors(),r.color=Mh(e),r.destroy=Fh,typeof O.init=="function"&&O.init(r),O.instances.push(r),r}function Fh(){var e=O.instances.indexOf(this);return e!==-1?(O.instances.splice(e,1),!0):!1}function Hh(e){O.save(e),O.names=[],O.skips=[];var t,r=(typeof e=="string"?e:"").split(/[\s,]+/),n=r.length;for(t=0;t<n;t++)!r[t]||(e=r[t].replace(/\*/g,".*?"),e[0]==="-"?O.skips.push(new RegExp("^"+e.substr(1)+"$")):O.names.push(new RegExp("^"+e+"$")));for(t=0;t<O.instances.length;t++){var i=O.instances[t];i.enabled=O.enabled(i.namespace)}}function jh(){O.enable("")}function Uh(e){if(e[e.length-1]==="*")return!0;var t,r;for(t=0,r=O.skips.length;t<r;t++)if(O.skips[t].test(e))return!1;for(t=0,r=O.names.length;t<r;t++)if(O.names[t].test(e))return!0;return!1}function $h(e){return e instanceof Error?e.stack||e.message:e}});var _u=h((be,yu)=>{be=yu.exports=Cs();be.log=Gh;be.formatArgs=Bh;be.save=zh;be.load=mu;be.useColors=Vh;be.storage=typeof chrome<"u"&&typeof chrome.storage<"u"?chrome.storage.local:Qh();be.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function Vh(){return typeof window<"u"&&window.process&&window.process.type==="renderer"?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}be.formatters.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}};function Bh(e){var t=this.useColors;if(e[0]=(t?"%c":"")+this.namespace+(t?" %c":" ")+e[0]+(t?"%c ":" ")+"+"+be.humanize(this.diff),!!t){var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var n=0,i=0;e[0].replace(/%[a-zA-Z%]/g,function(s){s!=="%%"&&(n++,s==="%c"&&(i=n))}),e.splice(i,0,r)}}function Gh(){return typeof console=="object"&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function zh(e){try{e==null?be.storage.removeItem("debug"):be.storage.debug=e}catch{}}function mu(){var e;try{e=be.storage.debug}catch{}return!e&&typeof process<"u"&&"env"in process&&(e=process.env.DEBUG),e}be.enable(mu());function Qh(){try{return window.localStorage}catch{}}});var Eu=h((tb,Cu)=>{"use strict";Cu.exports=(e,t=process.argv)=>{let r=e.startsWith("-")?"":e.length===1?"-":"--",n=t.indexOf(r+e),i=t.indexOf("--");return n!==-1&&(i===-1||n<i)}});var wu=h((rb,Tu)=>{"use strict";var Wh=require("os"),bu=require("tty"),Ne=Eu(),{env:pe}=process,Jn;Ne("no-color")||Ne("no-colors")||Ne("color=false")||Ne("color=never")?Jn=0:(Ne("color")||Ne("colors")||Ne("color=true")||Ne("color=always"))&&(Jn=1);function Xh(){if("FORCE_COLOR"in pe)return pe.FORCE_COLOR==="true"?1:pe.FORCE_COLOR==="false"?0:pe.FORCE_COLOR.length===0?1:Math.min(Number.parseInt(pe.FORCE_COLOR,10),3)}function Kh(e){return e===0?!1:{level:e,hasBasic:!0,has256:e>=2,has16m:e>=3}}function Jh(e,{streamIsTTY:t,sniffFlags:r=!0}={}){let n=Xh();n!==void 0&&(Jn=n);let i=r?Jn:n;if(i===0)return 0;if(r){if(Ne("color=16m")||Ne("color=full")||Ne("color=truecolor"))return 3;if(Ne("color=256"))return 2}if(e&&!t&&i===void 0)return 0;let s=i||0;if(pe.TERM==="dumb")return s;if(process.platform==="win32"){let a=Wh.release().split(".");return Number(a[0])>=10&&Number(a[2])>=10586?Number(a[2])>=14931?3:2:1}if("CI"in pe)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE","DRONE"].some(a=>a in pe)||pe.CI_NAME==="codeship"?1:s;if("TEAMCITY_VERSION"in pe)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(pe.TEAMCITY_VERSION)?1:0;if(pe.COLORTERM==="truecolor")return 3;if("TERM_PROGRAM"in pe){let a=Number.parseInt((pe.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(pe.TERM_PROGRAM){case"iTerm.app":return a>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(pe.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(pe.TERM)||"COLORTERM"in pe?1:s}function Es(e,t={}){let r=Jh(e,{streamIsTTY:e&&e.isTTY,...t});return Kh(r)}Tu.exports={supportsColor:Es,stdout:Es({isTTY:bu.isatty(1)}),stderr:Es({isTTY:bu.isatty(2)})}});var Su=h((ie,xu)=>{var Yh=require("tty"),Yn=require("util");ie=xu.exports=Cs();ie.init=iv;ie.log=rv;ie.formatArgs=ev;ie.save=nv;ie.load=Iu;ie.useColors=Zh;ie.colors=[6,2,3,4,5,1];try{bs=wu(),bs&&bs.level>=2&&(ie.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch{}var bs;ie.inspectOpts=Object.keys(process.env).filter(function(e){return/^debug_/i.test(e)}).reduce(function(e,t){var r=t.substring(6).toLowerCase().replace(/_([a-z])/g,function(i,s){return s.toUpperCase()}),n=process.env[t];return/^(yes|on|true|enabled)$/i.test(n)?n=!0:/^(no|off|false|disabled)$/i.test(n)?n=!1:n==="null"?n=null:n=Number(n),e[r]=n,e},{});function Zh(){return"colors"in ie.inspectOpts?Boolean(ie.inspectOpts.colors):Yh.isatty(process.stderr.fd)}ie.formatters.o=function(e){return this.inspectOpts.colors=this.useColors,Yn.inspect(e,this.inspectOpts).split(`
`).map(function(t){return t.trim()}).join(" ")};ie.formatters.O=function(e){return this.inspectOpts.colors=this.useColors,Yn.inspect(e,this.inspectOpts)};function ev(e){var t=this.namespace,r=this.useColors;if(r){var n=this.color,i="\x1B[3"+(n<8?n:"8;5;"+n),s="  "+i+";1m"+t+" \x1B[0m";e[0]=s+e[0].split(`
`).join(`
`+s),e.push(i+"m+"+ie.humanize(this.diff)+"\x1B[0m")}else e[0]=tv()+t+" "+e[0]}function tv(){return ie.inspectOpts.hideDate?"":new Date().toISOString()+" "}function rv(){return process.stderr.write(Yn.format.apply(Yn,arguments)+`
`)}function nv(e){e==null?delete process.env.DEBUG:process.env.DEBUG=e}function Iu(){return process.env.DEBUG}function iv(e){e.inspectOpts={};for(var t=Object.keys(ie.inspectOpts),r=0;r<t.length;r++)e.inspectOpts[t[r]]=ie.inspectOpts[t[r]]}ie.enable(Iu())});var ws=h((nb,Ts)=>{typeof process>"u"||process.type==="renderer"?Ts.exports=_u():Ts.exports=Su()});var Au=h((ib,Pu)=>{var sv=require("net"),av=require("tls"),Is=require("url"),ku=ys(),ov=require("util").inherits,Zn=ws()("http-proxy-agent");Pu.exports=Xr;function Xr(e){if(!(this instanceof Xr))return new Xr(e);if(typeof e=="string"&&(e=Is.parse(e)),!e)throw new Error("an HTTP(S) proxy server `host` and `port` must be specified!");Zn("creating new HttpProxyAgent instance: %o",e),ku.call(this,e);var t=Object.assign({},e);this.secureProxy=t.protocol?/^https:?$/i.test(t.protocol):!1,t.host=t.hostname||t.host,t.port=+t.port||(this.secureProxy?443:80),t.host&&t.path&&(delete t.path,delete t.pathname),this.proxy=t}ov(Xr,ku);Xr.prototype.callback=function(t,r,n){var i=this.proxy,s=Is.parse(t.path);s.protocol==null&&(s.protocol="http:"),s.hostname==null&&(s.hostname=r.hostname||r.host),s.port==null&&(s.port=r.port),s.port==80&&delete s.port;var a=Is.format(s);t.path=a,i.auth&&t.setHeader("Proxy-Authorization","Basic "+Buffer.from(i.auth).toString("base64"));var o;if(this.secureProxy?o=av.connect(i):o=sv.connect(i),t._header&&(Zn("regenerating stored HTTP header string for request"),t._header=null,t._implicitHeader(),t.output&&t.output.length>0)){Zn("patching connection write() output buffer with updated header");var u=t.output[0],c=u.indexOf(`\r
\r
`)+4;t.output[0]=t._header+u.substring(c),Zn("output buffer: %o",t.output)}n(null,o)}});var Nu=h((sb,qu)=>{var Du=require("net"),Ru=require("tls"),uv=require("url"),cv=require("assert"),Ou=ys(),lv=require("util").inherits,Lt=ws()("https-proxy-agent");qu.exports=Kr;function Kr(e){if(!(this instanceof Kr))return new Kr(e);if(typeof e=="string"&&(e=uv.parse(e)),!e)throw new Error("an HTTP(S) proxy server `host` and `port` must be specified!");Lt("creating new HttpsProxyAgent instance: %o",e),Ou.call(this,e);var t=Object.assign({},e);this.secureProxy=t.protocol?/^https:?$/i.test(t.protocol):!1,t.host=t.hostname||t.host,t.port=+t.port||(this.secureProxy?443:80),this.secureProxy&&!("ALPNProtocols"in t)&&(t.ALPNProtocols=["http 1.1"]),t.host&&t.path&&(delete t.path,delete t.pathname),this.proxy=t,this.defaultPort=443}lv(Kr,Ou);Kr.prototype.callback=function(t,r,n){var i=this.proxy,s;this.secureProxy?s=Ru.connect(i):s=Du.connect(i);var a=[],o=0;function u(){var w=s.read();w?d(w):s.once("readable",u)}function c(){s.removeListener("end",p),s.removeListener("error",f),s.removeListener("close",l),s.removeListener("readable",u)}function l(w){Lt("onclose had error %o",w)}function p(){Lt("onend")}function f(w){c(),n(w)}function d(w){a.push(w),o+=w.length;var B=Buffer.concat(a,o),$=B.toString("ascii");if(!~$.indexOf(`\r
\r
`)){Lt("have not received end of HTTP headers yet..."),u();return}var oe=$.substring(0,$.indexOf(`\r
`)),xe=+oe.split(" ")[1];if(Lt("got proxy server response: %o",oe),xe==200){var Je=s;a=B=null,r.secureEndpoint&&(Lt("upgrading proxy-connected socket to TLS connection: %o",r.host),r.socket=s,r.servername=r.servername||r.host,r.host=null,r.hostname=null,r.port=null,Je=Ru.connect(r)),c(),t.once("socket",pv),n(null,Je)}else c(),s.destroy(),s=new Du.Socket,s.readable=!0,a=B,t.once("socket",g),n(null,s)}function g(w){Lt("replaying proxy buffer for failed request"),cv(w.listenerCount("data")>0),w.push(a),a=null}s.on("error",f),s.on("close",l),s.on("end",p),u();var b=r.host+":"+r.port,x="CONNECT "+b+` HTTP/1.1\r
`,A=Object.assign({},i.headers);i.auth&&(A["Proxy-Authorization"]="Basic "+Buffer.from(i.auth).toString("base64"));var y=r.host;fv(r.port,r.secureEndpoint)||(y+=":"+r.port),A.Host=y,A.Connection="close",Object.keys(A).forEach(function(w){x+=w+": "+A[w]+`\r
`}),s.write(x+`\r
`)};function pv(e){e.resume()}function fv(e,t){return Boolean(!t&&e===80||t&&e===443)}});var de=h((Nb,zu)=>{"use strict";var Ev=function(){function e(){}return e.info=function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];e.enableDebug&&console.info(e.TAG+t,r)},e.warn=function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];e.disableWarnings||console.warn(e.TAG+t,r)},e.enableDebug=!1,e.disableWarnings=!1,e.disableErrors=!1,e.TAG="ApplicationInsights:",e}();zu.exports=Ev});var ii=h(Et=>{"use strict";var Qu=Et&&Et.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e};Object.defineProperty(Et,"__esModule",{value:!0});var Mt=Ft(),bv=require("events"),Tv;(function(e){e[e.INTERNAL=0]="INTERNAL",e[e.SERVER=1]="SERVER",e[e.CLIENT=2]="CLIENT",e[e.PRODUCER=3]="PRODUCER",e[e.CONSUMER=4]="CONSUMER"})(Tv=Et.SpanKind||(Et.SpanKind={}));var Wu=function(){function e(){}return e.prototype.active=function(){var t=this,r=Mt.CorrelationContextManager.getCurrentContext();return Qu({},r,{getValue:function(n){return t._activeSymbol?n===t._activeSymbol?r:!1:(t._activeSymbol=n,r)},setValue:function(){}})},e.prototype.with=function(t,r){var n=t.parentSpanId,i=t.name,s=e._spanToContext(t,n,i);return Mt.CorrelationContextManager.runWithContext(s,r)()},e.prototype.bind=function(t){return typeof t=="function"?Mt.CorrelationContextManager.wrapCallback(t):(t instanceof bv.EventEmitter&&Mt.CorrelationContextManager.wrapEmitter(t),t)},e.prototype.enable=function(){return Mt.CorrelationContextManager.enable(),this},e.prototype.disable=function(){return Mt.CorrelationContextManager.disable(),this},e._spanToContext=function(t,r,n){var i=r?"|"+t.context().traceId+"."+r+".":t.context().traceId,s=Qu({},t.context(),{traceFlags:t.context().traceFlags.toString()}),a=Mt.CorrelationContextManager.spanToContextObject(s,i,n);return a},e}();Et.OpenTelemetryScopeManagerWrapper=Wu;Et.AsyncScopeManager=new Wu});var hi=h((k,lc)=>{k=lc.exports=L;var U;typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?U=function(){var e=Array.prototype.slice.call(arguments,0);e.unshift("SEMVER"),console.log.apply(console,e)}:U=function(){};k.SEMVER_SPEC_VERSION="2.0.0";var Jr=256,si=Number.MAX_SAFE_INTEGER||9007199254740991,Ss=16,wv=Jr-6,Yr=k.re=[],Q=k.safeRe=[],m=k.src=[],q=0,Rs="[a-zA-Z0-9-]",ks=[["\\s",1],["\\d",Jr],[Rs,wv]];function pi(e){for(var t=0;t<ks.length;t++){var r=ks[t][0],n=ks[t][1];e=e.split(r+"*").join(r+"{0,"+n+"}").split(r+"+").join(r+"{1,"+n+"}")}return e}var lr=q++;m[lr]="0|[1-9]\\d*";var pr=q++;m[pr]="\\d+";var Os=q++;m[Os]="\\d*[a-zA-Z-]"+Rs+"*";var Ku=q++;m[Ku]="("+m[lr]+")\\.("+m[lr]+")\\.("+m[lr]+")";var Ju=q++;m[Ju]="("+m[pr]+")\\.("+m[pr]+")\\.("+m[pr]+")";var Ps=q++;m[Ps]="(?:"+m[lr]+"|"+m[Os]+")";var As=q++;m[As]="(?:"+m[pr]+"|"+m[Os]+")";var qs=q++;m[qs]="(?:-("+m[Ps]+"(?:\\."+m[Ps]+")*))";var Ns=q++;m[Ns]="(?:-?("+m[As]+"(?:\\."+m[As]+")*))";var Ds=q++;m[Ds]=Rs+"+";var en=q++;m[en]="(?:\\+("+m[Ds]+"(?:\\."+m[Ds]+")*))";var Ls=q++,Yu="v?"+m[Ku]+m[qs]+"?"+m[en]+"?";m[Ls]="^"+Yu+"$";var Ms="[v=\\s]*"+m[Ju]+m[Ns]+"?"+m[en]+"?",Fs=q++;m[Fs]="^"+Ms+"$";var gr=q++;m[gr]="((?:<|>)?=?)";var ai=q++;m[ai]=m[pr]+"|x|X|\\*";var oi=q++;m[oi]=m[lr]+"|x|X|\\*";var Ht=q++;m[Ht]="[v=\\s]*("+m[oi]+")(?:\\.("+m[oi]+")(?:\\.("+m[oi]+")(?:"+m[qs]+")?"+m[en]+"?)?)?";var dr=q++;m[dr]="[v=\\s]*("+m[ai]+")(?:\\.("+m[ai]+")(?:\\.("+m[ai]+")(?:"+m[Ns]+")?"+m[en]+"?)?)?";var Zu=q++;m[Zu]="^"+m[gr]+"\\s*"+m[Ht]+"$";var ec=q++;m[ec]="^"+m[gr]+"\\s*"+m[dr]+"$";var tc=q++;m[tc]="(?:^|[^\\d])(\\d{1,"+Ss+"})(?:\\.(\\d{1,"+Ss+"}))?(?:\\.(\\d{1,"+Ss+"}))?(?:$|[^\\d])";var fi=q++;m[fi]="(?:~>?)";var hr=q++;m[hr]="(\\s*)"+m[fi]+"\\s+";Yr[hr]=new RegExp(m[hr],"g");Q[hr]=new RegExp(pi(m[hr]),"g");var Iv="$1~",rc=q++;m[rc]="^"+m[fi]+m[Ht]+"$";var nc=q++;m[nc]="^"+m[fi]+m[dr]+"$";var di=q++;m[di]="(?:\\^)";var vr=q++;m[vr]="(\\s*)"+m[di]+"\\s+";Yr[vr]=new RegExp(m[vr],"g");Q[vr]=new RegExp(pi(m[vr]),"g");var xv="$1^",ic=q++;m[ic]="^"+m[di]+m[Ht]+"$";var sc=q++;m[sc]="^"+m[di]+m[dr]+"$";var Hs=q++;m[Hs]="^"+m[gr]+"\\s*("+Ms+")$|^$";var js=q++;m[js]="^"+m[gr]+"\\s*("+Yu+")$|^$";var jt=q++;m[jt]="(\\s*)"+m[gr]+"\\s*("+Ms+"|"+m[Ht]+")";Yr[jt]=new RegExp(m[jt],"g");Q[jt]=new RegExp(pi(m[jt]),"g");var Sv="$1$2$3",ac=q++;m[ac]="^\\s*("+m[Ht]+")\\s+-\\s+("+m[Ht]+")\\s*$";var oc=q++;m[oc]="^\\s*("+m[dr]+")\\s+-\\s+("+m[dr]+")\\s*$";var uc=q++;m[uc]="(<|>)?=?\\s*\\*";for(tt=0;tt<q;tt++)U(tt,m[tt]),Yr[tt]||(Yr[tt]=new RegExp(m[tt]),Q[tt]=new RegExp(pi(m[tt])));var tt;k.parse=Ut;function Ut(e,t){if((!t||typeof t!="object")&&(t={loose:!!t,includePrerelease:!1}),e instanceof L)return e;if(typeof e!="string"||e.length>Jr)return null;var r=t.loose?Q[Fs]:Q[Ls];if(!r.test(e))return null;try{return new L(e,t)}catch{return null}}k.valid=kv;function kv(e,t){var r=Ut(e,t);return r?r.version:null}k.clean=Pv;function Pv(e,t){var r=Ut(e.trim().replace(/^[=v]+/,""),t);return r?r.version:null}k.SemVer=L;function L(e,t){if((!t||typeof t!="object")&&(t={loose:!!t,includePrerelease:!1}),e instanceof L){if(e.loose===t.loose)return e;e=e.version}else if(typeof e!="string")throw new TypeError("Invalid Version: "+e);if(e.length>Jr)throw new TypeError("version is longer than "+Jr+" characters");if(!(this instanceof L))return new L(e,t);U("SemVer",e,t),this.options=t,this.loose=!!t.loose;var r=e.trim().match(t.loose?Q[Fs]:Q[Ls]);if(!r)throw new TypeError("Invalid Version: "+e);if(this.raw=e,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>si||this.major<0)throw new TypeError("Invalid major version");if(this.minor>si||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>si||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(function(n){if(/^[0-9]+$/.test(n)){var i=+n;if(i>=0&&i<si)return i}return n}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}L.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version};L.prototype.toString=function(){return this.version};L.prototype.compare=function(e){return U("SemVer.compare",this.version,this.options,e),e instanceof L||(e=new L(e,this.options)),this.compareMain(e)||this.comparePre(e)};L.prototype.compareMain=function(e){return e instanceof L||(e=new L(e,this.options)),fr(this.major,e.major)||fr(this.minor,e.minor)||fr(this.patch,e.patch)};L.prototype.comparePre=function(e){if(e instanceof L||(e=new L(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;var t=0;do{var r=this.prerelease[t],n=e.prerelease[t];if(U("prerelease compare",t,r,n),r===void 0&&n===void 0)return 0;if(n===void 0)return 1;if(r===void 0)return-1;if(r===n)continue;return fr(r,n)}while(++t)};L.prototype.inc=function(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",t),this.inc("pre",t);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{for(var r=this.prerelease.length;--r>=0;)typeof this.prerelease[r]=="number"&&(this.prerelease[r]++,r=-2);r===-1&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error("invalid increment argument: "+e)}return this.format(),this.raw=this.version,this};k.inc=Av;function Av(e,t,r,n){typeof r=="string"&&(n=r,r=void 0);try{return new L(e,r).inc(t,n).version}catch{return null}}k.diff=Dv;function Dv(e,t){if(Us(e,t))return null;var r=Ut(e),n=Ut(t),i="";if(r.prerelease.length||n.prerelease.length){i="pre";var s="prerelease"}for(var a in r)if((a==="major"||a==="minor"||a==="patch")&&r[a]!==n[a])return i+a;return s}k.compareIdentifiers=fr;var Xu=/^[0-9]+$/;function fr(e,t){var r=Xu.test(e),n=Xu.test(t);return r&&n&&(e=+e,t=+t),e===t?0:r&&!n?-1:n&&!r?1:e<t?-1:1}k.rcompareIdentifiers=Rv;function Rv(e,t){return fr(t,e)}k.major=Ov;function Ov(e,t){return new L(e,t).major}k.minor=qv;function qv(e,t){return new L(e,t).minor}k.patch=Nv;function Nv(e,t){return new L(e,t).patch}k.compare=ut;function ut(e,t,r){return new L(e,r).compare(new L(t,r))}k.compareLoose=Lv;function Lv(e,t){return ut(e,t,!0)}k.rcompare=Mv;function Mv(e,t,r){return ut(t,e,r)}k.sort=Fv;function Fv(e,t){return e.sort(function(r,n){return k.compare(r,n,t)})}k.rsort=Hv;function Hv(e,t){return e.sort(function(r,n){return k.rcompare(r,n,t)})}k.gt=Zr;function Zr(e,t,r){return ut(e,t,r)>0}k.lt=ui;function ui(e,t,r){return ut(e,t,r)<0}k.eq=Us;function Us(e,t,r){return ut(e,t,r)===0}k.neq=cc;function cc(e,t,r){return ut(e,t,r)!==0}k.gte=$s;function $s(e,t,r){return ut(e,t,r)>=0}k.lte=Vs;function Vs(e,t,r){return ut(e,t,r)<=0}k.cmp=ci;function ci(e,t,r,n){switch(t){case"===":return typeof e=="object"&&(e=e.version),typeof r=="object"&&(r=r.version),e===r;case"!==":return typeof e=="object"&&(e=e.version),typeof r=="object"&&(r=r.version),e!==r;case"":case"=":case"==":return Us(e,r,n);case"!=":return cc(e,r,n);case">":return Zr(e,r,n);case">=":return $s(e,r,n);case"<":return ui(e,r,n);case"<=":return Vs(e,r,n);default:throw new TypeError("Invalid operator: "+t)}}k.Comparator=Le;function Le(e,t){if((!t||typeof t!="object")&&(t={loose:!!t,includePrerelease:!1}),e instanceof Le){if(e.loose===!!t.loose)return e;e=e.value}if(!(this instanceof Le))return new Le(e,t);e=e.trim().split(/\s+/).join(" "),U("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===tn?this.value="":this.value=this.operator+this.semver.version,U("comp",this)}var tn={};Le.prototype.parse=function(e){var t=this.options.loose?Q[Hs]:Q[js],r=e.match(t);if(!r)throw new TypeError("Invalid comparator: "+e);this.operator=r[1],this.operator==="="&&(this.operator=""),r[2]?this.semver=new L(r[2],this.options.loose):this.semver=tn};Le.prototype.toString=function(){return this.value};Le.prototype.test=function(e){return U("Comparator.test",e,this.options.loose),this.semver===tn?!0:(typeof e=="string"&&(e=new L(e,this.options)),ci(e,this.operator,this.semver,this.options))};Le.prototype.intersects=function(e,t){if(!(e instanceof Le))throw new TypeError("a Comparator is required");(!t||typeof t!="object")&&(t={loose:!!t,includePrerelease:!1});var r;if(this.operator==="")return r=new K(e.value,t),li(this.value,r,t);if(e.operator==="")return r=new K(this.value,t),li(e.semver,r,t);var n=(this.operator===">="||this.operator===">")&&(e.operator===">="||e.operator===">"),i=(this.operator==="<="||this.operator==="<")&&(e.operator==="<="||e.operator==="<"),s=this.semver.version===e.semver.version,a=(this.operator===">="||this.operator==="<=")&&(e.operator===">="||e.operator==="<="),o=ci(this.semver,"<",e.semver,t)&&(this.operator===">="||this.operator===">")&&(e.operator==="<="||e.operator==="<"),u=ci(this.semver,">",e.semver,t)&&(this.operator==="<="||this.operator==="<")&&(e.operator===">="||e.operator===">");return n||i||s&&a||o||u};k.Range=K;function K(e,t){if((!t||typeof t!="object")&&(t={loose:!!t,includePrerelease:!1}),e instanceof K)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new K(e.raw,t);if(e instanceof Le)return new K(e.value,t);if(!(this instanceof K))return new K(e,t);if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map(function(r){return this.parseRange(r.trim())},this).filter(function(r){return r.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+this.raw);this.format()}K.prototype.format=function(){return this.range=this.set.map(function(e){return e.join(" ").trim()}).join("||").trim(),this.range};K.prototype.toString=function(){return this.range};K.prototype.parseRange=function(e){var t=this.options.loose,r=t?Q[oc]:Q[ac];e=e.replace(r,Xv),U("hyphen replace",e),e=e.replace(Q[jt],Sv),U("comparator trim",e,Q[jt]),e=e.replace(Q[hr],Iv),e=e.replace(Q[vr],xv);var n=t?Q[Hs]:Q[js],i=e.split(" ").map(function(s){return Uv(s,this.options)},this).join(" ").split(/\s+/);return this.options.loose&&(i=i.filter(function(s){return!!s.match(n)})),i=i.map(function(s){return new Le(s,this.options)},this),i};K.prototype.intersects=function(e,t){if(!(e instanceof K))throw new TypeError("a Range is required");return this.set.some(function(r){return r.every(function(n){return e.set.some(function(i){return i.every(function(s){return n.intersects(s,t)})})})})};k.toComparators=jv;function jv(e,t){return new K(e,t).set.map(function(r){return r.map(function(n){return n.value}).join(" ").trim().split(" ")})}function Uv(e,t){return U("comp",e,t),e=Bv(e,t),U("caret",e),e=$v(e,t),U("tildes",e),e=zv(e,t),U("xrange",e),e=Wv(e,t),U("stars",e),e}function Te(e){return!e||e.toLowerCase()==="x"||e==="*"}function $v(e,t){return e.trim().split(/\s+/).map(function(r){return Vv(r,t)}).join(" ")}function Vv(e,t){var r=t.loose?Q[nc]:Q[rc];return e.replace(r,function(n,i,s,a,o){U("tilde",e,n,i,s,a,o);var u;return Te(i)?u="":Te(s)?u=">="+i+".0.0 <"+(+i+1)+".0.0":Te(a)?u=">="+i+"."+s+".0 <"+i+"."+(+s+1)+".0":o?(U("replaceTilde pr",o),u=">="+i+"."+s+"."+a+"-"+o+" <"+i+"."+(+s+1)+".0"):u=">="+i+"."+s+"."+a+" <"+i+"."+(+s+1)+".0",U("tilde return",u),u})}function Bv(e,t){return e.trim().split(/\s+/).map(function(r){return Gv(r,t)}).join(" ")}function Gv(e,t){U("caret",e,t);var r=t.loose?Q[sc]:Q[ic];return e.replace(r,function(n,i,s,a,o){U("caret",e,n,i,s,a,o);var u;return Te(i)?u="":Te(s)?u=">="+i+".0.0 <"+(+i+1)+".0.0":Te(a)?i==="0"?u=">="+i+"."+s+".0 <"+i+"."+(+s+1)+".0":u=">="+i+"."+s+".0 <"+(+i+1)+".0.0":o?(U("replaceCaret pr",o),i==="0"?s==="0"?u=">="+i+"."+s+"."+a+"-"+o+" <"+i+"."+s+"."+(+a+1):u=">="+i+"."+s+"."+a+"-"+o+" <"+i+"."+(+s+1)+".0":u=">="+i+"."+s+"."+a+"-"+o+" <"+(+i+1)+".0.0"):(U("no pr"),i==="0"?s==="0"?u=">="+i+"."+s+"."+a+" <"+i+"."+s+"."+(+a+1):u=">="+i+"."+s+"."+a+" <"+i+"."+(+s+1)+".0":u=">="+i+"."+s+"."+a+" <"+(+i+1)+".0.0"),U("caret return",u),u})}function zv(e,t){return U("replaceXRanges",e,t),e.split(/\s+/).map(function(r){return Qv(r,t)}).join(" ")}function Qv(e,t){e=e.trim();var r=t.loose?Q[ec]:Q[Zu];return e.replace(r,function(n,i,s,a,o,u){U("xRange",e,n,i,s,a,o,u);var c=Te(s),l=c||Te(a),p=l||Te(o),f=p;return i==="="&&f&&(i=""),c?i===">"||i==="<"?n="<0.0.0":n="*":i&&f?(l&&(a=0),o=0,i===">"?(i=">=",l?(s=+s+1,a=0,o=0):(a=+a+1,o=0)):i==="<="&&(i="<",l?s=+s+1:a=+a+1),n=i+s+"."+a+"."+o):l?n=">="+s+".0.0 <"+(+s+1)+".0.0":p&&(n=">="+s+"."+a+".0 <"+s+"."+(+a+1)+".0"),U("xRange return",n),n})}function Wv(e,t){return U("replaceStars",e,t),e.trim().replace(Q[uc],"")}function Xv(e,t,r,n,i,s,a,o,u,c,l,p,f){return Te(r)?t="":Te(n)?t=">="+r+".0.0":Te(i)?t=">="+r+"."+n+".0":t=">="+t,Te(u)?o="":Te(c)?o="<"+(+u+1)+".0.0":Te(l)?o="<"+u+"."+(+c+1)+".0":p?o="<="+u+"."+c+"."+l+"-"+p:o="<="+o,(t+" "+o).trim()}K.prototype.test=function(e){if(!e)return!1;typeof e=="string"&&(e=new L(e,this.options));for(var t=0;t<this.set.length;t++)if(Kv(this.set[t],e,this.options))return!0;return!1};function Kv(e,t,r){for(var n=0;n<e.length;n++)if(!e[n].test(t))return!1;if(t.prerelease.length&&!r.includePrerelease){for(n=0;n<e.length;n++)if(U(e[n].semver),e[n].semver!==tn&&e[n].semver.prerelease.length>0){var i=e[n].semver;if(i.major===t.major&&i.minor===t.minor&&i.patch===t.patch)return!0}return!1}return!0}k.satisfies=li;function li(e,t,r){try{t=new K(t,r)}catch{return!1}return t.test(e)}k.maxSatisfying=Jv;function Jv(e,t,r){var n=null,i=null;try{var s=new K(t,r)}catch{return null}return e.forEach(function(a){s.test(a)&&(!n||i.compare(a)===-1)&&(n=a,i=new L(n,r))}),n}k.minSatisfying=Yv;function Yv(e,t,r){var n=null,i=null;try{var s=new K(t,r)}catch{return null}return e.forEach(function(a){s.test(a)&&(!n||i.compare(a)===1)&&(n=a,i=new L(n,r))}),n}k.minVersion=Zv;function Zv(e,t){e=new K(e,t);var r=new L("0.0.0");if(e.test(r)||(r=new L("0.0.0-0"),e.test(r)))return r;r=null;for(var n=0;n<e.set.length;++n){var i=e.set[n];i.forEach(function(s){var a=new L(s.semver.version);switch(s.operator){case">":a.prerelease.length===0?a.patch++:a.prerelease.push(0),a.raw=a.format();case"":case">=":(!r||Zr(r,a))&&(r=a);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+s.operator)}})}return r&&e.test(r)?r:null}k.validRange=eg;function eg(e,t){try{return new K(e,t).range||"*"}catch{return null}}k.ltr=tg;function tg(e,t,r){return Bs(e,t,"<",r)}k.gtr=rg;function rg(e,t,r){return Bs(e,t,">",r)}k.outside=Bs;function Bs(e,t,r,n){e=new L(e,n),t=new K(t,n);var i,s,a,o,u;switch(r){case">":i=Zr,s=Vs,a=ui,o=">",u=">=";break;case"<":i=ui,s=$s,a=Zr,o="<",u="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(li(e,t,n))return!1;for(var c=0;c<t.set.length;++c){var l=t.set[c],p=null,f=null;if(l.forEach(function(d){d.semver===tn&&(d=new Le(">=0.0.0")),p=p||d,f=f||d,i(d.semver,p.semver,n)?p=d:a(d.semver,f.semver,n)&&(f=d)}),p.operator===o||p.operator===u||(!f.operator||f.operator===o)&&s(e,f.semver))return!1;if(f.operator===u&&a(e,f.semver))return!1}return!0}k.prerelease=ng;function ng(e,t){var r=Ut(e,t);return r&&r.prerelease.length?r.prerelease:null}k.intersects=ig;function ig(e,t,r){return e=new K(e,r),t=new K(t,r),e.intersects(t)}k.coerce=sg;function sg(e){if(e instanceof L)return e;if(typeof e!="string")return null;var t=e.match(Q[tc]);return t==null?null:Ut(t[1]+"."+(t[2]||"0")+"."+(t[3]||"0"))}});var zs=h(Gs=>{"use strict";Object.defineProperty(Gs,"__esModule",{value:!0});var ag=require("path"),og=hi(),fc=require("module"),ug=Object.keys(process.binding("natives")),pc=fc.prototype.require;function cg(e){var t={};return function(n){var i=pc.apply(this,arguments);if(e[n]){var s=fc._resolveFilename(n,this);if(t.hasOwnProperty(s))return t[s];var a=void 0;if(ug.indexOf(n)<0)try{a=pc.call(this,ag.join(n,"package.json")).version}catch{return i}else a=process.version.substring(1);var o=a.indexOf("-");o>=0&&(a=a.substring(0,o));for(var u=i,c=0,l=e[n];c<l.length;c++){var p=l[c];og.satisfies(a,p.versionSpecifier)&&(u=p.patch(u,s))}return t[s]=u}return i}}Gs.makePatchingRequire=cg});var dc=h((Fb,lg)=>{lg.exports={name:"diagnostic-channel",version:"0.3.1",main:"./dist/src/channel.js",types:"./dist/src/channel.d.ts",scripts:{build:"tsc",lint:"tslint -c tslint.json -p tsconfig.json",clean:"rimraf ./dist",test:"mocha ./dist/tests/**/*.js"},homepage:"https://github.com/Microsoft/node-diagnostic-channel",bugs:{url:"https://github.com/Microsoft/node-diagnostic-channel/issues"},repository:{type:"git",url:"https://github.com/Microsoft/node-diagnostic-channel.git"},description:"Provides a context-saving pub/sub channel to connect diagnostic event publishers and subscribers",dependencies:{semver:"^5.3.0"},devDependencies:{"@types/mocha":"^2.2.40","@types/node":"^7.0.12",mocha:"^3.2.0",rimraf:"^2.6.1",tslint:"^5.0.0",typescript:"^2.2.1"},files:["dist/src/**/*.d.ts","dist/src/**/*.js","LICENSE","README.md","package.json"],license:"MIT"}});var ee=h(vi=>{"use strict";Object.defineProperty(vi,"__esModule",{value:!0});var pg=zs(),fg=zs();vi.makePatchingRequire=fg.makePatchingRequire;var hc=function(e){return!0},dg=function(){function e(){this.version=dc().version,this.subscribers={},this.contextPreservationFunction=function(t){return t},this.knownPatches={},this.currentlyPublishing=!1}return e.prototype.shouldPublish=function(t){var r=this.subscribers[t];return r?r.some(function(n){var i=n.filter;return!i||i(!1)}):!1},e.prototype.publish=function(t,r){if(!this.currentlyPublishing){var n=this.subscribers[t];if(n){var i={timestamp:Date.now(),data:r};this.currentlyPublishing=!0,n.forEach(function(s){var a=s.listener,o=s.filter;try{o&&o(!0)&&a(i)}catch{}}),this.currentlyPublishing=!1}}},e.prototype.subscribe=function(t,r,n){n===void 0&&(n=hc),this.subscribers[t]||(this.subscribers[t]=[]),this.subscribers[t].push({listener:r,filter:n})},e.prototype.unsubscribe=function(t,r,n){n===void 0&&(n=hc);var i=this.subscribers[t];if(i){for(var s=0;s<i.length;++s)if(i[s].listener===r&&i[s].filter===n)return i.splice(s,1),!0}return!1},e.prototype.reset=function(){var t=this;this.subscribers={},this.contextPreservationFunction=function(r){return r},Object.getOwnPropertyNames(this.knownPatches).forEach(function(r){return delete t.knownPatches[r]})},e.prototype.bindToContext=function(t){return this.contextPreservationFunction(t)},e.prototype.addContextPreservation=function(t){var r=this.contextPreservationFunction;this.contextPreservationFunction=function(n){return t(r(n))}},e.prototype.registerMonkeyPatch=function(t,r){this.knownPatches[t]||(this.knownPatches[t]=[]),this.knownPatches[t].push(r)},e.prototype.getPatchesObject=function(){return this.knownPatches},e}();global.diagnosticsSource||(global.diagnosticsSource=new dg,vc=require("module"),vc.prototype.require=pg.makePatchingRequire(global.diagnosticsSource.getPatchesObject()));var vc;vi.channel=global.diagnosticsSource});var mc=h(ct=>{"use strict";var hg=ct&&ct.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e};Object.defineProperty(ct,"__esModule",{value:!0});var gi=ee();ct.AzureMonitorSymbol="Azure_Monitor_Tracer";var gc=!1,vg=function(e){if(gc)return e;try{var t=require("@opentelemetry/tracing"),r=require("@opentelemetry/api"),n=gi.channel.spanContextPropagator?{contextManager:gi.channel.spanContextPropagator}:void 0;new t.BasicTracerProvider().register(n);var i=r.trace.getTracer("applicationinsights tracer"),s=i.startSpan;i.startSpan=function(a,o){if(!o||!o.parent){var u=r.getSpan(r.context.active());u&&u.operation&&u.operation.traceparent&&(o=hg({},o,{parent:{traceId:u.operation.traceparent.traceId,spanId:u.operation.traceparent.spanId,traceFlags:1}}))}var c=s.call(this,a,o),l=c.end;return c.end=function(){var p=l.apply(this,arguments);return gi.channel.publish("azure-coretracing",c),p},c},r.getSpan(r.context.active()),i[ct.AzureMonitorSymbol]=!0,e.setTracer(i),gc=!0}catch{}return e};ct.azureCoreTracing={versionSpecifier:">= 1.0.0 < 2.0.0",patch:vg};function gg(){gi.channel.registerMonkeyPatch("@azure/core-tracing",ct.azureCoreTracing)}ct.enable=gg});var _c=h(rn=>{"use strict";Object.defineProperty(rn,"__esModule",{value:!0});var yc=ee(),mg=function(e){var t=e.prototype._emit;return e.prototype._emit=function(r,n){var i=t.apply(this,arguments);if(!n){var s=i;s||(s=t.call(this,r,!0)),yc.channel.publish("bunyan",{level:r.level,result:s})}return i},e};rn.bunyan={versionSpecifier:">= 1.0.0 < 2.0.0",patch:mg};function yg(){yc.channel.registerMonkeyPatch("bunyan",rn.bunyan)}rn.enable=yg});var Ec=h(nn=>{"use strict";Object.defineProperty(nn,"__esModule",{value:!0});var Qs=ee(),Cc=require("stream"),_g=function(e){var t=new Cc.Writable,r=new Cc.Writable;t.write=function(c){if(!c)return!0;var l=c.toString();return Qs.channel.publish("console",{message:l}),!0},r.write=function(c){if(!c)return!0;var l=c.toString();return Qs.channel.publish("console",{message:l,stderr:!0}),!0};for(var n=new e.Console(t,r),i=["log","info","warn","error","dir","time","timeEnd","trace","assert"],s=function(c){var l=e[c];l&&(e[c]=function(){if(n[c])try{n[c].apply(n,arguments)}catch{}return l.apply(e,arguments)})},a=0,o=i;a<o.length;a++){var u=o[a];s(u)}return e};nn.console={versionSpecifier:">= 4.0.0",patch:_g};function Cg(){Qs.channel.registerMonkeyPatch("console",nn.console),require("console")}nn.enable=Cg});var bc=h(sn=>{"use strict";Object.defineProperty(sn,"__esModule",{value:!0});var Ws=ee(),Eg=function(e){var t=e.Server.prototype.connect;return e.Server.prototype.connect=function(){var n=t.apply(this,arguments),i=this.s.pool.write;this.s.pool.write=function(){var o=typeof arguments[1]=="function"?1:2;return typeof arguments[o]=="function"&&(arguments[o]=Ws.channel.bindToContext(arguments[o])),i.apply(this,arguments)};var s=this.s.pool.logout;return this.s.pool.logout=function(){return typeof arguments[1]=="function"&&(arguments[1]=Ws.channel.bindToContext(arguments[1])),s.apply(this,arguments)},n},e};sn.mongoCore={versionSpecifier:">= 2.0.0 < 4.0.0",patch:Eg};function bg(){Ws.channel.registerMonkeyPatch("mongodb-core",sn.mongoCore)}sn.enable=bg});var wc=h(Ge=>{"use strict";var Tc=Ge&&Ge.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e};Object.defineProperty(Ge,"__esModule",{value:!0});var ye=ee(),Tg=function(e){var t=e.instrument({operationIdGenerator:{next:function(){return ye.channel.bindToContext(function(n){return n()})}}}),r={};return t.on("started",function(n){r[n.requestId]||(r[n.requestId]=Tc({},n,{time:new Date}))}),t.on("succeeded",function(n){var i=r[n.requestId];i&&delete r[n.requestId],typeof n.operationId=="function"?n.operationId(function(){return ye.channel.publish("mongodb",{startedData:i,event:n,succeeded:!0})}):ye.channel.publish("mongodb",{startedData:i,event:n,succeeded:!0})}),t.on("failed",function(n){var i=r[n.requestId];i&&delete r[n.requestId],typeof n.operationId=="function"?n.operationId(function(){return ye.channel.publish("mongodb",{startedData:i,event:n,succeeded:!1})}):ye.channel.publish("mongodb",{startedData:i,event:n,succeeded:!1})}),e},wg=function(e){var t=e.instrument(),r={},n={};return t.on("started",function(i){r[i.requestId]||(n[i.requestId]=ye.channel.bindToContext(function(s){return s()}),r[i.requestId]=Tc({},i,{time:new Date}))}),t.on("succeeded",function(i){var s=r[i.requestId];s&&delete r[i.requestId],typeof i=="object"&&typeof n[i.requestId]=="function"&&(n[i.requestId](function(){return ye.channel.publish("mongodb",{startedData:s,event:i,succeeded:!0})}),delete n[i.requestId])}),t.on("failed",function(i){var s=r[i.requestId];s&&delete r[i.requestId],typeof i=="object"&&typeof n[i.requestId]=="function"&&(n[i.requestId](function(){return ye.channel.publish("mongodb",{startedData:s,event:i,succeeded:!1})}),delete n[i.requestId])}),e},Ig=function(e){var t=e.Server.prototype.connect;return e.Server.prototype.connect=function(){var n=t.apply(this,arguments),i=this.s.coreTopology.s.pool.write;this.s.coreTopology.s.pool.write=function(){var o=typeof arguments[1]=="function"?1:2;return typeof arguments[o]=="function"&&(arguments[o]=ye.channel.bindToContext(arguments[o])),i.apply(this,arguments)};var s=this.s.coreTopology.s.pool.logout;return this.s.coreTopology.s.pool.logout=function(){return typeof arguments[1]=="function"&&(arguments[1]=ye.channel.bindToContext(arguments[1])),s.apply(this,arguments)},n},e},xg=function(e){Ig(e);var t=e.instrument(),r={},n={};return t.on("started",function(i){r[i.requestId]||(n[i.requestId]=ye.channel.bindToContext(function(s){return s()}),r[i.requestId]=i)}),t.on("succeeded",function(i){var s=r[i.requestId];s&&delete r[i.requestId],typeof i=="object"&&typeof n[i.requestId]=="function"&&(n[i.requestId](function(){return ye.channel.publish("mongodb",{startedData:s,event:i,succeeded:!0})}),delete n[i.requestId])}),t.on("failed",function(i){var s=r[i.requestId];s&&delete r[i.requestId],typeof i=="object"&&typeof n[i.requestId]=="function"&&(n[i.requestId](function(){return ye.channel.publish("mongodb",{startedData:s,event:i,succeeded:!1})}),delete n[i.requestId])}),e};Ge.mongo2={versionSpecifier:">= 2.0.0 <= 3.0.5",patch:Tg};Ge.mongo3={versionSpecifier:"> 3.0.5 < 3.3.0",patch:wg};Ge.mongo330={versionSpecifier:">= 3.3.0 < 4.0.0",patch:xg};function Sg(){ye.channel.registerMonkeyPatch("mongodb",Ge.mongo2),ye.channel.registerMonkeyPatch("mongodb",Ge.mongo3),ye.channel.registerMonkeyPatch("mongodb",Ge.mongo330)}Ge.enable=Sg});var xc=h(an=>{"use strict";Object.defineProperty(an,"__esModule",{value:!0});var mi=ee(),Ic=require("path"),kg=function(e,t){var r=function(u,c){return function(l,p){var f=u[l];f&&(u[l]=function(){for(var g=arguments.length-1,b=arguments.length-1;b>=0;--b)if(typeof arguments[b]=="function"){g=b;break}else if(typeof arguments[b]<"u")break;var x=arguments[g],A={result:null,startTime:null,startDate:null};typeof x=="function"&&(p?(A.startTime=process.hrtime(),A.startDate=new Date,arguments[g]=mi.channel.bindToContext(p(A,x))):arguments[g]=mi.channel.bindToContext(x));var y=f.apply(this,arguments);return A.result=y,y})}},n=function(u,c){return r(u.prototype,c+".prototype")},i=["connect","changeUser","ping","statistics","end"],s=require(Ic.dirname(t)+"/lib/Connection");i.forEach(function(u){return n(s,"Connection")(u)}),r(s,"Connection")("createQuery",function(u,c){return function(l){var p=process.hrtime(u.startTime),f=p[0]*1e3+p[1]/1e6|0;mi.channel.publish("mysql",{query:u.result,callbackArgs:arguments,err:l,duration:f,time:u.startDate}),c.apply(this,arguments)}});var a=["_enqueueCallback"],o=require(Ic.dirname(t)+"/lib/Pool");return a.forEach(function(u){return n(o,"Pool")(u)}),e};an.mysql={versionSpecifier:">= 2.0.0 < 3.0.0",patch:kg};function Pg(){mi.channel.registerMonkeyPatch("mysql",an.mysql)}an.enable=Pg});var kc=h(on=>{"use strict";Object.defineProperty(on,"__esModule",{value:!0});var Sc=ee();function Ag(e){var t=e.prototype.connect;return e.prototype.connect=function(n){return n&&(arguments[0]=Sc.channel.bindToContext(n)),t.apply(this,arguments)},e}on.postgresPool1={versionSpecifier:">= 1.0.0 < 3.0.0",patch:Ag};function Dg(){Sc.channel.registerMonkeyPatch("pg-pool",on.postgresPool1)}on.enable=Dg});var Ac=h($t=>{"use strict";Object.defineProperty($t,"__esModule",{value:!0});var mr=ee(),Pc=require("events");function Rg(e,t){var r=e.Client.prototype.query,n="__diagnosticOriginalFunc";return e.Client.prototype.query=function(s,a,o){var u={query:{},database:{host:this.connectionParameters.host,port:this.connectionParameters.port},result:null,error:null,duration:0,time:new Date},c=process.hrtime(),l;function p(f){f&&f[n]&&(f=f[n]);var d=mr.channel.bindToContext(function(g,b){var x=process.hrtime(c);if(u.result=b&&{rowCount:b.rowCount,command:b.command},u.error=g,u.duration=Math.ceil(x[0]*1e3+x[1]/1e6),mr.channel.publish("postgres",u),g){if(f)return f.apply(this,arguments);l&&l instanceof Pc.EventEmitter&&l.emit("error",g)}else f&&f.apply(this,arguments)});try{return Object.defineProperty(d,n,{value:f}),d}catch{return f}}try{typeof s=="string"?a instanceof Array?(u.query.preparable={text:s,args:a},o=p(o)):(u.query.text=s,o?o=p(o):a=p(a)):(typeof s.name=="string"?u.query.plan=s.name:s.values instanceof Array?u.query.preparable={text:s.text,args:s.values}:u.query.text=s.text,o?o=p(o):a?a=p(a):s.callback=p(s.callback))}catch{return r.apply(this,arguments)}return arguments[0]=s,arguments[1]=a,arguments[2]=o,arguments.length=arguments.length>3?arguments.length:3,l=r.apply(this,arguments),l},e}function Og(e,t){var r=e.Client.prototype.query,n="__diagnosticOriginalFunc";return e.Client.prototype.query=function(s,a,o){var u=this,c=!!o,l={query:{},database:{host:this.connectionParameters.host,port:this.connectionParameters.port},result:null,error:null,duration:0,time:new Date},p=process.hrtime(),f;function d(g){g&&g[n]&&(g=g[n]);var b=mr.channel.bindToContext(function(x,A){var y=process.hrtime(p);if(l.result=A&&{rowCount:A.rowCount,command:A.command},l.error=x,l.duration=Math.ceil(y[0]*1e3+y[1]/1e6),mr.channel.publish("postgres",l),x){if(g)return g.apply(this,arguments);f&&f instanceof Pc.EventEmitter&&f.emit("error",x)}else g&&g.apply(this,arguments)});try{return Object.defineProperty(b,n,{value:g}),b}catch{return g}}try{typeof s=="string"?a instanceof Array?(l.query.preparable={text:s,args:a},c=typeof o=="function",o=c?d(o):o):(l.query.text=s,o?(c=typeof o=="function",o=c?d(o):o):(c=typeof a=="function",a=c?d(a):a)):(typeof s.name=="string"?l.query.plan=s.name:s.values instanceof Array?l.query.preparable={text:s.text,args:s.values}:l.query.text=s.text,o?(c=typeof o=="function",o=d(o)):a?(c=typeof a=="function",a=c?d(a):a):(c=typeof s.callback=="function",s.callback=c?d(s.callback):s.callback))}catch{return r.apply(this,arguments)}return arguments[0]=s,arguments[1]=a,arguments[2]=o,arguments.length=arguments.length>3?arguments.length:3,f=r.apply(this,arguments),c?f:f.then(function(g){return d()(void 0,g),new u._Promise(function(b,x){b(g)})}).catch(function(g){return d()(g,void 0),new u._Promise(function(b,x){x(g)})})},e}$t.postgres6={versionSpecifier:"6.*",patch:Rg};$t.postgres7={versionSpecifier:">=7.* <=8.*",patch:Og};function qg(){mr.channel.registerMonkeyPatch("pg",$t.postgres6),mr.channel.registerMonkeyPatch("pg",$t.postgres7)}$t.enable=qg});var Dc=h(un=>{"use strict";Object.defineProperty(un,"__esModule",{value:!0});var Xs=ee(),Ng=function(e){var t=e.RedisClient.prototype.internal_send_command;return e.RedisClient.prototype.internal_send_command=function(r){if(r){var n=r.callback;if(!n||!n.pubsubBound){var i=this.address,s=process.hrtime(),a=new Date;r.callback=Xs.channel.bindToContext(function(o,u){var c=process.hrtime(s),l=c[0]*1e3+c[1]/1e6|0;Xs.channel.publish("redis",{duration:l,address:i,commandObj:r,err:o,result:u,time:a}),typeof n=="function"&&n.apply(this,arguments)}),r.callback.pubsubBound=!0}}return t.call(this,r)},e};un.redis={versionSpecifier:">= 2.0.0 < 4.0.0",patch:Ng};function Lg(){Xs.channel.registerMonkeyPatch("redis",un.redis)}un.enable=Lg});var Rc=h(Vt=>{"use strict";var Mg=Vt&&Vt.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e};Object.defineProperty(Vt,"__esModule",{value:!0});var Ks=ee(),Fg=function(e){var t=e.Connection.prototype.makeRequest;return e.Connection.prototype.makeRequest=function(){function n(s){var a=process.hrtime(),o={query:{},database:{host:null,port:null},result:null,error:null,duration:0};return Ks.channel.bindToContext(function(u,c,l){var p=process.hrtime(a);o=Mg({},o,{database:{host:this.connection.config.server,port:this.connection.config.options.port},result:!u&&{rowCount:c,rows:l},query:{text:this.parametersByName.statement.value},error:u,duration:Math.ceil(p[0]*1e3+p[1]/1e6)}),Ks.channel.publish("tedious",o),s.call(this,u,c,l)})}var i=arguments[0];arguments[0].callback=n(i.callback),t.apply(this,arguments)},e};Vt.tedious={versionSpecifier:">= 6.0.0 < 9.0.0",patch:Fg};function Hg(){Ks.channel.registerMonkeyPatch("tedious",Vt.tedious)}Vt.enable=Hg});var Oc=h(ze=>{"use strict";var jg=ze&&ze.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ug=ze&&ze.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&(r[n[i]]=e[n[i]]);return r};Object.defineProperty(ze,"__esModule",{value:!0});var yi=ee(),$g=function(e){var t=e.Logger.prototype.log,r,n=function(i,s,a){var o;return r===e.config.npm.levels?o="npm":r===e.config.syslog.levels?o="syslog":o="unknown",yi.channel.publish("winston",{level:i,message:s,meta:a,levelKind:o}),s};return e.Logger.prototype.log=function(){return r=this.levels,!this.filters||this.filters.length===0?this.filters=[n]:this.filters[this.filters.length-1]!==n&&(this.filters=this.filters.filter(function(s){return s!==n}),this.filters.push(n)),t.apply(this,arguments)},e},Vg=function(e){var t=function(a,o){var u;return a.config.npm.levels[o]!=null?u="npm":a.config.syslog.levels[o]!=null?u="syslog":u="unknown",u},r=function(a){jg(o,a);function o(u,c){var l=a.call(this,c)||this;return l.winston=u,l}return o.prototype.log=function(u,c){var l=u.message,p=u.level,f=u.meta,d=Ug(u,["message","level","meta"]);p=typeof Symbol.for=="function"?u[Symbol.for("level")]:p,l=u instanceof Error?u:l;var g=t(this.winston,p);f=f||{};for(var b in d)d.hasOwnProperty(b)&&(f[b]=d[b]);yi.channel.publish("winston",{message:l,level:p,levelKind:g,meta:f}),c()},o}(e.Transport);function n(){var a=arguments[0].levels||e.config.npm.levels,o;for(var u in a)a.hasOwnProperty(u)&&(o=o===void 0||a[u]>a[o]?u:o);this.add(new r(e,{level:o}))}var i=e.createLogger;e.createLogger=function(){var o=arguments[0].levels||e.config.npm.levels,u;for(var c in o)o.hasOwnProperty(c)&&(u=u===void 0||o[c]>o[u]?c:u);var l=i.apply(this,arguments);l.add(new r(e,{level:u}));var p=l.configure;return l.configure=function(){p.apply(this,arguments),n.apply(this,arguments)},l};var s=e.configure;return e.configure=function(){s.apply(this,arguments),n.apply(this,arguments)},e.add(new r(e)),e};ze.winston3={versionSpecifier:"3.x",patch:Vg};ze.winston2={versionSpecifier:"2.x",patch:$g};function Bg(){yi.channel.registerMonkeyPatch("winston",ze.winston2),yi.channel.registerMonkeyPatch("winston",ze.winston3)}ze.enable=Bg});var Gc=h(ke=>{"use strict";Object.defineProperty(ke,"__esModule",{value:!0});var qc=mc();ke.azuresdk=qc;var Nc=_c();ke.bunyan=Nc;var Lc=Ec();ke.console=Lc;var Mc=bc();ke.mongodbCore=Mc;var Fc=wc();ke.mongodb=Fc;var Hc=xc();ke.mysql=Hc;var jc=kc();ke.pgPool=jc;var Uc=Ac();ke.pg=Uc;var $c=Dc();ke.redis=$c;var Vc=Rc();ke.tedious=Vc;var Bc=Oc();ke.winston=Bc;function Gg(){Nc.enable(),Lc.enable(),Mc.enable(),Fc.enable(),Hc.enable(),Uc.enable(),jc.enable(),$c.enable(),Bc.enable(),qc.enable(),Vc.enable()}ke.enable=Gg});var Ei=h(yr=>{"use strict";Object.defineProperty(yr,"__esModule",{value:!0});var zg=ii(),Js=de();yr.IsInitialized=!process.env.APPLICATION_INSIGHTS_NO_DIAGNOSTIC_CHANNEL;var Ys="DiagnosticChannel";if(yr.IsInitialized){Qe=Gc(),zc=process.env.APPLICATION_INSIGHTS_NO_PATCH_MODULES||"",_i=zc.split(","),Zs={bunyan:Qe.bunyan,console:Qe.console,mongodb:Qe.mongodb,mongodbCore:Qe.mongodbCore,mysql:Qe.mysql,redis:Qe.redis,pg:Qe.pg,pgPool:Qe.pgPool,winston:Qe.winston,azuresdk:Qe.azuresdk};for(Ci in Zs)_i.indexOf(Ci)===-1&&(Zs[Ci].enable(),Js.info(Ys,"Subscribed to "+Ci+" events"));_i.length>0&&Js.info(Ys,"Some modules will not be patched",_i)}else Js.info(Ys,"Not subscribing to dependency autocollection because APPLICATION_INSIGHTS_NO_DIAGNOSTIC_CHANNEL was set");var Qe,zc,_i,Zs,Ci;function Qg(e){if(!!yr.IsInitialized){var t=ee();t.channel.addContextPreservation(e),t.channel.spanContextPropagator=zg.AsyncScopeManager}}yr.registerContextPreservation=Qg});var _r=h((Zb,Qc)=>{"use strict";Qc.exports={requestContextHeader:"request-context",requestContextSourceKey:"appId",requestContextTargetKey:"appId",requestIdHeader:"request-id",parentIdHeader:"x-ms-request-id",rootIdHeader:"x-ms-request-root-id",correlationContextHeader:"correlation-context",traceparentHeader:"traceparent",traceStateHeader:"tracestate"}});var Re=h((ra,Xc)=>{"use strict";var ea=ra&&ra.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},Wg=require("http"),Wc=require("https"),ta=require("url"),bi=require("constants"),cn=de(),Cr=_r(),Xg=function(){function e(){}return e.getCookie=function(t,r){var n="";if(t&&t.length&&typeof r=="string")for(var i=t+"=",s=r.split(";"),a=0;a<s.length;a++){var r=s[a];if(r=e.trim(r),r&&r.indexOf(i)===0){n=r.substring(i.length,s[a].length);break}}return n},e.trim=function(t){return typeof t=="string"?t.replace(/^\s+|\s+$/g,""):""},e.int32ArrayToBase64=function(t){var r=function(o,u){return String.fromCharCode(o>>u&255)},n=function(o){return r(o,24)+r(o,16)+r(o,8)+r(o,0)},i=t.map(n).join(""),s=Buffer.from?Buffer.from(i,"binary"):new Buffer(i,"binary"),a=s.toString("base64");return a.substr(0,a.indexOf("="))},e.random32=function(){return 4294967296*Math.random()|0},e.randomu32=function(){return e.random32()+2147483648},e.w3cTraceId=function(){for(var t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],r="",n,i=0;i<4;i++)n=e.random32(),r+=t[n&15]+t[n>>4&15]+t[n>>8&15]+t[n>>12&15]+t[n>>16&15]+t[n>>20&15]+t[n>>24&15]+t[n>>28&15];var s=t[8+Math.random()*4|0];return r.substr(0,8)+r.substr(9,4)+"4"+r.substr(13,3)+s+r.substr(16,3)+r.substr(19,12)},e.w3cSpanId=function(){return e.w3cTraceId().substring(16)},e.isValidW3CId=function(t){return t.length===32&&t!=="00000000000000000000000000000000"},e.isArray=function(t){return Object.prototype.toString.call(t)==="[object Array]"},e.isError=function(t){return t instanceof Error},e.isPrimitive=function(t){var r=typeof t;return r==="string"||r==="number"||r==="boolean"},e.isDate=function(t){return Object.prototype.toString.call(t)==="[object Date]"},e.msToTimeSpan=function(t){(isNaN(t)||t<0)&&(t=0);var r=(t/1e3%60).toFixed(7).replace(/0{0,4}$/,""),n=""+Math.floor(t/(1e3*60))%60,i=""+Math.floor(t/(1e3*60*60))%24,s=Math.floor(t/(1e3*60*60*24));r=r.indexOf(".")<2?"0"+r:r,n=n.length<2?"0"+n:n,i=i.length<2?"0"+i:i;var a=s>0?s+".":"";return a+i+":"+n+":"+r},e.extractError=function(t){var r=t;return{message:t.message,code:r.code||r.id||""}},e.extractObject=function(t){return t instanceof Error?e.extractError(t):typeof t.toJSON=="function"?t.toJSON():t},e.validateStringMap=function(t){if(typeof t!="object"){cn.info("Invalid properties dropped from payload");return}var r={};for(var n in t){var i="",s=t[n],a=typeof s;if(e.isPrimitive(s))i=s.toString();else if(s===null||a==="undefined")i="";else if(a==="function"){cn.info("key: "+n+" was function; will not serialize");continue}else{var o=e.isArray(s)?s:e.extractObject(s);try{e.isPrimitive(o)?i=o:i=JSON.stringify(o)}catch(u){i=s.constructor.name.toString()+" (Error: "+u.message+")",cn.info("key: "+n+", could not be serialized")}}r[n]=i.substring(0,e.MAX_PROPERTY_LENGTH)}return r},e.canIncludeCorrelationHeader=function(t,r){var n=t&&t.config&&t.config.correlationHeaderExcludedDomains;if(!n||n.length==0||!r)return!0;for(var i=0;i<n.length;i++){var s=new RegExp(n[i].replace(/\./g,".").replace(/\*/g,".*"));if(s.test(ta.parse(r).hostname))return!1}return!0},e.getCorrelationContextTarget=function(t,r){var n=t.headers&&t.headers[Cr.requestContextHeader];if(n)for(var i=n.split(","),s=0;s<i.length;++s){var a=i[s].split("=");if(a.length==2&&a[0]==r)return a[1]}},e.makeRequest=function(t,r,n,i){r&&r.indexOf("//")===0&&(r="https:"+r);var s=ta.parse(r),a=ea({},n,{host:s.hostname,port:s.port,path:s.pathname}),o=void 0;if(s.protocol==="https:"&&(o=t.proxyHttpsUrl||void 0),s.protocol==="http:"&&(o=t.proxyHttpUrl||void 0),o){o.indexOf("//")===0&&(o="http:"+o);var u=ta.parse(o);u.protocol==="https:"?(cn.info("Proxies that use HTTPS are not supported"),o=void 0):a=ea({},a,{host:u.hostname,port:u.port||"80",path:r,headers:ea({},a.headers,{Host:s.hostname})})}var c=s.protocol==="https:"&&!o;return c&&t.httpsAgent!==void 0?a.agent=t.httpsAgent:!c&&t.httpAgent!==void 0?a.agent=t.httpAgent:c&&(a.agent=e.tlsRestrictedAgent),c?Wc.request(a,i):Wg.request(a,i)},e.safeIncludeCorrelationHeader=function(t,r,n){var i;if(typeof n=="string")i=n;else if(n instanceof Array)i=n.join(",");else if(n&&typeof n.toString=="function")try{i=n.toString()}catch(s){cn.warn("Outgoing request-context header could not be read. Correlation of requests may be lost.",s,n)}i?e.addCorrelationIdHeaderFromString(t,r,i):r.setHeader(Cr.requestContextHeader,Cr.requestContextSourceKey+"="+t.config.correlationId)},e.addCorrelationIdHeaderFromString=function(t,r,n){var i=n.split(","),s=Cr.requestContextSourceKey+"=",a=i.some(function(o){return o.substring(0,s.length)===s});a||r.setHeader(Cr.requestContextHeader,n+","+Cr.requestContextSourceKey+"="+t.config.correlationId)},e.MAX_PROPERTY_LENGTH=8192,e.tlsRestrictedAgent=new Wc.Agent({secureOptions:bi.SSL_OP_NO_SSLv2|bi.SSL_OP_NO_SSLv3|bi.SSL_OP_NO_TLSv1|bi.SSL_OP_NO_TLSv1_1}),e}();Xc.exports=Xg});var Bt=h((eT,Kc)=>{"use strict";var Ti=Re(),na=de(),Kg=function(){function e(){}return e.queryCorrelationId=function(t,r){var n=t.profileQueryEndpoint+"/api/profiles/"+t.instrumentationKey+"/appId";if(e.completedLookups.hasOwnProperty(n)){r(e.completedLookups[n]);return}else if(e.pendingLookups[n]){e.pendingLookups[n].push(r);return}e.pendingLookups[n]=[r];var i=function(){if(!!e.pendingLookups[n]){var s={method:"GET",disableAppInsightsAutoCollection:!0};na.info(e.TAG,s);var a=Ti.makeRequest(t,n,s,function(o){if(o.statusCode===200){var u="";o.setEncoding("utf-8"),o.on("data",function(c){u+=c}),o.on("end",function(){na.info(e.TAG,u);var c=e.correlationIdPrefix+u;e.completedLookups[n]=c,e.pendingLookups[n]&&e.pendingLookups[n].forEach(function(l){return l(c)}),delete e.pendingLookups[n]})}else o.statusCode>=400&&o.statusCode<500?(e.completedLookups[n]=void 0,delete e.pendingLookups[n]):setTimeout(i,t.correlationIdRetryIntervalMs)});a&&(a.on("error",function(o){na.warn(e.TAG,o)}),a.end())}};setTimeout(i,0)},e.cancelCorrelationIdQuery=function(t,r){var n=t.profileQueryEndpoint+"/api/profiles/"+t.instrumentationKey+"/appId",i=e.pendingLookups[n];i&&(e.pendingLookups[n]=i.filter(function(s){return s!=r}),e.pendingLookups[n].length==0&&delete e.pendingLookups[n])},e.generateRequestId=function(t){if(t){t=t[0]=="|"?t:"|"+t,t[t.length-1]!=="."&&(t+=".");var r=(e.currentRootId++).toString(16);return e.appendSuffix(t,r,"_")}else return e.generateRootId()},e.getRootId=function(t){var r=t.indexOf(".");r<0&&(r=t.length);var n=t[0]==="|"?1:0;return t.substring(n,r)},e.generateRootId=function(){return"|"+Ti.w3cTraceId()+"."},e.appendSuffix=function(t,r,n){if(t.length+r.length<e.requestIdMaxLength)return t+r+n;var i=e.requestIdMaxLength-9;if(t.length>i)for(;i>1;--i){var s=t[i-1];if(s==="."||s==="_")break}if(i<=1)return e.generateRootId();for(r=Ti.randomu32().toString(16);r.length<8;)r="0"+r;return t.substring(0,i)+r+"#"},e.TAG="CorrelationIdManager",e.correlationIdPrefix="cid-v1:",e.w3cEnabled=!0,e.pendingLookups={},e.completedLookups={},e.requestIdMaxLength=1024,e.currentRootId=Ti.randomu32(),e}();Kc.exports=Kg});var ln=h((tT,Jc)=>{"use strict";var ve=Re(),Jg=Bt(),Yg=function(){function e(t,r){if(this.traceFlag=e.DEFAULT_TRACE_FLAG,this.version=e.DEFAULT_VERSION,t&&typeof t=="string")if(t.split(",").length>1)this.traceId=ve.w3cTraceId(),this.spanId=ve.w3cTraceId().substr(0,16);else{var n=t.trim().split("-"),i=n.length;i>=4?(this.version=n[0],this.traceId=n[1],this.spanId=n[2],this.traceFlag=n[3]):(this.traceId=ve.w3cTraceId(),this.spanId=ve.w3cTraceId().substr(0,16)),this.version.match(/^[0-9a-f]{2}$/g)||(this.version=e.DEFAULT_VERSION,this.traceId=ve.w3cTraceId()),this.version==="00"&&i!==4&&(this.traceId=ve.w3cTraceId(),this.spanId=ve.w3cTraceId().substr(0,16)),this.version==="ff"&&(this.version=e.DEFAULT_VERSION,this.traceId=ve.w3cTraceId(),this.spanId=ve.w3cTraceId().substr(0,16)),this.version.match(/^0[0-9a-f]$/g)||(this.version=e.DEFAULT_VERSION),this.traceFlag.match(/^[0-9a-f]{2}$/g)||(this.traceFlag=e.DEFAULT_TRACE_FLAG,this.traceId=ve.w3cTraceId()),e.isValidTraceId(this.traceId)||(this.traceId=ve.w3cTraceId()),e.isValidSpanId(this.spanId)||(this.spanId=ve.w3cTraceId().substr(0,16),this.traceId=ve.w3cTraceId()),this.parentId=this.getBackCompatRequestId()}else if(r){this.parentId=r.slice();var s=Jg.getRootId(r);e.isValidTraceId(s)||(this.legacyRootId=s,s=ve.w3cTraceId()),r.indexOf("|")!==-1&&(r=r.substring(1+r.substring(0,r.length-1).lastIndexOf("."),r.length-1)),this.traceId=s,this.spanId=r}else this.traceId=ve.w3cTraceId(),this.spanId=ve.w3cTraceId().substr(0,16)}return e.isValidTraceId=function(t){return t.match(/^[0-9a-f]{32}$/)&&t!=="00000000000000000000000000000000"},e.isValidSpanId=function(t){return t.match(/^[0-9a-f]{16}$/)&&t!=="0000000000000000"},e.prototype.getBackCompatRequestId=function(){return"|"+this.traceId+"."+this.spanId+"."},e.prototype.toString=function(){return this.version+"-"+this.traceId+"-"+this.spanId+"-"+this.traceFlag},e.prototype.updateSpanId=function(){this.spanId=ve.w3cTraceId().substr(0,16)},e.DEFAULT_TRACE_FLAG="01",e.DEFAULT_VERSION="00",e}();Jc.exports=Yg});var ia=h((rT,Yc)=>{"use strict";var Zg=function(){function e(t){this.fieldmap=[],t&&(this.fieldmap=this.parseHeader(t))}return e.prototype.toString=function(){var t=this.fieldmap;return!t||t.length==0?null:t.join(", ")},e.validateKeyChars=function(t){var r=t.split("@");if(r.length==2){var n=r[0].trim(),i=r[1].trim(),s=Boolean(n.match(/^[\ ]?[a-z0-9\*\-\_/]{1,241}$/)),a=Boolean(i.match(/^[\ ]?[a-z0-9\*\-\_/]{1,14}$/));return s&&a}else if(r.length==1)return Boolean(t.match(/^[\ ]?[a-z0-9\*\-\_/]{1,256}$/));return!1},e.prototype.parseHeader=function(t){var r=[],n={},i=t.split(",");if(i.length>32)return null;for(var s=0,a=i;s<a.length;s++){var o=a[s],u=o.trim();if(u.length!==0){var c=u.split("=");if(c.length!==2||!e.validateKeyChars(c[0])||n[c[0]])return null;n[c[0]]=!0,r.push(u)}}return r},e.strict=!0,e}();Yc.exports=Zg});var lt=h((nT,Zc)=>{"use strict";var em=function(){function e(){}return e}();Zc.exports=em});var tl=h((sa,el)=>{"use strict";var tm=sa&&sa.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),rm=lt(),nm=function(e){tm(t,e);function t(){var r=e.call(this)||this;return r.ver=2,r.properties={},r.measurements={},r}return t}(rm);el.exports=nm});var aa=h((iT,rl)=>{"use strict";var im=function(){function e(){}return e}();rl.exports=im});var il=h((sT,nl)=>{"use strict";var sm=function(){function e(){this.applicationVersion="ai.application.ver",this.deviceId="ai.device.id",this.deviceLocale="ai.device.locale",this.deviceModel="ai.device.model",this.deviceOEMName="ai.device.oemName",this.deviceOSVersion="ai.device.osVersion",this.deviceType="ai.device.type",this.locationIp="ai.location.ip",this.operationId="ai.operation.id",this.operationName="ai.operation.name",this.operationParentId="ai.operation.parentId",this.operationSyntheticSource="ai.operation.syntheticSource",this.operationCorrelationVector="ai.operation.correlationVector",this.sessionId="ai.session.id",this.sessionIsFirst="ai.session.isFirst",this.userAccountId="ai.user.accountId",this.userId="ai.user.id",this.userAuthUserId="ai.user.authUserId",this.cloudRole="ai.cloud.role",this.cloudRoleInstance="ai.cloud.roleInstance",this.internalSdkVersion="ai.internal.sdkVersion",this.internalAgentVersion="ai.internal.agentVersion",this.internalNodeName="ai.internal.nodeName"}return e}();nl.exports=sm});var al=h((oa,sl)=>{"use strict";var am=oa&&oa.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),om=aa(),um=function(e){am(t,e);function t(){return e.call(this)||this}return t}(om);sl.exports=um});var ca=h((aT,ol)=>{"use strict";var ua;(function(e){e[e.Measurement=0]="Measurement",e[e.Aggregation=1]="Aggregation"})(ua||(ua={}));ol.exports=ua});var cl=h((oT,ul)=>{"use strict";var cm=ca(),lm=function(){function e(){this.kind=cm.Measurement}return e}();ul.exports=lm});var pl=h((uT,ll)=>{"use strict";var pm=function(){function e(){this.ver=1,this.sampleRate=100,this.tags={}}return e}();ll.exports=pm});var pa=h((la,fl)=>{"use strict";var fm=la&&la.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),dm=lt(),hm=function(e){fm(t,e);function t(){var r=e.call(this)||this;return r.ver=2,r.properties={},r.measurements={},r}return t}(dm);fl.exports=hm});var hl=h((fa,dl)=>{"use strict";var vm=fa&&fa.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),gm=lt(),mm=function(e){vm(t,e);function t(){var r=e.call(this)||this;return r.ver=2,r.exceptions=[],r.properties={},r.measurements={},r}return t}(gm);dl.exports=mm});var gl=h((cT,vl)=>{"use strict";var ym=function(){function e(){this.hasFullStack=!0,this.parsedStack=[]}return e}();vl.exports=ym});var yl=h((da,ml)=>{"use strict";var _m=da&&da.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Cm=lt(),Em=function(e){_m(t,e);function t(){var r=e.call(this)||this;return r.ver=2,r.properties={},r}return t}(Cm);ml.exports=Em});var Cl=h((ha,_l)=>{"use strict";var bm=ha&&ha.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Tm=lt(),wm=function(e){bm(t,e);function t(){var r=e.call(this)||this;return r.ver=2,r.metrics=[],r.properties={},r}return t}(Tm);_l.exports=wm});var bl=h((va,El)=>{"use strict";var Im=va&&va.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),xm=pa(),Sm=function(e){Im(t,e);function t(){var r=e.call(this)||this;return r.ver=2,r.properties={},r.measurements={},r}return t}(xm);El.exports=Sm});var wl=h((ga,Tl)=>{"use strict";var km=ga&&ga.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Pm=lt(),Am=function(e){km(t,e);function t(){var r=e.call(this)||this;return r.ver=2,r.success=!0,r.properties={},r.measurements={},r}return t}(Pm);Tl.exports=Am});var xl=h((ma,Il)=>{"use strict";var Dm=ma&&ma.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Rm=lt(),Om=function(e){Dm(t,e);function t(){var r=e.call(this)||this;return r.ver=2,r.properties={},r.measurements={},r}return t}(Rm);Il.exports=Om});var _a=h((lT,Sl)=>{"use strict";var ya;(function(e){e[e.Verbose=0]="Verbose",e[e.Information=1]="Information",e[e.Warning=2]="Warning",e[e.Error=3]="Error",e[e.Critical=4]="Critical"})(ya||(ya={}));Sl.exports=ya});var Pl=h((pT,kl)=>{"use strict";var qm=function(){function e(){}return e}();kl.exports=qm});var Ca=h(se=>{"use strict";Object.defineProperty(se,"__esModule",{value:!0});se.AvailabilityData=tl();se.Base=aa();se.ContextTagKeys=il();se.Data=al();se.DataPoint=cl();se.DataPointType=ca();se.Domain=lt();se.Envelope=pl();se.EventData=pa();se.ExceptionData=hl();se.ExceptionDetails=gl();se.MessageData=yl();se.MetricData=Cl();se.PageViewData=bl();se.RemoteDependencyData=wl();se.RequestData=xl();se.SeverityLevel=_a();se.StackFrame=Pl()});var Al=h(wi=>{"use strict";Object.defineProperty(wi,"__esModule",{value:!0});var Gt=Ca(),Nm=function(){function e(){}return e.TYPE_HTTP="Http",e.TYPE_AI="Http (tracked component)",e}();wi.RemoteDependencyDataConstants=Nm;function Lm(e){return"properties"in e||e instanceof Gt.EventData||e instanceof Gt.ExceptionData||e instanceof Gt.MessageData||e instanceof Gt.MetricData||e instanceof Gt.PageViewData||e instanceof Gt.RemoteDependencyData||e instanceof Gt.RequestData}wi.domainSupportsProperties=Lm});var Dl=h(zt=>{"use strict";Object.defineProperty(zt,"__esModule",{value:!0});function Mm(e){switch(e){case ge.Event:return"EventData";case ge.Exception:return"ExceptionData";case ge.Trace:return"MessageData";case ge.Metric:return"MetricData";case ge.Request:return"RequestData";case ge.Dependency:return"RemoteDependencyData";case ge.Availability:return"AvailabilityData";case ge.PageView:return"PageViewData"}}zt.telemetryTypeToBaseType=Mm;function Fm(e){switch(e){case"EventData":return ge.Event;case"ExceptionData":return ge.Exception;case"MessageData":return ge.Trace;case"MetricData":return ge.Metric;case"RequestData":return ge.Request;case"RemoteDependencyData":return ge.Dependency;case"AvailabilityData":return ge.Availability;case"PageViewData":return ge.PageView}}zt.baseTypeToTelemetryType=Fm;zt.TelemetryTypeString={Event:"EventData",Exception:"ExceptionData",Trace:"MessageData",Metric:"MetricData",Request:"RequestData",Dependency:"RemoteDependencyData",Availability:"AvailabilityData",PageView:"PageViewData"};var ge;(function(e){e[e.Event=0]="Event",e[e.Exception=1]="Exception",e[e.Trace=2]="Trace",e[e.Metric=3]="Metric",e[e.Request=4]="Request",e[e.Dependency=5]="Dependency",e[e.Availability=6]="Availability",e[e.PageView=7]="PageView"})(ge=zt.TelemetryType||(zt.TelemetryType={}))});var Rl=h(Ii=>{"use strict";function Hm(e){for(var t in e)Ii.hasOwnProperty(t)||(Ii[t]=e[t])}Object.defineProperty(Ii,"__esModule",{value:!0});Hm(Dl())});var Oe=h(xi=>{"use strict";function Ea(e){for(var t in e)xi.hasOwnProperty(t)||(xi[t]=e[t])}Object.defineProperty(xi,"__esModule",{value:!0});Ea(Al());Ea(Ca());Ea(Rl())});var ba=h((mT,Ol)=>{"use strict";var jm=function(){function e(){}return e.prototype.getUrl=function(){return this.url},e.prototype.RequestParser=function(){this.startTime=+new Date},e.prototype._setStatus=function(t,r){var n=+new Date;this.duration=n-this.startTime,this.statusCode=t;var i=this.properties||{};if(r){if(typeof r=="string")i.error=r;else if(r instanceof Error)i.error=r.message;else if(typeof r=="object")for(var s in r)i[s]=r[s]&&r[s].toString&&r[s].toString()}this.properties=i},e.prototype._isSuccess=function(){return 0<this.statusCode&&this.statusCode<400},e}();Ol.exports=jm});var Ia=h((wa,Nl)=>{"use strict";var Um=wa&&wa.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Si=require("url"),$m=Oe(),ql=Re(),Qt=_r(),Vm=ba(),bt=Bt(),Bm=ia(),Ta=ln(),Gm=function(e){Um(t,e);function t(r,n){var i=e.call(this)||this;return r&&(i.method=r.method,i.url=i._getAbsoluteUrl(r),i.startTime=+new Date,i.socketRemoteAddress=r.socket&&r.socket.remoteAddress,i.parseHeaders(r,n),r.connection&&(i.connectionRemoteAddress=r.connection.remoteAddress,i.legacySocketRemoteAddress=r.connection.socket&&r.connection.socket.remoteAddress)),i}return t.prototype.onError=function(r,n){this._setStatus(void 0,r),n&&(this.duration=n)},t.prototype.onResponse=function(r,n){this._setStatus(r.statusCode,void 0),n&&(this.duration=n)},t.prototype.getRequestTelemetry=function(r){var n={id:this.requestId,name:this.method+" "+Si.parse(this.url).pathname,url:this.url,source:this.sourceCorrelationId,duration:this.duration,resultCode:this.statusCode?this.statusCode.toString():null,success:this._isSuccess(),properties:this.properties};if(r&&r.time?n.time=r.time:this.startTime&&(n.time=new Date(this.startTime)),r){for(var i in r)n[i]||(n[i]=r[i]);if(r.properties)for(var i in r.properties)n.properties[i]=r.properties[i]}return n},t.prototype.getRequestTags=function(r){var n={};for(var i in r)n[i]=r[i];return n[t.keys.locationIp]=r[t.keys.locationIp]||this._getIp(),n[t.keys.sessionId]=r[t.keys.sessionId]||this._getId("ai_session"),n[t.keys.userId]=r[t.keys.userId]||this._getId("ai_user"),n[t.keys.userAuthUserId]=r[t.keys.userAuthUserId]||this._getId("ai_authUser"),n[t.keys.operationName]=this.getOperationName(r),n[t.keys.operationParentId]=this.getOperationParentId(r),n[t.keys.operationId]=this.getOperationId(r),n},t.prototype.getOperationId=function(r){return r[t.keys.operationId]||this.operationId},t.prototype.getOperationParentId=function(r){return r[t.keys.operationParentId]||this.parentId||this.getOperationId(r)},t.prototype.getOperationName=function(r){return r[t.keys.operationName]||this.method+" "+Si.parse(this.url).pathname},t.prototype.getRequestId=function(){return this.requestId},t.prototype.getCorrelationContextHeader=function(){return this.correlationContextHeader},t.prototype.getTraceparent=function(){return this.traceparent},t.prototype.getTracestate=function(){return this.tracestate},t.prototype.getLegacyRootId=function(){return this.legacyRootId},t.prototype._getAbsoluteUrl=function(r){if(!r.headers)return r.url;var n=r.connection?r.connection.encrypted:null,i=Si.parse(r.url),s=i.pathname,a=i.search,o=Si.format({protocol:n?"https":"http",host:r.headers.host,pathname:s,search:a});return o},t.prototype._getIp=function(){var r=/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/,n=function(s){var a=r.exec(s);if(a)return a[0]},i=n(this.rawHeaders["x-forwarded-for"])||n(this.rawHeaders["x-client-ip"])||n(this.rawHeaders["x-real-ip"])||n(this.connectionRemoteAddress)||n(this.socketRemoteAddress)||n(this.legacySocketRemoteAddress);return!i&&this.connectionRemoteAddress&&this.connectionRemoteAddress.substr&&this.connectionRemoteAddress.substr(0,2)==="::"&&(i="127.0.0.1"),i},t.prototype._getId=function(r){var n=this.rawHeaders&&this.rawHeaders.cookie&&typeof this.rawHeaders.cookie=="string"&&this.rawHeaders.cookie||"",i=t.parseId(ql.getCookie(r,n));return i},t.prototype.setBackCompatFromThisTraceContext=function(){this.operationId=this.traceparent.traceId,this.traceparent.legacyRootId&&(this.legacyRootId=this.traceparent.legacyRootId),this.parentId=this.traceparent.parentId,this.traceparent.updateSpanId(),this.requestId=this.traceparent.getBackCompatRequestId()},t.prototype.parseHeaders=function(r,n){if(this.rawHeaders=r.headers||r.rawHeaders,this.userAgent=r.headers&&r.headers["user-agent"],this.sourceCorrelationId=ql.getCorrelationContextTarget(r,Qt.requestContextSourceKey),r.headers){var i=r.headers[Qt.traceStateHeader],s=r.headers[Qt.traceparentHeader],a=r.headers[Qt.requestIdHeader],o=r.headers[Qt.parentIdHeader],u=r.headers[Qt.rootIdHeader];this.correlationContextHeader=r.headers[Qt.correlationContextHeader],bt.w3cEnabled&&(s||i)?(this.traceparent=new Ta(s),this.tracestate=s&&i&&new Bm(i),this.setBackCompatFromThisTraceContext()):a?bt.w3cEnabled?(this.traceparent=new Ta(null,a),this.setBackCompatFromThisTraceContext()):(this.parentId=a,this.requestId=bt.generateRequestId(this.parentId),this.operationId=bt.getRootId(this.requestId)):bt.w3cEnabled?(this.traceparent=new Ta,this.traceparent.parentId=o,this.traceparent.legacyRootId=u||o,this.setBackCompatFromThisTraceContext()):(this.parentId=o,this.requestId=bt.generateRequestId(u||this.parentId),this.correlationContextHeader=null,this.operationId=bt.getRootId(this.requestId)),n&&(this.requestId=n,this.operationId=bt.getRootId(this.requestId))}},t.parseId=function(r){var n=r.split("|");return n.length>0?n[0]:""},t.keys=new $m.ContextTagKeys,t}(Vm);Nl.exports=Gm});var ki=h((yT,Fl)=>{"use strict";function xa(e){return typeof e=="function"}var we=console.error.bind(console);function pn(e,t,r){var n=!!e[t]&&e.propertyIsEnumerable(t);Object.defineProperty(e,t,{configurable:!0,enumerable:n,writable:!0,value:r})}function fn(e){e&&e.logger&&(xa(e.logger)?we=e.logger:we("new logger isn't a function, not replacing"))}function Ll(e,t,r){if(!e||!e[t]){we("no original function "+t+" to wrap");return}if(!r){we("no wrapper function"),we(new Error().stack);return}if(!xa(e[t])||!xa(r)){we("original object and wrapper must be functions");return}var n=e[t],i=r(n,t);return pn(i,"__original",n),pn(i,"__unwrap",function(){e[t]===i&&pn(e,t,n)}),pn(i,"__wrapped",!0),pn(e,t,i),i}function zm(e,t,r){if(e)Array.isArray(e)||(e=[e]);else{we("must provide one or more modules to patch"),we(new Error().stack);return}if(!(t&&Array.isArray(t))){we("must provide one or more functions to wrap on modules");return}e.forEach(function(n){t.forEach(function(i){Ll(n,i,r)})})}function Ml(e,t){if(!e||!e[t]){we("no function to unwrap."),we(new Error().stack);return}if(!e[t].__unwrap)we("no original to unwrap to -- has "+t+" already been unwrapped?");else return e[t].__unwrap()}function Qm(e,t){if(e)Array.isArray(e)||(e=[e]);else{we("must provide one or more modules to patch"),we(new Error().stack);return}if(!(t&&Array.isArray(t))){we("must provide one or more functions to unwrap on modules");return}e.forEach(function(r){t.forEach(function(n){Ml(r,n)})})}fn.wrap=Ll;fn.massWrap=zm;fn.unwrap=Ml;fn.massUnwrap=Qm;Fl.exports=fn});var Di=h((_T,$l)=>{"use strict";var jl=ki(),Er=jl.wrap,Pi=jl.unwrap,pt="wrap@before";function Ai(e,t,r){var n=!!e[t]&&e.propertyIsEnumerable(t);Object.defineProperty(e,t,{configurable:!0,enumerable:n,writable:!0,value:r})}function Wm(e,t){for(var r=t.length,n=0;n<r;n++){var i=t[n],s=e[pt];if(typeof s=="function")s(i);else if(Array.isArray(s))for(var a=s.length,o=0;o<a;o++)s[o](i)}}function Ul(e,t){var r;return r=e._events&&e._events[t],Array.isArray(r)||(r?r=[r]:r=[]),r}function Xm(e,t,r){var n=Ul(e,t),i=n.filter(function(s){return r.indexOf(s)===-1});i.length>0&&Wm(e,i)}function Hl(e,t){if(!!e){var r=e;if(typeof e=="function")r=t(e);else if(Array.isArray(e)){r=[];for(var n=0;n<e.length;n++)r[n]=t(e[n])}return r}}$l.exports=function(t,r,n){if(!t||!t.on||!t.addListener||!t.removeListener||!t.emit)throw new Error("can only wrap real EEs");if(!r)throw new Error("must have function to run on listener addition");if(!n)throw new Error("must have function to wrap listeners when emitting");function i(a){return function(u,c){var l=Ul(this,u).slice();try{var p=a.call(this,u,c);return Xm(this,u,l),p}finally{this.on.__wrapped||Er(this,"on",i),this.addListener.__wrapped||Er(this,"addListener",i)}}}function s(a){return function(u){if(!this._events||!this._events[u])return a.apply(this,arguments);var c=this._events[u];function l(p){return function(){this._events[u]=c;try{return p.apply(this,arguments)}finally{c=this._events[u],this._events[u]=Hl(c,n)}}}Er(this,"removeListener",l);try{return this._events[u]=Hl(c,n),a.apply(this,arguments)}finally{Pi(this,"removeListener"),this._events[u]=c}}}t[pt]?typeof t[pt]=="function"?Ai(t,pt,[t[pt],r]):Array.isArray(t[pt])&&t[pt].push(r):Ai(t,pt,r),t.__wrapped||(Er(t,"addListener",i),Er(t,"on",i),Er(t,"emit",s),Ai(t,"__unwrap",function(){Pi(t,"addListener"),Pi(t,"on"),Pi(t,"emit"),delete t[pt],delete t.__wrapped}),Ai(t,"__wrapped",!0))}});var zl=h((CT,Gl)=>{"use strict";var H=require("util"),ft=require("assert"),Km=Di(),W=require("async_hooks"),dn="cls@contexts",hn="error@context",J=process.env.DEBUG_CLS_HOOKED,F=-1;Gl.exports={getNamespace:Vl,createNamespace:Jm,destroyNamespace:Bl,reset:Ym,ERROR_SYMBOL:hn};function Me(e){this.name=e,this.active=null,this._set=[],this.id=null,this._contexts=new Map,this._indent=0}Me.prototype.set=function(t,r){if(!this.active)throw new Error("No context available. ns.run() or ns.bind() must be called first.");if(this.active[t]=r,J){let n=" ".repeat(this._indent<0?0:this._indent);X(n+"CONTEXT-SET KEY:"+t+"="+r+" in ns:"+this.name+" currentUid:"+F+" active:"+H.inspect(this.active,{showHidden:!0,depth:2,colors:!0}))}return r};Me.prototype.get=function(t){if(!this.active){if(J){let r=W.currentId(),n=W.triggerAsyncId(),i=" ".repeat(this._indent<0?0:this._indent);X(`${i}CONTEXT-GETTING KEY NO ACTIVE NS: (${this.name}) ${t}=undefined currentUid:${F} asyncHooksCurrentId:${r} triggerId:${n} len:${this._set.length}`)}return}if(J){let r=W.executionAsyncId(),n=W.triggerAsyncId(),i=" ".repeat(this._indent<0?0:this._indent);X(i+"CONTEXT-GETTING KEY:"+t+"="+this.active[t]+" ("+this.name+") currentUid:"+F+" active:"+H.inspect(this.active,{showHidden:!0,depth:2,colors:!0})),X(`${i}CONTEXT-GETTING KEY: (${this.name}) ${t}=${this.active[t]} currentUid:${F} asyncHooksCurrentId:${r} triggerId:${n} len:${this._set.length} active:${H.inspect(this.active)}`)}return this.active[t]};Me.prototype.createContext=function(){let t=Object.create(this.active?this.active:Object.prototype);if(t._ns_name=this.name,t.id=F,J){let r=W.executionAsyncId(),n=W.triggerAsyncId(),i=" ".repeat(this._indent<0?0:this._indent);X(`${i}CONTEXT-CREATED Context: (${this.name}) currentUid:${F} asyncHooksCurrentId:${r} triggerId:${n} len:${this._set.length} context:${H.inspect(t,{showHidden:!0,depth:2,colors:!0})}`)}return t};Me.prototype.run=function(t){let r=this.createContext();this.enter(r);try{if(J){let n=W.triggerAsyncId(),i=W.executionAsyncId(),s=" ".repeat(this._indent<0?0:this._indent);X(`${s}CONTEXT-RUN BEGIN: (${this.name}) currentUid:${F} triggerId:${n} asyncHooksCurrentId:${i} len:${this._set.length} context:${H.inspect(r)}`)}return t(r),r}catch(n){throw n&&(n[hn]=r),n}finally{if(J){let n=W.triggerAsyncId(),i=W.executionAsyncId(),s=" ".repeat(this._indent<0?0:this._indent);X(`${s}CONTEXT-RUN END: (${this.name}) currentUid:${F} triggerId:${n} asyncHooksCurrentId:${i} len:${this._set.length} ${H.inspect(r)}`)}this.exit(r)}};Me.prototype.runAndReturn=function(t){let r;return this.run(function(n){r=t(n)}),r};Me.prototype.runPromise=function(t){let r=this.createContext();this.enter(r);let n=t(r);if(!n||!n.then||!n.catch)throw new Error("fn must return a promise.");return J&&X("CONTEXT-runPromise BEFORE: ("+this.name+") currentUid:"+F+" len:"+this._set.length+" "+H.inspect(r)),n.then(i=>(J&&X("CONTEXT-runPromise AFTER then: ("+this.name+") currentUid:"+F+" len:"+this._set.length+" "+H.inspect(r)),this.exit(r),i)).catch(i=>{throw i[hn]=r,J&&X("CONTEXT-runPromise AFTER catch: ("+this.name+") currentUid:"+F+" len:"+this._set.length+" "+H.inspect(r)),this.exit(r),i})};Me.prototype.bind=function(t,r){r||(this.active?r=this.active:r=this.createContext());let n=this;return function(){n.enter(r);try{return t.apply(this,arguments)}catch(s){throw s&&(s[hn]=r),s}finally{n.exit(r)}}};Me.prototype.enter=function(t){if(ft.ok(t,"context must be provided for entering"),J){let r=W.executionAsyncId(),n=W.triggerAsyncId(),i=" ".repeat(this._indent<0?0:this._indent);X(`${i}CONTEXT-ENTER: (${this.name}) currentUid:${F} triggerId:${n} asyncHooksCurrentId:${r} len:${this._set.length} ${H.inspect(t)}`)}this._set.push(this.active),this.active=t};Me.prototype.exit=function(t){if(ft.ok(t,"context must be provided for exiting"),J){let n=W.executionAsyncId(),i=W.triggerAsyncId(),s=" ".repeat(this._indent<0?0:this._indent);X(`${s}CONTEXT-EXIT: (${this.name}) currentUid:${F} triggerId:${i} asyncHooksCurrentId:${n} len:${this._set.length} ${H.inspect(t)}`)}if(this.active===t){ft.ok(this._set.length,"can't remove top context"),this.active=this._set.pop();return}let r=this._set.lastIndexOf(t);r<0?(J&&X("??ERROR?? context exiting but not entered - ignoring: "+H.inspect(t)),ft.ok(r>=0,`context not currently entered; can't exit. 
`+H.inspect(this)+`
`+H.inspect(t))):(ft.ok(r,"can't remove top context"),this._set.splice(r,1))};Me.prototype.bindEmitter=function(t){ft.ok(t.on&&t.addListener&&t.emit,"can only bind real EEs");let r=this,n="context@"+this.name;function i(a){!a||(a[dn]||(a[dn]=Object.create(null)),a[dn][n]={namespace:r,context:r.active})}function s(a){if(!(a&&a[dn]))return a;let o=a,u=a[dn];return Object.keys(u).forEach(function(c){let l=u[c];o=l.namespace.bind(o,l.context)}),o}Km(t,i,s)};Me.prototype.fromException=function(t){return t[hn]};function Vl(e){return process.namespaces[e]}function Jm(e){ft.ok(e,"namespace must be given a name."),J&&X(`NS-CREATING NAMESPACE (${e})`);let t=new Me(e);return t.id=F,W.createHook({init(n,i,s,a){if(F=W.executionAsyncId(),t.active){if(t._contexts.set(n,t.active),J){let o=" ".repeat(t._indent<0?0:t._indent);X(`${o}INIT [${i}] (${e}) asyncId:${n} currentUid:${F} triggerId:${s} active:${H.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} resource:${a}`)}}else if(F===0){let o=W.triggerAsyncId(),u=t._contexts.get(o);if(u){if(t._contexts.set(n,u),J){let c=" ".repeat(t._indent<0?0:t._indent);X(`${c}INIT USING CONTEXT FROM TRIGGERID [${i}] (${e}) asyncId:${n} currentUid:${F} triggerId:${o} active:${H.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} resource:${a}`)}}else if(J){let c=" ".repeat(t._indent<0?0:t._indent);X(`${c}INIT MISSING CONTEXT [${i}] (${e}) asyncId:${n} currentUid:${F} triggerId:${o} active:${H.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} resource:${a}`)}}if(J&&i==="PROMISE"){X(H.inspect(a,{showHidden:!0}));let o=a.parentId,u=" ".repeat(t._indent<0?0:t._indent);X(`${u}INIT RESOURCE-PROMISE [${i}] (${e}) parentId:${o} asyncId:${n} currentUid:${F} triggerId:${s} active:${H.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} resource:${a}`)}},before(n){F=W.executionAsyncId();let i;if(i=t._contexts.get(n)||t._contexts.get(F),i){if(J){let s=W.triggerAsyncId(),a=" ".repeat(t._indent<0?0:t._indent);X(`${a}BEFORE (${e}) asyncId:${n} currentUid:${F} triggerId:${s} active:${H.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} context:${H.inspect(i)}`),t._indent+=2}t.enter(i)}else if(J){let s=W.triggerAsyncId(),a=" ".repeat(t._indent<0?0:t._indent);X(`${a}BEFORE MISSING CONTEXT (${e}) asyncId:${n} currentUid:${F} triggerId:${s} active:${H.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} namespace._contexts:${H.inspect(t._contexts,{showHidden:!0,depth:2,colors:!0})}`),t._indent+=2}},after(n){F=W.executionAsyncId();let i;if(i=t._contexts.get(n)||t._contexts.get(F),i){if(J){let s=W.triggerAsyncId();t._indent-=2;let a=" ".repeat(t._indent<0?0:t._indent);X(`${a}AFTER (${e}) asyncId:${n} currentUid:${F} triggerId:${s} active:${H.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} context:${H.inspect(i)}`)}t.exit(i)}else if(J){let s=W.triggerAsyncId();t._indent-=2;let a=" ".repeat(t._indent<0?0:t._indent);X(`${a}AFTER MISSING CONTEXT (${e}) asyncId:${n} currentUid:${F} triggerId:${s} active:${H.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} context:${H.inspect(i)}`)}},destroy(n){if(F=W.executionAsyncId(),J){let i=W.triggerAsyncId(),s=" ".repeat(t._indent<0?0:t._indent);X(`${s}DESTROY (${e}) currentUid:${F} asyncId:${n} triggerId:${i} active:${H.inspect(t.active,{showHidden:!0,depth:2,colors:!0})} context:${H.inspect(t._contexts.get(F))}`)}t._contexts.delete(n)}}).enable(),process.namespaces[e]=t,t}function Bl(e){let t=Vl(e);ft.ok(t,`can't delete nonexistent namespace! "`+e+'"'),ft.ok(t.id,"don't assign to process.namespaces directly! "+H.inspect(t)),process.namespaces[e]=null}function Ym(){process.namespaces&&Object.keys(process.namespaces).forEach(function(e){Bl(e)}),process.namespaces=Object.create(null)}process.namespaces={};function X(...e){J&&process._rawDebug(`${H.format(...e)}`)}});var Wl=h((ET,Ql)=>{"use strict";function Zm(){}Ql.exports=function(){let t=this._hooks,r=this._state,n=process.nextTick;process.nextTick=function(){if(!r.enabled)return n.apply(process,arguments);let i=new Array(arguments.length);for(let u=0;u<arguments.length;u++)i[u]=arguments[u];let s=i[0];if(typeof s!="function")throw new TypeError("callback is not a function");let a=new Zm,o=--r.counter;return t.init.call(a,o,0,null,null),i[0]=function(){t.pre.call(a,o);let u=!0;try{s.apply(this,arguments),u=!1}finally{u&&process.listenerCount("uncaughtException")>0&&process.once("uncaughtException",function(){t.post.call(a,o,!0),t.destroy.call(null,o)})}t.post.call(a,o,!1),t.destroy.call(null,o)},n.apply(process,i)}}});var Kl=h((bT,Xl)=>{"use strict";function ey(){}Xl.exports=function(){let t=this._hooks,r=this._state,n=global.Promise,i=n.prototype.then;n.prototype.then=u;function s(c,l,p,f){return typeof c!="function"?f?a(p):o(p):function(){t.pre.call(l,p);try{return c.apply(this,arguments)}finally{t.post.call(l,p,!1),t.destroy.call(null,p)}}}function a(c){return function(p){return t.destroy.call(null,c),p}}function o(c){return function(p){throw t.destroy.call(null,c),p}}function u(c,l){if(!r.enabled)return i.call(this,c,l);let p=new ey,f=--r.counter;return t.init.call(p,f,0,null,null),i.call(this,s(c,p,f,!0),s(l,p,f,!1))}}});var Yl=h((TT,Jl)=>{"use strict";var qe=require("timers");function ty(){}function ry(){}function ny(){}var iy=new Map,sy=new Map,ay=new Map,Sa=null,ka=!1;Jl.exports=function(){Pa(this._hooks,this._state,"setTimeout","clearTimeout",ty,iy,!0),Pa(this._hooks,this._state,"setInterval","clearInterval",ry,sy,!1),Pa(this._hooks,this._state,"setImmediate","clearImmediate",ny,ay,!0),global.setTimeout=qe.setTimeout,global.setInterval=qe.setInterval,global.setImmediate=qe.setImmediate,global.clearTimeout=qe.clearTimeout,global.clearInterval=qe.clearInterval,global.clearImmediate=qe.clearImmediate};function Pa(e,t,r,n,i,s,a){let o=qe[r],u=qe[n];qe[r]=function(){if(!t.enabled)return o.apply(qe,arguments);let c=new Array(arguments.length);for(let g=0;g<arguments.length;g++)c[g]=arguments[g];let l=c[0];if(typeof l!="function")throw new TypeError('"callback" argument must be a function');let p=new i,f=--t.counter,d;return e.init.call(p,f,0,null,null),c[0]=function(){Sa=d,e.pre.call(p,f);let g=!0;try{l.apply(this,arguments),g=!1}finally{g&&process.listenerCount("uncaughtException")>0&&process.once("uncaughtException",function(){e.post.call(p,f,!0),s.delete(d),e.destroy.call(null,f)})}e.post.call(p,f,!1),Sa=null,(a||ka)&&(ka=!1,s.delete(d),e.destroy.call(null,f))},d=o.apply(qe,c),s.set(d,f),d},qe[n]=function(c){if(Sa===c&&c!==null)ka=!0;else if(s.has(c)){let l=s.get(c);s.delete(c),e.destroy.call(null,l)}u.apply(qe,arguments)}}});var Aa=h((wT,oy)=>{oy.exports={name:"async-hook-jl",description:"Inspect the life of handle objects in node",version:"1.7.6",author:"Andreas Madsen <amwebdk@gmail.com>",main:"./index.js",scripts:{test:"node ./test/runner.js && eslint ."},repository:{type:"git",url:"git://github.com/jeff-lewis/async-hook-jl.git"},keywords:["async","async hooks","inspect","async wrap"],license:"MIT",dependencies:{"stack-chain":"^1.3.7"},devDependencies:{async:"1.5.x","cli-color":"1.1.x",eslint:"^3.4.0",endpoint:"0.4.x"},engines:{node:"^4.7 || >=6.9 || >=7.3"}}});var tp=h((IT,ep)=>{"use strict";var gn=process.binding("async_wrap"),uy=gn.Providers.TIMERWRAP,Zl={nextTick:Wl(),promise:Kl(),timers:Yl()},vn=new Set;function cy(){this.enabled=!1,this.counter=0}function Da(){let e=this.initFns=[],t=this.preFns=[],r=this.postFns=[],n=this.destroyFns=[];this.init=function(i,s,a,o){if(s===uy){vn.add(i);return}for(let u of e)u(i,this,s,a,o)},this.pre=function(i){if(!vn.has(i))for(let s of t)s(i,this)},this.post=function(i,s){if(!vn.has(i))for(let a of r)a(i,this,s)},this.destroy=function(i){if(vn.has(i)){vn.delete(i);return}for(let s of n)s(i)}}Da.prototype.add=function(e){e.init&&this.initFns.push(e.init),e.pre&&this.preFns.push(e.pre),e.post&&this.postFns.push(e.post),e.destroy&&this.destroyFns.push(e.destroy)};function Ri(e,t){let r=e.indexOf(t);r!==-1&&e.splice(r,1)}Da.prototype.remove=function(e){e.init&&Ri(this.initFns,e.init),e.pre&&Ri(this.preFns,e.pre),e.post&&Ri(this.postFns,e.post),e.destroy&&Ri(this.destroyFns,e.destroy)};function mn(){this._state=new cy,this._hooks=new Da,this.version=Aa().version,this.providers=gn.Providers;for(let e of Object.keys(Zl))Zl[e].call(this);process.env.hasOwnProperty("NODE_ASYNC_HOOK_WARNING")&&console.warn("warning: you are using async-hook-jl which is unstable."),gn.setupHooks({init:this._hooks.init,pre:this._hooks.pre,post:this._hooks.post,destroy:this._hooks.destroy})}ep.exports=mn;mn.prototype.addHooks=function(e){this._hooks.add(e)};mn.prototype.removeHooks=function(e){this._hooks.remove(e)};mn.prototype.enable=function(){this._state.enabled=!0,gn.enable()};mn.prototype.disable=function(){this._state.enabled=!1,gn.disable()}});var Ra=h((xT,ly)=>{ly.exports={name:"stack-chain",description:"API for combining call site modifiers",version:"1.3.7",author:"Andreas Madsen <amwebdk@gmail.com>",scripts:{test:"tap ./test/simple"},repository:{type:"git",url:"git://github.com/AndreasMadsen/stack-chain.git"},keywords:["stack","chain","trace","call site","concat","format"],devDependencies:{tap:"2.x.x","uglify-js":"2.5.x"},license:"MIT"}});var np=h((ST,rp)=>{function py(e){try{return Error.prototype.toString.call(e)}catch(t){try{return"<error: "+t+">"}catch{return"<error>"}}}rp.exports=function(t,r){var n=[];n.push(py(t));for(var i=0;i<r.length;i++){var s=r[i],a;try{a=s.toString()}catch(o){try{a="<error: "+o+">"}catch{a="<error>"}}n.push("    at "+a)}return n.join(`
`)}});var op=h((kT,ap)=>{var Oi=np();function sp(){this.extend=new yn,this.filter=new yn,this.format=new _n,this.version=Ra().version}var qa=!1;sp.prototype.callSite=function e(t){t||(t={}),qa=!0;var r={};Error.captureStackTrace(r,e);var n=r.stack;return qa=!1,n=n.slice(t.slice||0),t.extend&&(n=this.extend._modify(r,n)),t.filter&&(n=this.filter._modify(r,n)),n};var Tt=new sp;function yn(){this._modifiers=[]}yn.prototype._modify=function(e,t){for(var r=0,n=this._modifiers.length;r<n;r++)t=this._modifiers[r](e,t);return t};yn.prototype.attach=function(e){this._modifiers.push(e)};yn.prototype.deattach=function(e){var t=this._modifiers.indexOf(e);return t===-1?!1:(this._modifiers.splice(t,1),!0)};function _n(){this._formater=Oi,this._previous=void 0}_n.prototype.replace=function(e){e?this._formater=e:this.restore()};_n.prototype.restore=function(){this._formater=Oi,this._previous=void 0};_n.prototype._backup=function(){this._previous=this._formater};_n.prototype._roolback=function(){this._previous===Oi?this.replace(void 0):this.replace(this._previous),this._previous=void 0};Error.prepareStackTrace&&Tt.format.replace(Error.prepareStackTrace);var Oa=!1;function ip(e,t){if(qa)return t;if(Oa)return Oi(e,t);var r=t.concat();r=Tt.extend._modify(e,r),r=Tt.filter._modify(e,r),r=r.slice(0,Error.stackTraceLimit),Object.isExtensible(e)&&Object.getOwnPropertyDescriptor(e,"callSite")===void 0&&(e.callSite={original:t,mutated:r}),Oa=!0;var n=Tt.format._formater(e,r);return Oa=!1,n}Object.defineProperty(Error,"prepareStackTrace",{get:function(){return ip},set:function(e){e===ip?Tt.format._roolback():(Tt.format._backup(),Tt.format.replace(e))}});function fy(){return this.stack,this.callSite}Object.defineProperty(Error.prototype,"callSite",{get:fy,set:function(e){Object.defineProperty(this,"callSite",{value:e,writable:!0,configurable:!0})},configurable:!0});ap.exports=Tt});var La=h((PT,Na)=>{if(global._stackChain)if(global._stackChain.version===Ra().version)Na.exports=global._stackChain;else throw new Error("Conflicting version of stack-chain found");else Na.exports=global._stackChain=op()});var up=h((AT,Ma)=>{"use strict";var dy=tp();if(global._asyncHook)if(global._asyncHook.version===Aa().version)Ma.exports=global._asyncHook;else throw new Error("Conflicting version of async-hook-jl found");else La().filter.attach(function(t,r){return r.filter(function(n){let i=n.getFileName();return!(i&&i.slice(0,__dirname.length)===__dirname)})}),Ma.exports=global._asyncHook=new dy});var hp=h((DT,dp)=>{"use strict";var re=require("util"),dt=require("assert"),hy=Di(),br=up(),Cn="cls@contexts",En="error@context",lp=[];for(let e in br.providers)lp[br.providers[e]]=e;var Z=process.env.DEBUG_CLS_HOOKED,ae=-1;dp.exports={getNamespace:pp,createNamespace:vy,destroyNamespace:fp,reset:gy,ERROR_SYMBOL:En};function Fe(e){this.name=e,this.active=null,this._set=[],this.id=null,this._contexts=new Map}Fe.prototype.set=function(t,r){if(!this.active)throw new Error("No context available. ns.run() or ns.bind() must be called first.");return Z&&te("    SETTING KEY:"+t+"="+r+" in ns:"+this.name+" uid:"+ae+" active:"+re.inspect(this.active,!0)),this.active[t]=r,r};Fe.prototype.get=function(t){if(!this.active){Z&&te("    GETTING KEY:"+t+"=undefined "+this.name+" uid:"+ae+" active:"+re.inspect(this.active,!0));return}return Z&&te("    GETTING KEY:"+t+"="+this.active[t]+" "+this.name+" uid:"+ae+" active:"+re.inspect(this.active,!0)),this.active[t]};Fe.prototype.createContext=function(){Z&&te("   CREATING Context: "+this.name+" uid:"+ae+" len:"+this._set.length+"  active:"+re.inspect(this.active,!0,2,!0));let t=Object.create(this.active?this.active:Object.prototype);return t._ns_name=this.name,t.id=ae,Z&&te("   CREATED Context: "+this.name+" uid:"+ae+" len:"+this._set.length+"  context:"+re.inspect(t,!0,2,!0)),t};Fe.prototype.run=function(t){let r=this.createContext();this.enter(r);try{return Z&&te(" BEFORE RUN: "+this.name+" uid:"+ae+" len:"+this._set.length+" "+re.inspect(r)),t(r),r}catch(n){throw n&&(n[En]=r),n}finally{Z&&te(" AFTER RUN: "+this.name+" uid:"+ae+" len:"+this._set.length+" "+re.inspect(r)),this.exit(r)}};Fe.prototype.runAndReturn=function(t){var r;return this.run(function(n){r=t(n)}),r};Fe.prototype.runPromise=function(t){let r=this.createContext();this.enter(r);let n=t(r);if(!n||!n.then||!n.catch)throw new Error("fn must return a promise.");return Z&&te(" BEFORE runPromise: "+this.name+" uid:"+ae+" len:"+this._set.length+" "+re.inspect(r)),n.then(i=>(Z&&te(" AFTER runPromise: "+this.name+" uid:"+ae+" len:"+this._set.length+" "+re.inspect(r)),this.exit(r),i)).catch(i=>{throw i[En]=r,Z&&te(" AFTER runPromise: "+this.name+" uid:"+ae+" len:"+this._set.length+" "+re.inspect(r)),this.exit(r),i})};Fe.prototype.bind=function(t,r){r||(this.active?r=this.active:r=this.createContext());let n=this;return function(){n.enter(r);try{return t.apply(this,arguments)}catch(s){throw s&&(s[En]=r),s}finally{n.exit(r)}}};Fe.prototype.enter=function(t){dt.ok(t,"context must be provided for entering"),Z&&te("  ENTER "+this.name+" uid:"+ae+" len:"+this._set.length+" context: "+re.inspect(t)),this._set.push(this.active),this.active=t};Fe.prototype.exit=function(t){if(dt.ok(t,"context must be provided for exiting"),Z&&te("  EXIT "+this.name+" uid:"+ae+" len:"+this._set.length+" context: "+re.inspect(t)),this.active===t){dt.ok(this._set.length,"can't remove top context"),this.active=this._set.pop();return}let r=this._set.lastIndexOf(t);r<0?(Z&&te("??ERROR?? context exiting but not entered - ignoring: "+re.inspect(t)),dt.ok(r>=0,`context not currently entered; can't exit. 
`+re.inspect(this)+`
`+re.inspect(t))):(dt.ok(r,"can't remove top context"),this._set.splice(r,1))};Fe.prototype.bindEmitter=function(t){dt.ok(t.on&&t.addListener&&t.emit,"can only bind real EEs");let r=this,n="context@"+this.name;function i(a){!a||(a[Cn]||(a[Cn]=Object.create(null)),a[Cn][n]={namespace:r,context:r.active})}function s(a){if(!(a&&a[Cn]))return a;let o=a,u=a[Cn];return Object.keys(u).forEach(function(c){let l=u[c];o=l.namespace.bind(o,l.context)}),o}hy(t,i,s)};Fe.prototype.fromException=function(t){return t[En]};function pp(e){return process.namespaces[e]}function vy(e){dt.ok(e,"namespace must be given a name."),Z&&te("CREATING NAMESPACE "+e);let t=new Fe(e);return t.id=ae,br.addHooks({init(r,n,i,s,a){ae=r,s?(t._contexts.set(r,t._contexts.get(s)),Z&&te("PARENTID: "+e+" uid:"+r+" parent:"+s+" provider:"+i)):t._contexts.set(ae,t.active),Z&&te("INIT "+e+" uid:"+r+" parent:"+s+" provider:"+lp[i]+" active:"+re.inspect(t.active,!0))},pre(r,n){ae=r;let i=t._contexts.get(r);i?(Z&&te(" PRE "+e+" uid:"+r+" handle:"+qi(n)+" context:"+re.inspect(i)),t.enter(i)):Z&&te(" PRE MISSING CONTEXT "+e+" uid:"+r+" handle:"+qi(n))},post(r,n){ae=r;let i=t._contexts.get(r);i?(Z&&te(" POST "+e+" uid:"+r+" handle:"+qi(n)+" context:"+re.inspect(i)),t.exit(i)):Z&&te(" POST MISSING CONTEXT "+e+" uid:"+r+" handle:"+qi(n))},destroy(r){ae=r,Z&&te("DESTROY "+e+" uid:"+r+" context:"+re.inspect(t._contexts.get(ae))+" active:"+re.inspect(t.active,!0)),t._contexts.delete(r)}}),process.namespaces[e]=t,t}function fp(e){let t=pp(e);dt.ok(t,`can't delete nonexistent namespace! "`+e+'"'),dt.ok(t.id,"don't assign to process.namespaces directly! "+re.inspect(t)),process.namespaces[e]=null}function gy(){process.namespaces&&Object.keys(process.namespaces).forEach(function(e){fp(e)}),process.namespaces=Object.create(null)}process.namespaces={};br._state&&!br._state.enabled&&br.enable();function te(e){process.env.DEBUG&&process._rawDebug(e)}function qi(e){if(!e)return e;if(typeof e=="function")return e.name?e.name:(e.toString().trim().match(/^function\s*([^\s(]+)/)||[])[1];if(e.constructor&&e.constructor.name)return e.constructor.name}if(Z){Fa=La();for(cp in Fa.filter._modifiers)Fa.filter.deattach(cp)}var Fa,cp});var vp=h((RT,Ha)=>{"use strict";var my=hi();process&&my.gte(process.versions.node,"8.0.0")?Ha.exports=zl():Ha.exports=hp()});var yp=h((OT,mp)=>{var yy=ki().wrap,Ua=1<<0,$a=1<<1,Va=1<<2,Li=1<<3,G=[],_y=0,_e=!1,wt=[],Tr,Ba;function Ga(e,t){var r=e.length,n=t.length,i=[];if(r===0&&n===0)return i;for(var s=0;s<r;s++)i[s]=e[s];if(n===0)return i;for(var a=0;a<n;a++){var o=!0;for(s=0;s<r;s++)if(e[s].uid===t[a].uid){o=!1;break}o&&i.push(t[a])}return i}process._fatalException?(Ni=!1,Tr=function(t){var r=G.length;if(Ni||r===0)return!1;var n=!1;Ni=!0;for(var i=0;i<r;++i){var s=G[i];if((s.flags&Li)!==0){var a=wr&&wr[s.uid];n=s.error(a,t)||n}}return Ni=!1,wt.length>0&&(G=wt.pop()),wr=void 0,n&&!_e},Ba=function(t,r,n){var i=[];_e=!0;for(var s=0;s<n;++s){var a=r[s];if(i[a.uid]=a.data,(a.flags&Ua)!==0){var o=a.create(a.data);o!==void 0&&(i[a.uid]=o)}}return _e=!1,function(){wr=i,wt.push(G),G=Ga(r,G),_e=!0;for(var u=0;u<n;++u)(r[u].flags&$a)>0&&r[u].before(this,i[r[u].uid]);_e=!1;var c=t.apply(this,arguments);for(_e=!0,u=0;u<n;++u)(r[u].flags&Va)>0&&r[u].after(this,i[r[u].uid]);return _e=!1,G=wt.pop(),wr=void 0,c}},yy(process,"_fatalException",function(e){return function(r){return Tr(r)||e(r)}})):(ja=!1,Tr=function(t){if(ja)throw t;for(var r=!1,n=G.length,i=0;i<n;++i){var s=G[i];(s.flags&Li)!==0&&(r=s.error(null,t)||r)}if(!r&&_e)throw t},Ba=function(t,r,n){var i=[];_e=!0;for(var s=0;s<n;++s){var a=r[s];if(i[a.uid]=a.data,(a.flags&Ua)!==0){var o=a.create(a.data);o!==void 0&&(i[a.uid]=o)}}return _e=!1,function(){var u=!1,c=!1;wt.push(G),G=Ga(r,G),_e=!0;for(var l=0;l<n;++l)(r[l].flags&$a)>0&&r[l].before(this,i[r[l].uid]);_e=!1;var p;try{p=t.apply(this,arguments)}catch(f){u=!0;for(var l=0;l<n;++l)if((G[l].flags&Li)!=0)try{c=G[l].error(i[r[l].uid],f)||c}catch(g){throw ja=!0,g}if(!c)throw process.removeListener("uncaughtException",Tr),process._originalNextTick(function(){process.addListener("uncaughtException",Tr)}),f}finally{if(!u||c){for(_e=!0,l=0;l<n;++l)(r[l].flags&Va)>0&&r[l].after(this,i[r[l].uid]);_e=!1}G=wt.pop()}return p}},process.addListener("uncaughtException",Tr));var Ni,wr,ja;function Cy(e,t,r){_e=!0;for(var n=0;n<r;++n){var i=t[n];i.create&&i.create(i.data)}return _e=!1,function(){wt.push(G),G=Ga(t,G);var s=e.apply(this,arguments);return G=wt.pop(),s}}function Ey(e){var t=G.length;if(t===0)return e;for(var r=G.slice(),n=0;n<t;++n)if(r[n].flags>0)return Ba(e,r,t);return Cy(e,r,t)}function rt(e,t){typeof e.create=="function"&&(this.create=e.create,this.flags|=Ua),typeof e.before=="function"&&(this.before=e.before,this.flags|=$a),typeof e.after=="function"&&(this.after=e.after,this.flags|=Va),typeof e.error=="function"&&(this.error=e.error,this.flags|=Li),this.uid=++_y,this.data=t===void 0?null:t}rt.prototype.create=void 0;rt.prototype.before=void 0;rt.prototype.after=void 0;rt.prototype.error=void 0;rt.prototype.data=void 0;rt.prototype.uid=0;rt.prototype.flags=0;function gp(e,t){if(typeof e!="object"||!e)throw new TypeError("callbacks argument must be an object");return e instanceof rt?e:new rt(e,t)}function by(e,t){var r;e instanceof rt?r=e:r=gp(e,t);for(var n=!1,i=0;i<G.length;i++)if(r===G[i]){n=!0;break}return n||G.push(r),r}function Ty(e){for(var t=0;t<G.length;t++)if(e===G[t]){G.splice(t,1);break}}process.createAsyncListener=gp;process.addAsyncListener=by;process.removeAsyncListener=Ty;mp.exports=Ey});var Cp=h((NT,_p)=>{"use strict";_p.exports=(e,t)=>class extends e{constructor(n){var i,s;super(o);var a=this;try{n.apply(i,s)}catch(u){s[1](u)}return a;function o(u,c){i=this,s=[l,p];function l(f){return t(a,!1),u(f)}function p(f){return t(a,!1),c(f)}}}}});var Sp=h(()=>{"use strict";if(process.addAsyncListener)throw new Error("Don't require polyfill unless needed");var wp=ki(),Fi=hi(),Pe=wp.wrap,It=wp.massWrap,Y=yp(),wy=require("util"),Iy=Fi.gte(process.version,"6.0.0"),Wa=Fi.gte(process.version,"7.0.0"),xy=Fi.gte(process.version,"8.0.0"),Sy=Fi.gte(process.version,"11.0.0"),nt=require("net");Wa&&!nt._normalizeArgs?nt._normalizeArgs=function(e){if(e.length===0)return[{},null];var t=e[0],r={};typeof t=="object"&&t!==null?r=t:Ry(t)?r.path=t:(r.port=t,e.length>1&&typeof e[1]=="string"&&(r.host=e[1]));var n=e[e.length-1];return typeof n!="function"?[r,null]:[r,n]}:!Wa&&!nt._normalizeConnectArgs&&(nt._normalizeConnectArgs=function(e){var t={};function r(i){return(i=Number(i))>=0?i:!1}typeof e[0]=="object"&&e[0]!==null?t=e[0]:typeof e[0]=="string"&&r(e[0])===!1?t.path=e[0]:(t.port=e[0],typeof e[1]=="string"&&(t.host=e[1]));var n=e[e.length-1];return typeof n=="function"?[t,n]:[t]});"_setUpListenHandle"in nt.Server.prototype?Pe(nt.Server.prototype,"_setUpListenHandle",Ep):Pe(nt.Server.prototype,"_listen2",Ep);function Ep(e){return function(){this.on("connection",function(t){t._handle&&(t._handle.onread=Y(t._handle.onread))});try{return e.apply(this,arguments)}finally{this._handle&&this._handle.onconnection&&(this._handle.onconnection=Y(this._handle.onconnection))}}}function Ip(e){if(e&&e._handle){var t=e._handle;t._originalOnread||(t._originalOnread=t.onread),t.onread=Y(t._originalOnread)}}Pe(nt.Socket.prototype,"connect",function(e){return function(){var t;xy&&Array.isArray(arguments[0])&&Object.getOwnPropertySymbols(arguments[0]).length>0?t=arguments[0]:t=Wa?nt._normalizeArgs(arguments):nt._normalizeConnectArgs(arguments),t[1]&&(t[1]=Y(t[1]));var r=e.apply(this,t);return Ip(this),r}});var ky=require("http");Pe(ky.Agent.prototype,"addRequest",function(e){return function(t){var r=t.onSocket;return t.onSocket=Y(function(n){return Ip(n),r.apply(this,arguments)}),e.apply(this,arguments)}});var za=require("child_process");function bp(e){Array.isArray(e.stdio)&&e.stdio.forEach(function(t){t&&t._handle&&(t._handle.onread=Y(t._handle.onread),Pe(t._handle,"close",Hi))}),e._handle&&(e._handle.onexit=Y(e._handle.onexit))}za.ChildProcess?Pe(za.ChildProcess.prototype,"spawn",function(e){return function(){var t=e.apply(this,arguments);return bp(this),t}}):It(za,["execFile","fork","spawn"],function(e){return function(){var t=e.apply(this,arguments);return bp(t),t}});process._fatalException||(process._originalNextTick=process.nextTick);var Ja=[];process._nextDomainTick&&Ja.push("_nextDomainTick");process._tickDomainCallback&&Ja.push("_tickDomainCallback");It(process,Ja,it);Pe(process,"nextTick",Hi);var Ya=["setTimeout","setInterval"];global.setImmediate&&Ya.push("setImmediate");var xp=require("timers"),Py=global.setTimeout===xp.setTimeout;It(xp,Ya,Hi);Py&&It(global,Ya,Hi);var Xa=require("dns");It(Xa,["lookup","resolve","resolve4","resolve6","resolveCname","resolveMx","resolveNs","resolveTxt","resolveSrv","reverse"],it);Xa.resolveNaptr&&Pe(Xa,"resolveNaptr",it);var Xt=require("fs");It(Xt,["watch","rename","truncate","chown","fchown","chmod","fchmod","stat","lstat","fstat","link","symlink","readlink","realpath","unlink","rmdir","mkdir","readdir","close","open","utimes","futimes","fsync","write","read","readFile","writeFile","appendFile","watchFile","unwatchFile","exists"],it);Xt.lchown&&Pe(Xt,"lchown",it);Xt.lchmod&&Pe(Xt,"lchmod",it);Xt.ftruncate&&Pe(Xt,"ftruncate",it);var bn;try{bn=require("zlib")}catch{}bn&&bn.Deflate&&bn.Deflate.prototype&&(Wt=Object.getPrototypeOf(bn.Deflate.prototype),Wt._transform?Pe(Wt,"_transform",it):Wt.write&&Wt.flush&&Wt.end&&It(Wt,["write","flush","end"],it));var Wt,Ka;try{Ka=require("crypto")}catch{}Ka&&(Qa=["pbkdf2","randomBytes"],Sy||Qa.push("pseudoRandomBytes"),It(Ka,Qa,it));var Qa,Mi=!!global.Promise&&Promise.toString()==="function Promise() { [native code] }"&&Promise.toString.toString()==="function toString() { [native code] }";Mi&&(Tp=process.addAsyncListener({create:function(){Mi=!1}}),global.Promise.resolve(!0).then(function(){Mi=!1}),process.removeAsyncListener(Tp));var Tp;Mi&&Ay();function Ay(){var e=global.Promise;function t(a){if(!(this instanceof t))return e(a);if(typeof a!="function")return new e(a);var o,u,c=new e(l);c.__proto__=t.prototype;try{a.apply(o,u)}catch(p){u[1](p)}return c;function l(p,f){o=this,u=[d,g];function d(b){return n(c,!1),p(b)}function g(b){return n(c,!1),f(b)}}}if(wy.inherits(t,e),Pe(e.prototype,"then",s),e.prototype.chain&&Pe(e.prototype,"chain",s),Iy)global.Promise=Cp()(e,n);else{var r=["all","race","reject","resolve","accept","defer"];r.forEach(function(a){typeof e[a]=="function"&&(t[a]=e[a])}),global.Promise=t}function n(a,o){(!a.__asl_wrapper||o)&&(a.__asl_wrapper=Y(i))}function i(a,o,u,c){var l;try{return l=o.call(a,u),{returnVal:l,error:!1}}catch(p){return{errorVal:p,error:!0}}finally{l instanceof e?c.__asl_wrapper=function(){var f=l.__asl_wrapper||i;return f.apply(this,arguments)}:n(c,!0)}}function s(a){return function(){var u=this,c=a.apply(u,Array.prototype.map.call(arguments,l));return c.__asl_wrapper=function(f,d,g,b){return u.__asl_wrapper?(u.__asl_wrapper(f,function(){},null,c),c.__asl_wrapper(f,d,g,b)):i(f,d,g,b)},c;function l(p){return typeof p!="function"?p:Y(function(f){var d=(u.__asl_wrapper||i)(this,p,f,c);if(d.error)throw d.errorVal;return d.returnVal})}}}}function it(e){var t=function(){var r,n=arguments.length-1;if(typeof arguments[n]=="function"){r=Array(arguments.length);for(var i=0;i<arguments.length-1;i++)r[i]=arguments[i];r[n]=Y(arguments[n])}return e.apply(this,r||arguments)};switch(e.length){case 1:return function(r){return arguments.length!==1?t.apply(this,arguments):(typeof r=="function"&&(r=Y(r)),e.call(this,r))};case 2:return function(r,n){return arguments.length!==2?t.apply(this,arguments):(typeof n=="function"&&(n=Y(n)),e.call(this,r,n))};case 3:return function(r,n,i){return arguments.length!==3?t.apply(this,arguments):(typeof i=="function"&&(i=Y(i)),e.call(this,r,n,i))};case 4:return function(r,n,i,s){return arguments.length!==4?t.apply(this,arguments):(typeof s=="function"&&(s=Y(s)),e.call(this,r,n,i,s))};case 5:return function(r,n,i,s,a){return arguments.length!==5?t.apply(this,arguments):(typeof a=="function"&&(a=Y(a)),e.call(this,r,n,i,s,a))};case 6:return function(r,n,i,s,a,o){return arguments.length!==6?t.apply(this,arguments):(typeof o=="function"&&(o=Y(o)),e.call(this,r,n,i,s,a,o))};default:return t}}function Hi(e){var t=function(){var r;if(typeof arguments[0]=="function"){r=Array(arguments.length),r[0]=Y(arguments[0]);for(var n=1;n<arguments.length;n++)r[n]=arguments[n]}return e.apply(this,r||arguments)};switch(e.length){case 1:return function(r){return arguments.length!==1?t.apply(this,arguments):(typeof r=="function"&&(r=Y(r)),e.call(this,r))};case 2:return function(r,n){return arguments.length!==2?t.apply(this,arguments):(typeof r=="function"&&(r=Y(r)),e.call(this,r,n))};case 3:return function(r,n,i){return arguments.length!==3?t.apply(this,arguments):(typeof r=="function"&&(r=Y(r)),e.call(this,r,n,i))};case 4:return function(r,n,i,s){return arguments.length!==4?t.apply(this,arguments):(typeof r=="function"&&(r=Y(r)),e.call(this,r,n,i,s))};case 5:return function(r,n,i,s,a){return arguments.length!==5?t.apply(this,arguments):(typeof r=="function"&&(r=Y(r)),e.call(this,r,n,i,s,a))};case 6:return function(r,n,i,s,a,o){return arguments.length!==6?t.apply(this,arguments):(typeof r=="function"&&(r=Y(r)),e.call(this,r,n,i,s,a,o))};default:return t}}function Dy(e){return(e=Number(e))>=0?e:!1}function Ry(e){return typeof e=="string"&&Dy(e)===!1}});var Rp=h((FT,Dp)=>{"use strict";var ht=require("assert"),Oy=Di(),Tn="cls@contexts",Za="error@context";process.addAsyncListener||Sp();function We(e){this.name=e,this.active=null,this._set=[],this.id=null}We.prototype.set=function(e,t){if(!this.active)throw new Error("No context available. ns.run() or ns.bind() must be called first.");return this.active[e]=t,t};We.prototype.get=function(e){if(!!this.active)return this.active[e]};We.prototype.createContext=function(){return Object.create(this.active)};We.prototype.run=function(e){var t=this.createContext();this.enter(t);try{return e(t),t}catch(r){throw r&&(r[Za]=t),r}finally{this.exit(t)}};We.prototype.runAndReturn=function(e){var t;return this.run(function(r){t=e(r)}),t};We.prototype.bind=function(e,t){t||(this.active?t=this.active:t=this.createContext());var r=this;return function(){r.enter(t);try{return e.apply(this,arguments)}catch(n){throw n&&(n[Za]=t),n}finally{r.exit(t)}}};We.prototype.enter=function(e){ht.ok(e,"context must be provided for entering"),this._set.push(this.active),this.active=e};We.prototype.exit=function(e){if(ht.ok(e,"context must be provided for exiting"),this.active===e){ht.ok(this._set.length,"can't remove top context"),this.active=this._set.pop();return}var t=this._set.lastIndexOf(e);ht.ok(t>=0,"context not currently entered; can't exit"),ht.ok(t,"can't remove top context"),this._set.splice(t,1)};We.prototype.bindEmitter=function(e){ht.ok(e.on&&e.addListener&&e.emit,"can only bind real EEs");var t=this,r="context@"+this.name;function n(s){!s||(s[Tn]||(s[Tn]=Object.create(null)),s[Tn][r]={namespace:t,context:t.active})}function i(s){if(!(s&&s[Tn]))return s;var a=s,o=s[Tn];return Object.keys(o).forEach(function(u){var c=o[u];a=c.namespace.bind(a,c.context)}),a}Oy(e,n,i)};We.prototype.fromException=function(e){return e[Za]};function kp(e){return process.namespaces[e]}function qy(e){ht.ok(e,"namespace must be given a name!");var t=new We(e);return t.id=process.addAsyncListener({create:function(){return t.active},before:function(r,n){n&&t.enter(n)},after:function(r,n){n&&t.exit(n)},error:function(r){r&&t.exit(r)}}),process.namespaces[e]=t,t}function Pp(e){var t=kp(e);ht.ok(t,"can't delete nonexistent namespace!"),ht.ok(t.id,"don't assign to process.namespaces directly!"),process.removeAsyncListener(t.id),process.namespaces[e]=null}function Ap(){process.namespaces&&Object.keys(process.namespaces).forEach(function(e){Pp(e)}),process.namespaces=Object.create(null)}process.namespaces||Ap();Dp.exports={getNamespace:kp,createNamespace:qy,destroyNamespace:Pp,reset:Ap}});var Ft=h(to=>{"use strict";Object.defineProperty(to,"__esModule",{value:!0});var qp=de(),Ny=Ei(),wn=ln(),eo=ia(),Op=Ia(),Ly=function(){function e(){}return e.getCurrentContext=function(){if(!e.enabled)return null;var t=e.session.get(e.CONTEXT_NAME);return t===void 0?null:t},e.generateContextObject=function(t,r,n,i,s,a){return r=r||t,this.enabled?{operation:{name:n,id:t,parentId:r,traceparent:s,tracestate:a},customProperties:new My(i)}:null},e.spanToContextObject=function(t,r,n){var i=new wn;return i.traceId=t.traceId,i.spanId=t.spanId,i.traceFlag=t.traceFlags||wn.DEFAULT_TRACE_FLAG,i.parentId=r,e.generateContextObject(i.traceId,i.parentId,n,null,i)},e.runWithContext=function(t,r){if(e.enabled)return e.session.bind(r,(n={},n[e.CONTEXT_NAME]=t,n))();return r();var n},e.wrapEmitter=function(t){e.enabled&&e.session.bindEmitter(t)},e.wrapCallback=function(t,r){if(e.enabled)return e.session.bind(t,r?(n={},n[e.CONTEXT_NAME]=r,n):void 0);return t;var n},e.enable=function(t){if(!this.enabled){if(!this.isNodeVersionCompatible()){this.enabled=!1;return}e.hasEverEnabled||(this.forceClsHooked=t,this.hasEverEnabled=!0,typeof this.cls>"u"&&(e.forceClsHooked===!0||e.forceClsHooked===void 0&&e.shouldUseClsHooked()?this.cls=vp():this.cls=Rp()),e.session=this.cls.createNamespace("AI-CLS-Session"),Ny.registerContextPreservation(function(r){return e.session.bind(r)})),this.enabled=!0}},e.startOperation=function(t,r){var n=t&&t.traceContext||null,i=t&&t.traceId?t:null,s=t&&t.headers;if(i){var a=new wn("00-"+i.traceId+"-"+i.spanId+"-01"),o=new eo(i.tracestate),u=e.generateContextObject(i.traceId,"|"+i.traceId+"."+i.spanId+".",typeof r=="string"?r:"",void 0,a,o);return u}if(n){var a=new wn(n.traceparent),o=new eo(n.tracestate),c=typeof r=="object"?new Op(r):null,u=e.generateContextObject(a.traceId,a.parentId,typeof r=="string"?r:c.getOperationName({}),c&&c.getCorrelationContextHeader()||void 0,a,o);return u}if(s){var a=new wn(s.traceparent),o=new eo(s.tracestate),c=new Op(t),u=e.generateContextObject(a.traceId,a.parentId,c.getOperationName({}),c.getCorrelationContextHeader(),a,o);return u}return qp.warn("startOperation was called with invalid arguments",arguments),null},e.disable=function(){this.enabled=!1},e.reset=function(){e.hasEverEnabled&&(e.session=null,e.session=this.cls.createNamespace("AI-CLS-Session"))},e.isNodeVersionCompatible=function(){var t=process.versions.node.split(".");return parseInt(t[0])>3||parseInt(t[0])>2&&parseInt(t[1])>2},e.shouldUseClsHooked=function(){var t=process.versions.node.split(".");return parseInt(t[0])>8||parseInt(t[0])>=8&&parseInt(t[1])>=2},e.canUseClsHooked=function(){var t=process.versions.node.split("."),r=parseInt(t[0])>8||parseInt(t[0])>=8&&parseInt(t[1])>=0,n=parseInt(t[0])<8||parseInt(t[0])<=8&&parseInt(t[1])<2,i=parseInt(t[0])>4||parseInt(t[0])>=4&&parseInt(t[1])>=7;return!(r&&n)&&i},e.enabled=!1,e.hasEverEnabled=!1,e.forceClsHooked=void 0,e.CONTEXT_NAME="ApplicationInsights-Context",e}();to.CorrelationContextManager=Ly;var My=function(){function e(t){this.props=[],this.addHeaderData(t)}return e.prototype.addHeaderData=function(t){var r=t?t.split(", "):[];this.props=r.map(function(n){var i=n.split("=");return{key:i[0],value:i[1]}}).concat(this.props)},e.prototype.serializeToHeader=function(){return this.props.map(function(t){return t.key+"="+t.value}).join(", ")},e.prototype.getProperty=function(t){for(var r=0;r<this.props.length;++r){var n=this.props[r];if(n.key===t)return n.value}},e.prototype.setProperty=function(t,r){if(e.bannedCharacters.test(t)||e.bannedCharacters.test(r)){qp.warn("Correlation context property keys and values must not contain ',' or '='. setProperty was called with key: "+t+" and value: "+r);return}for(var n=0;n<this.props.length;++n){var i=this.props[n];if(i.key===t){i.value=r;return}}this.props.push({key:t,value:r})},e.bannedCharacters=/[,=]/,e}()});var Lp=h(ji=>{"use strict";Object.defineProperty(ji,"__esModule",{value:!0});var Np=Oe(),ro=ee(),Kt=[],no=function(e){var t=e.data.message;Kt.forEach(function(r){t instanceof Error?r.trackException({exception:t}):(t.lastIndexOf(`
`)==t.length-1&&(t=t.substring(0,t.length-1)),r.trackTrace({message:t,severity:e.data.stderr?Np.SeverityLevel.Warning:Np.SeverityLevel.Information}))})};function Fy(e,t){e?(Kt.length===0&&ro.channel.subscribe("console",no),Kt.push(t)):(Kt=Kt.filter(function(r){return r!=t}),Kt.length===0&&ro.channel.unsubscribe("console",no))}ji.enable=Fy;function Hy(){ro.channel.unsubscribe("console",no),Kt=[]}ji.dispose=Hy});var Mp=h(Ui=>{"use strict";Object.defineProperty(Ui,"__esModule",{value:!0});var Ir=Oe(),io=ee(),Jt=[],jy={10:Ir.SeverityLevel.Verbose,20:Ir.SeverityLevel.Verbose,30:Ir.SeverityLevel.Information,40:Ir.SeverityLevel.Warning,50:Ir.SeverityLevel.Error,60:Ir.SeverityLevel.Critical},so=function(e){var t=e.data.result;Jt.forEach(function(r){var n=jy[e.data.level];t instanceof Error?r.trackException({exception:t}):r.trackTrace({message:t,severity:n})})};function Uy(e,t){e?(Jt.length===0&&io.channel.subscribe("bunyan",so),Jt.push(t)):(Jt=Jt.filter(function(r){return r!=t}),Jt.length===0&&io.channel.unsubscribe("bunyan",so))}Ui.enable=Uy;function $y(){io.channel.unsubscribe("bunyan",so),Jt=[]}Ui.dispose=$y});var Fp=h($i=>{"use strict";Object.defineProperty($i,"__esModule",{value:!0});var me=Oe(),ao=ee(),Yt=[],Vy={syslog:function(e){var t={emerg:me.SeverityLevel.Critical,alert:me.SeverityLevel.Critical,crit:me.SeverityLevel.Critical,error:me.SeverityLevel.Error,warning:me.SeverityLevel.Warning,notice:me.SeverityLevel.Information,info:me.SeverityLevel.Information,debug:me.SeverityLevel.Verbose};return t[e]===void 0?me.SeverityLevel.Information:t[e]},npm:function(e){var t={error:me.SeverityLevel.Error,warn:me.SeverityLevel.Warning,info:me.SeverityLevel.Information,verbose:me.SeverityLevel.Verbose,debug:me.SeverityLevel.Verbose,silly:me.SeverityLevel.Verbose};return t[e]===void 0?me.SeverityLevel.Information:t[e]},unknown:function(e){return me.SeverityLevel.Information}},oo=function(e){var t=e.data.message;Yt.forEach(function(r){if(t instanceof Error)r.trackException({exception:t,properties:e.data.meta});else{var n=Vy[e.data.levelKind](e.data.level);r.trackTrace({message:t,severity:n,properties:e.data.meta})}})};function By(e,t){e?(Yt.length===0&&ao.channel.subscribe("winston",oo),Yt.push(t)):(Yt=Yt.filter(function(r){return r!=t}),Yt.length===0&&ao.channel.unsubscribe("winston",oo))}$i.enable=By;function Gy(){ao.channel.unsubscribe("winston",oo),Yt=[]}$i.dispose=Gy});var jp=h((VT,Hp)=>{"use strict";var zy=Ei(),Qy=function(){function e(t){if(e.INSTANCE)throw new Error("Console logging adapter tracking should be configured from the applicationInsights object");this._client=t,e.INSTANCE=this}return e.prototype.enable=function(t,r){zy.IsInitialized&&(Lp().enable(t&&r,this._client),Mp().enable(t,this._client),Fp().enable(t,this._client))},e.prototype.isInitialized=function(){return this._isInitialized},e.prototype.dispose=function(){e.INSTANCE=null,this.enable(!1,!1)},e._methodNames=["debug","info","log","warn","error"],e}();Hp.exports=Qy});var $p=h((BT,Up)=>{"use strict";var Wy=function(){function e(t){if(e.INSTANCE)throw new Error("Exception tracking should be configured from the applicationInsights object");e.INSTANCE=this,this._client=t;var r=process.versions.node.split(".");e._canUseUncaughtExceptionMonitor=parseInt(r[0])>13||parseInt(r[0])===13&&parseInt(r[1])>=7}return e.prototype.isInitialized=function(){return this._isInitialized},e.prototype.enable=function(t){var r=this;if(t){this._isInitialized=!0;var n=this;if(!this._exceptionListenerHandle){var i=function(s,a,o){o===void 0&&(o=new Error(e._FALLBACK_ERROR_MESSAGE)),r._client.trackException({exception:o}),r._client.flush({isAppCrashing:!0}),s&&a&&process.listeners(a).length===1&&(console.error(o),process.exit(1))};e._canUseUncaughtExceptionMonitor?(this._exceptionListenerHandle=i.bind(this,!1,void 0),process.on(e.UNCAUGHT_EXCEPTION_MONITOR_HANDLER_NAME,this._exceptionListenerHandle)):(this._exceptionListenerHandle=i.bind(this,!0,e.UNCAUGHT_EXCEPTION_HANDLER_NAME),this._rejectionListenerHandle=i.bind(this,!1,void 0),process.on(e.UNCAUGHT_EXCEPTION_HANDLER_NAME,this._exceptionListenerHandle),process.on(e.UNHANDLED_REJECTION_HANDLER_NAME,this._rejectionListenerHandle))}}else this._exceptionListenerHandle&&(e._canUseUncaughtExceptionMonitor?process.removeListener(e.UNCAUGHT_EXCEPTION_MONITOR_HANDLER_NAME,this._exceptionListenerHandle):(process.removeListener(e.UNCAUGHT_EXCEPTION_HANDLER_NAME,this._exceptionListenerHandle),process.removeListener(e.UNHANDLED_REJECTION_HANDLER_NAME,this._rejectionListenerHandle)),this._exceptionListenerHandle=void 0,this._rejectionListenerHandle=void 0,delete this._exceptionListenerHandle,delete this._rejectionListenerHandle)},e.prototype.dispose=function(){e.INSTANCE=null,this.enable(!1),this._isInitialized=!1},e.INSTANCE=null,e.UNCAUGHT_EXCEPTION_MONITOR_HANDLER_NAME="uncaughtExceptionMonitor",e.UNCAUGHT_EXCEPTION_HANDLER_NAME="uncaughtException",e.UNHANDLED_REJECTION_HANDLER_NAME="unhandledRejection",e._RETHROW_EXIT_MESSAGE="Application Insights Rethrow Exception Handler",e._FALLBACK_ERROR_MESSAGE="A promise was rejected without providing an error. Application Insights generated this error stack for you.",e._canUseUncaughtExceptionMonitor=!1,e}();Up.exports=Wy});var xt=h(M=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0});M.DEFAULT_BREEZE_ENDPOINT="https://dc.services.visualstudio.com";M.DEFAULT_LIVEMETRICS_ENDPOINT="https://rt.services.visualstudio.com";M.DEFAULT_LIVEMETRICS_HOST="rt.services.visualstudio.com";var Ce;(function(e){e.COMMITTED_BYTES="\\Memory\\Committed Bytes",e.PROCESSOR_TIME="\\Processor(_Total)\\% Processor Time",e.REQUEST_RATE="\\ApplicationInsights\\Requests/Sec",e.REQUEST_FAILURE_RATE="\\ApplicationInsights\\Requests Failed/Sec",e.REQUEST_DURATION="\\ApplicationInsights\\Request Duration",e.DEPENDENCY_RATE="\\ApplicationInsights\\Dependency Calls/Sec",e.DEPENDENCY_FAILURE_RATE="\\ApplicationInsights\\Dependency Calls Failed/Sec",e.DEPENDENCY_DURATION="\\ApplicationInsights\\Dependency Call Duration",e.EXCEPTION_RATE="\\ApplicationInsights\\Exceptions/Sec"})(Ce=M.QuickPulseCounter||(M.QuickPulseCounter={}));var Vi;(function(e){e.PRIVATE_BYTES="\\Process(??APP_WIN32_PROC??)\\Private Bytes",e.AVAILABLE_BYTES="\\Memory\\Available Bytes",e.PROCESSOR_TIME="\\Processor(_Total)\\% Processor Time",e.PROCESS_TIME="\\Process(??APP_WIN32_PROC??)\\% Processor Time",e.REQUEST_RATE="\\ASP.NET Applications(??APP_W3SVC_PROC??)\\Requests/Sec",e.REQUEST_DURATION="\\ASP.NET Applications(??APP_W3SVC_PROC??)\\Request Execution Time"})(Vi=M.PerformanceCounter||(M.PerformanceCounter={}));M.PerformanceToQuickPulseCounter=(Xe={},Xe[Vi.PROCESSOR_TIME]=Ce.PROCESSOR_TIME,Xe[Vi.REQUEST_RATE]=Ce.REQUEST_RATE,Xe[Vi.REQUEST_DURATION]=Ce.REQUEST_DURATION,Xe[Ce.COMMITTED_BYTES]=Ce.COMMITTED_BYTES,Xe[Ce.REQUEST_FAILURE_RATE]=Ce.REQUEST_FAILURE_RATE,Xe[Ce.DEPENDENCY_RATE]=Ce.DEPENDENCY_RATE,Xe[Ce.DEPENDENCY_FAILURE_RATE]=Ce.DEPENDENCY_FAILURE_RATE,Xe[Ce.DEPENDENCY_DURATION]=Ce.DEPENDENCY_DURATION,Xe[Ce.EXCEPTION_RATE]=Ce.EXCEPTION_RATE,Xe);M.QuickPulseDocumentType={Event:"Event",Exception:"Exception",Trace:"Trace",Metric:"Metric",Request:"Request",Dependency:"RemoteDependency",Availability:"Availability",PageView:"PageView"};M.QuickPulseType={Event:"EventTelemetryDocument",Exception:"ExceptionTelemetryDocument",Trace:"TraceTelemetryDocument",Metric:"MetricTelemetryDocument",Request:"RequestTelemetryDocument",Dependency:"DependencyTelemetryDocument",Availability:"AvailabilityTelemetryDocument",PageView:"PageViewTelemetryDocument"};M.TelemetryTypeStringToQuickPulseType={EventData:M.QuickPulseType.Event,ExceptionData:M.QuickPulseType.Exception,MessageData:M.QuickPulseType.Trace,MetricData:M.QuickPulseType.Metric,RequestData:M.QuickPulseType.Request,RemoteDependencyData:M.QuickPulseType.Dependency,AvailabilityData:M.QuickPulseType.Availability,PageViewData:M.QuickPulseType.PageView};M.TelemetryTypeStringToQuickPulseDocumentType={EventData:M.QuickPulseDocumentType.Event,ExceptionData:M.QuickPulseDocumentType.Exception,MessageData:M.QuickPulseDocumentType.Trace,MetricData:M.QuickPulseDocumentType.Metric,RequestData:M.QuickPulseDocumentType.Request,RemoteDependencyData:M.QuickPulseDocumentType.Dependency,AvailabilityData:M.QuickPulseDocumentType.Availability,PageViewData:M.QuickPulseDocumentType.PageView};M.SpanAttribute={HttpHost:"http.host",HttpMethod:"http.method",HttpPort:"http.port",HttpStatusCode:"http.status_code",HttpUrl:"http.url",HttpUserAgent:"http.user_agent",GrpcMethod:"grpc.method",GrpcService:"rpc.service"};M.DependencyTypeName={Grpc:"GRPC",Http:"HTTP",InProc:"InProc"};M.HeartBeatMetricName="HeartBeat";var Xe});var Gi=h((zT,Vp)=>{"use strict";var Bi=require("os"),He=xt(),Xy=function(){function e(t,r,n){r===void 0&&(r=6e4),n===void 0&&(n=!1),this._lastIntervalRequestExecutionTime=0,this._lastIntervalDependencyExecutionTime=0,e.INSTANCE||(e.INSTANCE=this),this._isInitialized=!1,this._client=t,this._collectionInterval=r,this._enableLiveMetricsCounters=n}return e.prototype.enable=function(t,r){var n=this;this._isEnabled=t,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),t?this._handle||(this._lastCpus=Bi.cpus(),this._lastRequests={totalRequestCount:e._totalRequestCount,totalFailedRequestCount:e._totalFailedRequestCount,time:+new Date},this._lastDependencies={totalDependencyCount:e._totalDependencyCount,totalFailedDependencyCount:e._totalFailedDependencyCount,time:+new Date},this._lastExceptions={totalExceptionCount:e._totalExceptionCount,time:+new Date},typeof process.cpuUsage=="function"&&(this._lastAppCpuUsage=process.cpuUsage()),this._lastHrtime=process.hrtime(),this._collectionInterval=r||this._collectionInterval,this._handle=setInterval(function(){return n.trackPerformance()},this._collectionInterval),this._handle.unref()):this._handle&&(clearInterval(this._handle),this._handle=void 0)},e.countRequest=function(t,r){var n;if(!!e.isEnabled()){if(typeof t=="string")n=+new Date("1970-01-01T"+t+"Z");else if(typeof t=="number")n=t;else return;e._intervalRequestExecutionTime+=n,r===!1&&e._totalFailedRequestCount++,e._totalRequestCount++}},e.countException=function(){e._totalExceptionCount++},e.countDependency=function(t,r){var n;if(!!e.isEnabled()){if(typeof t=="string")n=+new Date("1970-01-01T"+t+"Z");else if(typeof t=="number")n=t;else return;e._intervalDependencyExecutionTime+=n,r===!1&&e._totalFailedDependencyCount++,e._totalDependencyCount++}},e.prototype.isInitialized=function(){return this._isInitialized},e.isEnabled=function(){return e.INSTANCE&&e.INSTANCE._isEnabled},e.prototype.trackPerformance=function(){this._trackCpu(),this._trackMemory(),this._trackNetwork(),this._trackDependencyRate(),this._trackExceptionRate()},e.prototype._trackCpu=function(){var t=Bi.cpus();if(t&&t.length&&this._lastCpus&&t.length===this._lastCpus.length){for(var r=0,n=0,i=0,s=0,a=0,o=0;!!t&&o<t.length;o++){var u=t[o],c=this._lastCpus[o],l="% cpu("+o+") ",p=u.model,f=u.speed,d=u.times,g=c.times,b=d.user-g.user||0;r+=b;var x=d.sys-g.sys||0;n+=x;var A=d.nice-g.nice||0;i+=A;var y=d.idle-g.idle||0;s+=y;var w=d.irq-g.irq||0;a+=w}var B=void 0;if(typeof process.cpuUsage=="function"){var $=process.cpuUsage(),oe=process.hrtime(),xe=$.user-this._lastAppCpuUsage.user+($.system-this._lastAppCpuUsage.system)||0;if(typeof this._lastHrtime<"u"&&this._lastHrtime.length===2){var Je=(oe[0]-this._lastHrtime[0])*1e6+(oe[1]-this._lastHrtime[1])/1e3||0;B=100*xe/(Je*t.length)}this._lastAppCpuUsage=$,this._lastHrtime=oe}var Ue=r+n+i+s+a||1;this._client.trackMetric({name:He.PerformanceCounter.PROCESSOR_TIME,value:(Ue-s)/Ue*100}),this._client.trackMetric({name:He.PerformanceCounter.PROCESS_TIME,value:B||r/Ue*100})}this._lastCpus=t},e.prototype._trackMemory=function(){var t=Bi.freemem(),r=process.memoryUsage().rss,n=Bi.totalmem()-t;this._client.trackMetric({name:He.PerformanceCounter.PRIVATE_BYTES,value:r}),this._client.trackMetric({name:He.PerformanceCounter.AVAILABLE_BYTES,value:t}),this._enableLiveMetricsCounters&&this._client.trackMetric({name:He.QuickPulseCounter.COMMITTED_BYTES,value:n})},e.prototype._trackNetwork=function(){var t=this._lastRequests,r={totalRequestCount:e._totalRequestCount,totalFailedRequestCount:e._totalFailedRequestCount,time:+new Date},n=r.totalRequestCount-t.totalRequestCount||0,i=r.totalFailedRequestCount-t.totalFailedRequestCount||0,s=r.time-t.time,a=s/1e3,o=(e._intervalRequestExecutionTime-this._lastIntervalRequestExecutionTime)/n||0;if(this._lastIntervalRequestExecutionTime=e._intervalRequestExecutionTime,s>0){var u=n/a,c=i/a;this._client.trackMetric({name:He.PerformanceCounter.REQUEST_RATE,value:u}),(!this._enableLiveMetricsCounters||n>0)&&this._client.trackMetric({name:He.PerformanceCounter.REQUEST_DURATION,value:o}),this._enableLiveMetricsCounters&&this._client.trackMetric({name:He.QuickPulseCounter.REQUEST_FAILURE_RATE,value:c})}this._lastRequests=r},e.prototype._trackDependencyRate=function(){if(this._enableLiveMetricsCounters){var t=this._lastDependencies,r={totalDependencyCount:e._totalDependencyCount,totalFailedDependencyCount:e._totalFailedDependencyCount,time:+new Date},n=r.totalDependencyCount-t.totalDependencyCount||0,i=r.totalFailedDependencyCount-t.totalFailedDependencyCount||0,s=r.time-t.time,a=s/1e3,o=(e._intervalDependencyExecutionTime-this._lastIntervalDependencyExecutionTime)/n||0;if(this._lastIntervalDependencyExecutionTime=e._intervalDependencyExecutionTime,s>0){var u=n/a,c=i/a;this._client.trackMetric({name:He.QuickPulseCounter.DEPENDENCY_RATE,value:u}),this._client.trackMetric({name:He.QuickPulseCounter.DEPENDENCY_FAILURE_RATE,value:c}),(!this._enableLiveMetricsCounters||n>0)&&this._client.trackMetric({name:He.QuickPulseCounter.DEPENDENCY_DURATION,value:o})}this._lastDependencies=r}},e.prototype._trackExceptionRate=function(){if(this._enableLiveMetricsCounters){var t=this._lastExceptions,r={totalExceptionCount:e._totalExceptionCount,time:+new Date},n=r.totalExceptionCount-t.totalExceptionCount||0,i=r.time-t.time,s=i/1e3;if(i>0){var a=n/s;this._client.trackMetric({name:He.QuickPulseCounter.EXCEPTION_RATE,value:a})}this._lastExceptions=r}},e.prototype.dispose=function(){e.INSTANCE=null,this.enable(!1),this._isInitialized=!1},e._totalRequestCount=0,e._totalFailedRequestCount=0,e._lastRequestExecutionTime=0,e._totalDependencyCount=0,e._totalFailedDependencyCount=0,e._lastDependencyExecutionTime=0,e._totalExceptionCount=0,e._intervalDependencyExecutionTime=0,e._intervalRequestExecutionTime=0,e}();Vp.exports=Xy});var In=h((QT,Qp)=>{"use strict";var vt=require("os"),Bp=require("fs"),Gp=require("path"),Ky=Oe(),zp=de(),Jy=function(){function e(t){this.keys=new Ky.ContextTagKeys,this.tags={},this._loadApplicationContext(t),this._loadDeviceContext(),this._loadInternalContext()}return e.prototype._loadApplicationContext=function(t){if(t=t||Gp.resolve(__dirname,"../../../../package.json"),!e.appVersion[t]){e.appVersion[t]="unknown";try{var r=JSON.parse(Bp.readFileSync(t,"utf8"));r&&typeof r.version=="string"&&(e.appVersion[t]=r.version)}catch(n){zp.info("unable to read app version: ",n)}}this.tags[this.keys.applicationVersion]=e.appVersion[t]},e.prototype._loadDeviceContext=function(){this.tags[this.keys.deviceId]="",this.tags[this.keys.cloudRoleInstance]=vt&&vt.hostname(),this.tags[this.keys.deviceOSVersion]=vt&&vt.type()+" "+vt.release(),this.tags[this.keys.cloudRole]=e.DefaultRoleName,this.tags["ai.device.osArchitecture"]=vt&&vt.arch(),this.tags["ai.device.osPlatform"]=vt&&vt.platform()},e.prototype._loadInternalContext=function(){var t=Gp.resolve(__dirname,"../../package.json");if(!e.sdkVersion){e.sdkVersion="unknown";try{var r=JSON.parse(Bp.readFileSync(t,"utf8"));r&&typeof r.version=="string"&&(e.sdkVersion=r.version)}catch(n){zp.info("unable to read app version: ",n)}}this.tags[this.keys.internalSdkVersion]="node:"+e.sdkVersion},e.DefaultRoleName="Web",e.appVersion={},e.sdkVersion=null,e}();Qp.exports=Jy});var Xp=h((co,Wp)=>{"use strict";var Yy=co&&co.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ke=require("url"),uo=Oe(),Zy=Re(),e_=_r(),t_=ba(),r_=Bt(),n_=function(e){Yy(t,e);function t(r,n){var i=e.call(this)||this;return n&&n.method&&r&&(i.method=n.method,i.url=t._getUrlFromRequestOptions(r,n),i.startTime=+new Date),i}return t.prototype.onError=function(r){this._setStatus(void 0,r)},t.prototype.onResponse=function(r){this._setStatus(r.statusCode,void 0),this.correlationId=Zy.getCorrelationContextTarget(r,e_.requestContextTargetKey)},t.prototype.getDependencyTelemetry=function(r,n){var i=Ke.parse(this.url);i.search=void 0,i.hash=void 0;var s=this.method.toUpperCase()+" "+i.pathname,a=uo.RemoteDependencyDataConstants.TYPE_HTTP,o=i.hostname;i.port&&(o+=":"+i.port),this.correlationId?(a=uo.RemoteDependencyDataConstants.TYPE_AI,this.correlationId!==r_.correlationIdPrefix&&(o+=" | "+this.correlationId)):a=uo.RemoteDependencyDataConstants.TYPE_HTTP;var u={id:n,name:s,data:this.url,duration:this.duration,success:this._isSuccess(),resultCode:this.statusCode?this.statusCode.toString():null,properties:this.properties||{},dependencyTypeName:a,target:o};if(r&&r.time?u.time=r.time:this.startTime&&(u.time=new Date(this.startTime)),r){for(var c in r)u[c]||(u[c]=r[c]);if(r.properties)for(var c in r.properties)u.properties[c]=r.properties[c]}return u},t._getUrlFromRequestOptions=function(r,n){if(typeof r=="string")if(r.indexOf("http://")===0||r.indexOf("https://")===0)r=Ke.parse(r);else{var i=Ke.parse(r);i.host==="443"?r=Ke.parse("https://"+r):r=Ke.parse("http://"+r)}else{if(r&&typeof Ke.URL=="function"&&r instanceof Ke.URL)return Ke.format(r);var s=r;r={},s&&Object.keys(s).forEach(function(u){r[u]=s[u]})}if(r.path){var a=Ke.parse(r.path);r.pathname=a.pathname,r.search=a.search}if(r.host&&r.port){var o=Ke.parse("http://"+r.host);!o.port&&r.port&&(r.hostname=r.host,delete r.host)}return r.protocol=r.protocol||n.agent&&n.agent.protocol||n.protocol||void 0,r.hostname=r.hostname||"localhost",Ke.format(r)},t}(t_);Wp.exports=n_});var Jp=h(xn=>{"use strict";var Kp=xn&&xn.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e};Object.defineProperty(xn,"__esModule",{value:!0});var i_=ii(),Ae=xt();function lo(e){var t=Kp({},e);return Object.keys(Ae.SpanAttribute).forEach(function(r){delete t[r]}),t}function s_(e){var t="|"+e.context().traceId+"."+e.context().spanId+".",r=Math.round(e._duration[0]*1e3+e._duration[1]/1e6),n=e.attributes["peer.address"]?e.attributes["peer.address"].toString():"",i=e.attributes.component?e.attributes.component.toString():"",s=i.toUpperCase()===Ae.DependencyTypeName.Http||!!e.attributes[Ae.SpanAttribute.HttpUrl],a=i.toLowerCase()===Ae.DependencyTypeName.Grpc;if(s){var o=e.attributes[Ae.SpanAttribute.HttpMethod]||"GET",u=new URL(e.attributes[Ae.SpanAttribute.HttpUrl].toString()),c=e.attributes[Ae.SpanAttribute.HttpHost]||u.host,l=e.attributes[Ae.SpanAttribute.HttpPort]||u.port||null,p=u.pathname||"/",f=o+" "+p,d=Ae.DependencyTypeName.Http,g=l?(c+":"+l).toString():c.toString(),b=u.toString(),x=e.attributes[Ae.SpanAttribute.HttpStatusCode]||e.status.code||0,A=x<400;return{id:t,name:f,dependencyTypeName:d,target:g,data:b,success:A,duration:r,url:b,resultCode:String(x),properties:lo(e.attributes)}}else if(a){var o=e.attributes[Ae.SpanAttribute.GrpcMethod]||"rpc",y=e.attributes[Ae.SpanAttribute.GrpcService],w=y?o+" "+y:e.name;return{id:t,duration:r,name:w,target:y.toString(),data:y.toString()||w,url:y.toString()||w,dependencyTypeName:Ae.DependencyTypeName.Grpc,resultCode:String(e.status.code||0),success:e.status.code===0,properties:lo(e.attributes)}}else{var B=e.name,$=e.links&&e.links.map(function(oe){return{operation_Id:oe.context.traceId,id:oe.context.spanId}});return{id:t,duration:r,name:B,target:n,data:n||B,url:n||B,dependencyTypeName:e.kind===i_.SpanKind.INTERNAL?Ae.DependencyTypeName.InProc:i||e.name,resultCode:String(e.status.code||0),success:e.status.code===0,properties:Kp({},lo(e.attributes),{"_MS.links":$||void 0})}}}xn.spanToTelemetryContract=s_});var Zp=h(Sr=>{"use strict";Object.defineProperty(Sr,"__esModule",{value:!0});var Yp=ee(),a_=ln(),o_=Jp(),zi=ii(),xr=[];Sr.subscriber=function(e){var t=e.data,r=o_.spanToTelemetryContract(t),n=t.context(),i=new a_;i.traceId=n.traceId,i.spanId=n.spanId,i.traceFlag=n.traceFlags.toString(),i.parentId=t.parentSpanId?"|"+n.traceId+"."+t.parentSpanId+".":null,zi.AsyncScopeManager.with(t,function(){xr.forEach(function(s){t.kind===zi.SpanKind.SERVER?s.trackRequest(r):(t.kind===zi.SpanKind.CLIENT||t.kind===zi.SpanKind.INTERNAL)&&s.trackDependency(r)})})};function u_(e,t){e?(xr.length===0&&Yp.channel.subscribe("azure-coretracing",Sr.subscriber),xr.push(t)):(xr=xr.filter(function(r){return r!=t}),xr.length===0&&Yp.channel.unsubscribe("azure-coretracing",Sr.subscriber))}Sr.enable=u_});var tf=h(Pr=>{"use strict";Object.defineProperty(Pr,"__esModule",{value:!0});var ef=ee(),kr=[];Pr.subscriber=function(e){e.data.event.commandName!=="ismaster"&&kr.forEach(function(t){var r=e.data.startedData&&e.data.startedData.databaseName||"Unknown database";t.trackDependency({target:r,data:e.data.event.commandName,name:e.data.event.commandName,duration:e.data.event.duration,success:e.data.succeeded,resultCode:e.data.succeeded?"0":"1",time:e.data.startedData.time,dependencyTypeName:"mongodb"})})};function c_(e,t){e?(kr.length===0&&ef.channel.subscribe("mongodb",Pr.subscriber),kr.push(t)):(kr=kr.filter(function(r){return r!=t}),kr.length===0&&ef.channel.unsubscribe("mongodb",Pr.subscriber))}Pr.enable=c_});var nf=h(Dr=>{"use strict";Object.defineProperty(Dr,"__esModule",{value:!0});var rf=ee(),Ar=[];Dr.subscriber=function(e){Ar.forEach(function(t){var r=e.data.query||{},n=r.sql||"Unknown query",i=!e.data.err,s=r._connection||{},a=s.config||{},o=a.socketPath?a.socketPath:(a.host||"localhost")+":"+a.port;t.trackDependency({target:o,data:n,name:n,duration:e.data.duration,success:i,resultCode:i?"0":"1",time:e.data.time,dependencyTypeName:"mysql"})})};function l_(e,t){e?(Ar.length===0&&rf.channel.subscribe("mysql",Dr.subscriber),Ar.push(t)):(Ar=Ar.filter(function(r){return r!=t}),Ar.length===0&&rf.channel.unsubscribe("mysql",Dr.subscriber))}Dr.enable=l_});var af=h(Or=>{"use strict";Object.defineProperty(Or,"__esModule",{value:!0});var sf=ee(),Rr=[];Or.subscriber=function(e){Rr.forEach(function(t){e.data.commandObj.command!=="info"&&t.trackDependency({target:e.data.address,name:e.data.commandObj.command,data:e.data.commandObj.command,duration:e.data.duration,success:!e.data.err,resultCode:e.data.err?"1":"0",time:e.data.time,dependencyTypeName:"redis"})})};function p_(e,t){e?(Rr.length===0&&sf.channel.subscribe("redis",Or.subscriber),Rr.push(t)):(Rr=Rr.filter(function(r){return r!=t}),Rr.length===0&&sf.channel.unsubscribe("redis",Or.subscriber))}Or.enable=p_});var uf=h(Nr=>{"use strict";Object.defineProperty(Nr,"__esModule",{value:!0});var of=ee(),qr=[];Nr.subscriber=function(e){qr.forEach(function(t){var r=e.data.query,n=r.preparable&&r.preparable.text||r.plan||r.text||"unknown query",i=!e.data.error,s=e.data.database.host+":"+e.data.database.port;t.trackDependency({target:s,data:n,name:n,duration:e.data.duration,success:i,resultCode:i?"0":"1",time:e.data.time,dependencyTypeName:"postgres"})})};function f_(e,t){e?(qr.length===0&&of.channel.subscribe("postgres",Nr.subscriber),qr.push(t)):(qr=qr.filter(function(r){return r!=t}),qr.length===0&&of.channel.unsubscribe("postgres",Nr.subscriber))}Nr.enable=f_});var Mr=h((ew,ff)=>{"use strict";var Zt=require("http"),Lr=require("https"),po=de(),cf=Re(),St=_r(),d_=Xp(),lf=Ft(),pf=Bt(),fo=ln(),h_=Ei(),v_=function(){function e(t){if(e.INSTANCE)throw new Error("Client request tracking should be configured from the applicationInsights object");e.INSTANCE=this,this._client=t}return e.prototype.enable=function(t){this._isEnabled=t,this._isEnabled&&!this._isInitialized&&this._initialize(),h_.IsInitialized&&(Zp().enable(!0,this._client),tf().enable(t,this._client),nf().enable(t,this._client),af().enable(t,this._client),uf().enable(t,this._client))},e.prototype.isInitialized=function(){return this._isInitialized},e.prototype._initialize=function(){var t=this;this._isInitialized=!0;var r=Zt.get,n=Zt.request,i=Lr.request,s=function(a,o){var u=!o[e.disableCollectionRequestOption]&&!a[e.alreadyAutoCollectedFlag];o.headers&&o.headers["user-agent"]&&o.headers["user-agent"].toString().indexOf("azsdk-js")!==-1&&(u=!1),a[e.alreadyAutoCollectedFlag]=!0,a&&o&&u&&(lf.CorrelationContextManager.wrapEmitter(a),e.trackRequest(t._client,{options:o,request:a}))};Zt.request=function(a){for(var o=[],u=1;u<arguments.length;u++)o[u-1]=arguments[u];var c=n.call.apply(n,[Zt,a].concat(o));return s(c,a),c},Lr.request=function(a){for(var o=[],u=1;u<arguments.length;u++)o[u-1]=arguments[u];var c=i.call.apply(i,[Lr,a].concat(o));return s(c,a),c},Zt.get=function(a){for(var o=[],u=1;u<arguments.length;u++)o[u-1]=arguments[u];var c=(l=Zt.request).call.apply(l,[Zt,a].concat(o));return c.end(),c;var l},Lr.get=function(a){for(var o=[],u=1;u<arguments.length;u++)o[u-1]=arguments[u];var c=(l=Lr.request).call.apply(l,[Lr,a].concat(o));return c.end(),c;var l}},e.trackRequest=function(t,r){if(!r.options||!r.request||!t){po.info("AutoCollectHttpDependencies.trackRequest was called with invalid parameters: ",!r.options,!r.request,!t);return}var n=new d_(r.options,r.request),i=lf.CorrelationContextManager.getCurrentContext(),s,a;if(i&&i.operation&&i.operation.traceparent&&fo.isValidTraceId(i.operation.traceparent.traceId))i.operation.traceparent.updateSpanId(),s=i.operation.traceparent.getBackCompatRequestId();else if(pf.w3cEnabled){var o=new fo;a=o.toString(),s=o.getBackCompatRequestId()}else s=i&&i.operation&&i.operation.parentId+e.requestNumber+++".";if(cf.canIncludeCorrelationHeader(t,n.getUrl())&&r.request.getHeader&&r.request.setHeader&&t.config&&t.config.correlationId){var u=r.request.getHeader(St.requestContextHeader);try{cf.safeIncludeCorrelationHeader(t,r.request,u)}catch(p){po.warn("Request-Context header could not be set. Correlation of requests may be lost",p)}if(i&&i.operation)try{if(r.request.setHeader(St.requestIdHeader,s),t.config.ignoreLegacyHeaders||(r.request.setHeader(St.parentIdHeader,i.operation.id),r.request.setHeader(St.rootIdHeader,s)),a||i.operation.traceparent)r.request.setHeader(St.traceparentHeader,a||i.operation.traceparent.toString());else if(pf.w3cEnabled){var o=new fo().toString();r.request.setHeader(St.traceparentHeader,o)}if(i.operation.tracestate){var c=i.operation.tracestate.toString();c&&r.request.setHeader(St.traceStateHeader,c)}var l=i.customProperties.serializeToHeader();l&&r.request.setHeader(St.correlationContextHeader,l)}catch(p){po.warn("Correlation headers could not be set. Correlation of requests may be lost.",p)}}r.request.on&&(r.request.on("response",function(p){n.onResponse(p);var f=n.getDependencyTelemetry(r,s);f.contextObjects=f.contextObjects||{},f.contextObjects["http.RequestOptions"]=r.options,f.contextObjects["http.ClientRequest"]=r.request,f.contextObjects["http.ClientResponse"]=p,t.trackDependency(f)}),r.request.on("error",function(p){n.onError(p);var f=n.getDependencyTelemetry(r,s);f.contextObjects=f.contextObjects||{},f.contextObjects["http.RequestOptions"]=r.options,f.contextObjects["http.ClientRequest"]=r.request,f.contextObjects.Error=p,t.trackDependency(f)}))},e.prototype.dispose=function(){e.INSTANCE=null,this.enable(!1),this._isInitialized=!1},e.disableCollectionRequestOption="disableAppInsightsAutoCollection",e.requestNumber=1,e.alreadyAutoCollectedFlag="_appInsightsAutoCollected",e}();ff.exports=v_});var vf=h((tw,hf)=>{"use strict";var g_=require("os"),df=xt(),m_=Re(),y_=In(),__=Mr(),C_="http://169.254.169.254/metadata/instance/compute",E_="api-version=2017-12-01",b_="format=json",T_="ENETUNREACH",w_=function(){function e(t){this._collectionInterval=9e5,this._vmData={},this._azInst_vmId="",this._azInst_subscriptionId="",this._azInst_osType="",e.INSTANCE||(e.INSTANCE=this),this._isInitialized=!1,this._client=t}return e.prototype.enable=function(t,r){var n=this;this._isEnabled=t,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),t?this._handle||(this._handle=setInterval(function(){return n.trackHeartBeat(r,function(){})},this._collectionInterval),this._handle.unref()):this._handle&&(clearInterval(this._handle),this._handle=null)},e.prototype.isInitialized=function(){return this._isInitialized},e.isEnabled=function(){return e.INSTANCE&&e.INSTANCE._isEnabled},e.prototype.trackHeartBeat=function(t,r){var n=this,i=!1,s={},a=y_.sdkVersion;s.sdk=a,s.osType=g_.type(),process.env.WEBSITE_SITE_NAME?(s.appSrv_SiteName=process.env.WEBSITE_SITE_NAME||"",s.appSrv_wsStamp=process.env.WEBSITE_HOME_STAMPNAME||"",s.appSrv_wsHost=process.env.WEBSITE_HOSTNAME||""):process.env.FUNCTIONS_WORKER_RUNTIME?s.azfunction_appId=process.env.WEBSITE_HOSTNAME:t&&(this._isVM===void 0?(i=!0,this._getAzureComputeMetadata(t,function(){n._isVM&&Object.keys(n._vmData).length>0&&(s.azInst_vmId=n._vmData.vmId||"",s.azInst_subscriptionId=n._vmData.subscriptionId||"",s.azInst_osType=n._vmData.osType||"",n._azInst_vmId=n._vmData.vmId||"",n._azInst_subscriptionId=n._vmData.subscriptionId||"",n._azInst_osType=n._vmData.osType||""),n._client.trackMetric({name:df.HeartBeatMetricName,value:0,properties:s}),r()})):this._isVM&&(s.azInst_vmId=this._azInst_vmId,s.azInst_subscriptionId=this._azInst_subscriptionId,s.azInst_osType=this._azInst_osType)),i||(this._client.trackMetric({name:df.HeartBeatMetricName,value:0,properties:s}),r())},e.prototype.dispose=function(){e.INSTANCE=null,this.enable(!1),this._isInitialized=!1},e.prototype._getAzureComputeMetadata=function(t,r){var n=this,i=C_+"?"+E_+"&"+b_,s=(o={method:"GET"},o[__.disableCollectionRequestOption]=!0,o.headers={Metadata:"True"},o),a=m_.makeRequest(t,i,s,function(u){if(u.statusCode===200){n._isVM=!0;var c="";u.on("data",function(l){c+=l}),u.on("end",function(){n._vmData=n._isJSON(c)?JSON.parse(c):{},r()})}else r()});a&&(a.on("error",function(u){u&&u.message&&u.message.indexOf(T_)>-1&&(n._isVM=!1),r()}),a.end());var o},e.prototype._isJSON=function(t){try{return JSON.parse(t)&&!!t}catch{return!1}},e}();hf.exports=w_});var vo=h((rw,Cf)=>{"use strict";var gf=require("http"),mf=require("https"),yf=de(),_f=Re(),I_=_r(),ho=Ia(),gt=Ft(),x_=Gi(),S_=function(){function e(t){if(e.INSTANCE)throw new Error("Server request tracking should be configured from the applicationInsights object");e.INSTANCE=this,this._client=t}return e.prototype.enable=function(t){this._isEnabled=t,(this._isAutoCorrelating||this._isEnabled||x_.isEnabled())&&!this._isInitialized&&(this.useAutoCorrelation(this._isAutoCorrelating),this._initialize())},e.prototype.useAutoCorrelation=function(t,r){t&&!this._isAutoCorrelating?gt.CorrelationContextManager.enable(r):!t&&this._isAutoCorrelating&&gt.CorrelationContextManager.disable(),this._isAutoCorrelating=t},e.prototype.isInitialized=function(){return this._isInitialized},e.prototype.isAutoCorrelating=function(){return this._isAutoCorrelating},e.prototype._generateCorrelationContext=function(t){if(!!this._isAutoCorrelating)return gt.CorrelationContextManager.generateContextObject(t.getOperationId(this._client.context.tags),t.getRequestId(),t.getOperationName(this._client.context.tags),t.getCorrelationContextHeader(),t.getTraceparent(),t.getTracestate())},e.prototype._initialize=function(){var t=this;this._isInitialized=!0;var r=function(a){if(!!a){if(typeof a!="function")throw new Error("onRequest handler must be a function");return function(o,u){gt.CorrelationContextManager.wrapEmitter(o),gt.CorrelationContextManager.wrapEmitter(u);var c=o&&!o[e.alreadyAutoCollectedFlag];if(o&&c){var l=new ho(o),p=t._generateCorrelationContext(l);gt.CorrelationContextManager.runWithContext(p,function(){t._isEnabled&&(o[e.alreadyAutoCollectedFlag]=!0,e.trackRequest(t._client,{request:o,response:u},l)),typeof a=="function"&&a(o,u)})}else typeof a=="function"&&a(o,u)}}},n=function(a){var o=a.addListener.bind(a);a.addListener=function(u,c){switch(u){case"request":case"checkContinue":return o(u,r(c));default:return o(u,c)}},a.on=a.addListener},i=gf.createServer;gf.createServer=function(a,o){if(o&&typeof o=="function"){var u=i(a,r(o));return n(u),u}else{var u=i(r(a));return n(u),u}};var s=mf.createServer;mf.createServer=function(a,o){var u=s(a,r(o));return n(u),u}},e.trackRequestSync=function(t,r){if(!r.request||!r.response||!t){yf.info("AutoCollectHttpRequests.trackRequestSync was called with invalid parameters: ",!r.request,!r.response,!t);return}e.addResponseCorrelationIdHeader(t,r.response);var n=gt.CorrelationContextManager.getCurrentContext(),i=new ho(r.request,n&&n.operation.parentId);n&&(n.operation.id=i.getOperationId(t.context.tags)||n.operation.id,n.operation.name=i.getOperationName(t.context.tags)||n.operation.name,n.operation.parentId=i.getRequestId()||n.operation.parentId,n.customProperties.addHeaderData(i.getCorrelationContextHeader())),e.endRequest(t,i,r,r.duration,r.error)},e.trackRequest=function(t,r,n){if(!r.request||!r.response||!t){yf.info("AutoCollectHttpRequests.trackRequest was called with invalid parameters: ",!r.request,!r.response,!t);return}var i=gt.CorrelationContextManager.getCurrentContext(),s=n||new ho(r.request,i&&i.operation.parentId);_f.canIncludeCorrelationHeader(t,s.getUrl())&&e.addResponseCorrelationIdHeader(t,r.response),i&&!n&&(i.operation.id=s.getOperationId(t.context.tags)||i.operation.id,i.operation.name=s.getOperationName(t.context.tags)||i.operation.name,i.operation.parentId=s.getOperationParentId(t.context.tags)||i.operation.parentId,i.customProperties.addHeaderData(s.getCorrelationContextHeader())),r.response.once&&r.response.once("finish",function(){e.endRequest(t,s,r,null,null)}),r.request.on&&r.request.on("error",function(a){e.endRequest(t,s,r,null,a)})},e.addResponseCorrelationIdHeader=function(t,r){if(t.config&&t.config.correlationId&&r.getHeader&&r.setHeader&&!r.headersSent){var n=r.getHeader(I_.requestContextHeader);_f.safeIncludeCorrelationHeader(t,r,n)}},e.endRequest=function(t,r,n,i,s){s?r.onError(s,i):r.onResponse(n.response,i);var a=r.getRequestTelemetry(n);if(a.tagOverrides=r.getRequestTags(t.context.tags),n.tagOverrides)for(var o in n.tagOverrides)a.tagOverrides[o]=n.tagOverrides[o];var u=r.getLegacyRootId();u&&(a.properties.ai_legacyRootId=u),a.contextObjects=a.contextObjects||{},a.contextObjects["http.ServerRequest"]=n.request,a.contextObjects["http.ServerResponse"]=n.response,t.trackRequest(a)},e.prototype.dispose=function(){e.INSTANCE=null,this.enable(!1),this._isInitialized=!1,gt.CorrelationContextManager.disable(),this._isAutoCorrelating=!1},e.alreadyAutoCollectedFlag="_appInsightsAutoCollected",e}();Cf.exports=S_});var Tf=h((nw,bf)=>{"use strict";var Ef=xt(),k_=function(){function e(){}return e.parse=function(t){if(!t)return{};var r=t.split(e._FIELDS_SEPARATOR),n=r.reduce(function(s,a){var o=a.split(e._FIELD_KEY_VALUE_SEPARATOR);if(o.length===2){var u=o[0].toLowerCase(),c=o[1];s[u]=c}return s},{});if(Object.keys(n).length>0){if(n.endpointsuffix){var i=n.location?n.location+".":"";n.ingestionendpoint=n.ingestionendpoint||"https://"+i+"dc."+n.endpointsuffix,n.liveendpoint=n.liveendpoint||"https://"+i+"live."+n.endpointsuffix}n.ingestionendpoint=n.ingestionendpoint||Ef.DEFAULT_BREEZE_ENDPOINT,n.liveendpoint=n.liveendpoint||Ef.DEFAULT_LIVEMETRICS_ENDPOINT}return n},e._FIELDS_SEPARATOR=";",e._FIELD_KEY_VALUE_SEPARATOR="=",e}();bf.exports=k_});var Qi=h((iw,xf)=>{"use strict";var go=Bt(),wf=Tf(),P_=de(),If=xt(),A_=require("url"),D_=function(){function e(t){var r=this;this.endpointBase=If.DEFAULT_BREEZE_ENDPOINT;var n=process.env[e.ENV_connectionString],i=wf.parse(t),s=wf.parse(n),a=!i.instrumentationkey&&Object.keys(i).length>0?null:t;this.instrumentationKey=i.instrumentationkey||a||s.instrumentationkey||e._getInstrumentationKey(),e._validateInstrumentationKey(this.instrumentationKey)||P_.warn("An invalid instrumentation key was provided. There may be resulting telemetry loss",this.instrumentationKey),this.endpointUrl=(i.ingestionendpoint||s.ingestionendpoint||this.endpointBase)+"/v2/track",this.maxBatchSize=250,this.maxBatchIntervalMs=15e3,this.disableAppInsights=!1,this.samplingPercentage=100,this.correlationIdRetryIntervalMs=30*1e3,this.correlationHeaderExcludedDomains=["*.core.windows.net","*.core.chinacloudapi.cn","*.core.cloudapi.de","*.core.usgovcloudapi.net","*.core.microsoft.scloud","*.core.eaglex.ic.gov"],this.setCorrelationId=function(o){return r.correlationId=o},this.proxyHttpUrl=process.env[e.ENV_http_proxy]||void 0,this.proxyHttpsUrl=process.env[e.ENV_https_proxy]||void 0,this.httpAgent=void 0,this.httpsAgent=void 0,this.profileQueryEndpoint=i.ingestionendpoint||s.ingestionendpoint||process.env[e.ENV_profileQueryEndpoint]||this.endpointBase,this._quickPulseHost=i.liveendpoint||s.liveendpoint||process.env[e.ENV_quickPulseHost]||If.DEFAULT_LIVEMETRICS_HOST,this._quickPulseHost.match(/^https?:\/\//)&&(this._quickPulseHost=A_.parse(this._quickPulseHost).host)}return Object.defineProperty(e.prototype,"profileQueryEndpoint",{get:function(){return this._profileQueryEndpoint},set:function(t){go.cancelCorrelationIdQuery(this,this.setCorrelationId),this._profileQueryEndpoint=t,this.correlationId=go.correlationIdPrefix,go.queryCorrelationId(this,this.setCorrelationId)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"quickPulseHost",{get:function(){return this._quickPulseHost},set:function(t){this._quickPulseHost=t},enumerable:!0,configurable:!0}),e._getInstrumentationKey=function(){var t=process.env[e.ENV_iKey]||process.env[e.ENV_azurePrefix+e.ENV_iKey]||process.env[e.legacy_ENV_iKey]||process.env[e.ENV_azurePrefix+e.legacy_ENV_iKey];if(!t||t=="")throw new Error("Instrumentation key not found, pass the key in the config to this method or set the key in the environment variable APPINSIGHTS_INSTRUMENTATIONKEY before starting the server");return t},e._validateInstrumentationKey=function(t){var r="^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$",n=new RegExp(r);return n.test(t)},e.ENV_azurePrefix="APPSETTING_",e.ENV_iKey="APPINSIGHTS_INSTRUMENTATIONKEY",e.legacy_ENV_iKey="APPINSIGHTS_INSTRUMENTATION_KEY",e.ENV_profileQueryEndpoint="APPINSIGHTS_PROFILE_QUERY_ENDPOINT",e.ENV_quickPulseHost="APPINSIGHTS_QUICKPULSE_HOST",e.ENV_connectionString="APPLICATIONINSIGHTS_CONNECTION_STRING",e.ENV_nativeMetricsDisablers="APPLICATION_INSIGHTS_DISABLE_EXTENDED_METRIC",e.ENV_nativeMetricsDisableAll="APPLICATION_INSIGHTS_DISABLE_ALL_EXTENDED_METRICS",e.ENV_http_proxy="http_proxy",e.ENV_https_proxy="https_proxy",e}();xf.exports=D_});var Pf=h((yo,kf)=>{"use strict";var Sn=yo&&yo.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},mo=require("os"),er=Oe(),Sf=xt(),R_=Re(),O_=de(),q_=R_.w3cTraceId(),N_=function(){function e(){}return e.createQuickPulseEnvelope=function(t,r,n,i){var s=mo&&typeof mo.hostname=="function"&&mo.hostname()||"Unknown",a=i.tags&&i.keys&&i.keys.cloudRoleInstance&&i.tags[i.keys.cloudRoleInstance]||s,o={Documents:r.length>0?r:null,InstrumentationKey:n.instrumentationKey||"",Metrics:t.length>0?t:null,InvariantVersion:1,Timestamp:"/Date("+Date.now()+")/",Version:i.tags[i.keys.internalSdkVersion],StreamId:q_,MachineName:s,Instance:a};return o},e.createQuickPulseMetric=function(t){var r;return r={Name:t.name,Value:t.value,Weight:t.count||1},r},e.telemetryEnvelopeToQuickPulseDocument=function(t){switch(t.data.baseType){case er.TelemetryTypeString.Event:return e.createQuickPulseEventDocument(t);case er.TelemetryTypeString.Exception:return e.createQuickPulseExceptionDocument(t);case er.TelemetryTypeString.Trace:return e.createQuickPulseTraceDocument(t);case er.TelemetryTypeString.Dependency:return e.createQuickPulseDependencyDocument(t);case er.TelemetryTypeString.Request:return e.createQuickPulseRequestDocument(t)}return null},e.createQuickPulseEventDocument=function(t){var r=e.createQuickPulseDocument(t),n=t.data.baseData.name,i=Sn({},r,{Name:n});return i},e.createQuickPulseTraceDocument=function(t){var r=e.createQuickPulseDocument(t),n=t.data.baseData.severityLevel||0,i=Sn({},r,{Message:t.data.baseData.message,SeverityLevel:er.SeverityLevel[n]});return i},e.createQuickPulseExceptionDocument=function(t){var r=e.createQuickPulseDocument(t),n=t.data.baseData.exceptions,i="",s="",a="";n&&n.length>0&&(n[0].parsedStack&&n[0].parsedStack.length>0?n[0].parsedStack.forEach(function(u){i+=u.assembly+`
`}):n[0].stack&&n[0].stack.length>0&&(i=n[0].stack),s=n[0].message,a=n[0].typeName);var o=Sn({},r,{Exception:i,ExceptionMessage:s,ExceptionType:a});return o},e.createQuickPulseRequestDocument=function(t){var r=e.createQuickPulseDocument(t),n=t.data.baseData,i=Sn({},r,{Name:n.name,Success:n.success,Duration:n.duration,ResponseCode:n.responseCode,OperationName:n.name});return i},e.createQuickPulseDependencyDocument=function(t){var r=e.createQuickPulseDocument(t),n=t.data.baseData,i=Sn({},r,{Name:n.name,Target:n.target,Success:n.success,Duration:n.duration,ResultCode:n.resultCode,CommandName:n.data,OperationName:r.OperationId,DependencyTypeName:n.type});return i},e.createQuickPulseDocument=function(t){var r,n,i,s;t.data.baseType?(n=Sf.TelemetryTypeStringToQuickPulseType[t.data.baseType],r=Sf.TelemetryTypeStringToQuickPulseDocumentType[t.data.baseType]):O_.warn("Document type invalid; not sending live metric document",t.data.baseType),i=t.tags[e.keys.operationId],s=e.aggregateProperties(t);var a={DocumentType:r,__type:n,OperationId:i,Version:"1.0",Properties:s};return a},e.aggregateProperties=function(t){var r=[],n=t.data.baseData.measurements||{};for(var i in n)if(n.hasOwnProperty(i)){var s=n[i],a={key:i,value:s};r.push(a)}var o=t.data.baseData.properties||{};for(var i in o)if(o.hasOwnProperty(i)){var s=o[i],a={key:i,value:s};r.push(a)}return r},e.keys=new er.ContextTagKeys,e}();kf.exports=N_});var Df=h((sw,Af)=>{"use strict";var L_=function(){return(Date.now()+621355968e5)*1e4};Af.exports={getTransmissionTime:L_}});var qf=h((aw,Of)=>{"use strict";var M_=require("https"),F_=Mr(),Rf=de(),H_=Df(),j_=Re(),_o={method:"POST",time:"x-ms-qps-transmission-time",subscribed:"x-ms-qps-subscribed"},U_=function(){function e(t){this._config=t,this._consecutiveErrors=0}return e.prototype.ping=function(t,r){this._submitData(t,r,"ping")},e.prototype.post=function(t,r){this._submitData([t],r,"post")},e.prototype._submitData=function(t,r,n){var i=this,s=JSON.stringify(t),a=(u={},u[F_.disableCollectionRequestOption]=!0,u.host=this._config.quickPulseHost,u.method=_o.method,u.path="/QuickPulseService.svc/"+n+"?ikey="+this._config.instrumentationKey,u.headers=(c={Expect:"100-continue"},c[_o.time]=H_.getTransmissionTime(),c["Content-Type"]="application/json",c["Content-Length"]=Buffer.byteLength(s),c),u);this._config.httpsAgent?a.agent=this._config.httpsAgent:a.agent=j_.tlsRestrictedAgent;var o=M_.request(a,function(l){var p=l.headers[_o.subscribed]==="true";i._consecutiveErrors=0,r(p,l)});o.on("error",function(l){i._consecutiveErrors++;var p="Transient error connecting to the Live Metrics endpoint. This packet will not appear in your Live Metrics Stream. Error:";i._consecutiveErrors%e.MAX_QPS_FAILURES_BEFORE_WARN===0?(p="Live Metrics endpoint could not be reached "+i._consecutiveErrors+" consecutive times. Most recent error:",Rf.warn(e.TAG,p,l)):Rf.info(e.TAG,p,l),r()}),o.write(s),o.end();var u,c},e.TAG="QuickPulseSender",e.MAX_QPS_FAILURES_BEFORE_WARN=25,e}();Of.exports=U_});var Lf=h((ow,Nf)=>{"use strict";var $_=de(),V_=Qi(),Co=Pf(),B_=qf(),G_=xt(),z_=In(),Q_=function(){function e(t,r){this._isCollectingData=!1,this._lastSuccessTime=Date.now(),this._lastSendSucceeded=!0,this._metrics={},this._documents=[],this._collectors=[],this.config=new V_(t),this.context=r||new z_,this._sender=new B_(this.config),this._isEnabled=!1}return e.prototype.addCollector=function(t){this._collectors.push(t)},e.prototype.trackMetric=function(t){this._addMetric(t)},e.prototype.addDocument=function(t){var r=Co.telemetryEnvelopeToQuickPulseDocument(t);r&&this._documents.push(r)},e.prototype.enable=function(t){t&&!this._isEnabled?(this._isEnabled=!0,this._goQuickPulse()):!t&&this._isEnabled&&(this._isEnabled=!1,clearTimeout(this._handle),this._handle=void 0)},e.prototype.enableCollectors=function(t){this._collectors.forEach(function(r){r.enable(t)})},e.prototype._addMetric=function(t){var r=t.value,n=t.count||1,i=G_.PerformanceToQuickPulseCounter[t.name];i&&(this._metrics[i]?(this._metrics[i].Value=(this._metrics[i].Value*this._metrics[i].Weight+r*n)/(this._metrics[i].Weight+n),this._metrics[i].Weight+=n):(this._metrics[i]=Co.createQuickPulseMetric(t),this._metrics[i].Name=i,this._metrics[i].Weight=1))},e.prototype._resetQuickPulseBuffer=function(){delete this._metrics,this._metrics={},this._documents.length=0},e.prototype._goQuickPulse=function(){var t=this,r=Object.keys(this._metrics).map(function(s){return t._metrics[s]}),n=Co.createQuickPulseEnvelope(r,this._documents.slice(),this.config,this.context);this._resetQuickPulseBuffer(),this._isCollectingData?this._post(n):this._ping(n);var i=this._isCollectingData?e.POST_INTERVAL:e.PING_INTERVAL;this._isCollectingData&&Date.now()-this._lastSuccessTime>=e.MAX_POST_WAIT_TIME&&!this._lastSendSucceeded?(this._isCollectingData=!1,i=e.FALLBACK_INTERVAL):!this._isCollectingData&&Date.now()-this._lastSuccessTime>=e.MAX_PING_WAIT_TIME&&!this._lastSendSucceeded&&(i=e.FALLBACK_INTERVAL),this._lastSendSucceeded=null,this._handle=setTimeout(this._goQuickPulse.bind(this),i),this._handle.unref()},e.prototype._ping=function(t){this._sender.ping(t,this._quickPulseDone.bind(this))},e.prototype._post=function(t){this._sender.post(t,this._quickPulseDone.bind(this))},e.prototype._quickPulseDone=function(t,r){t!=null?(this._isCollectingData!==t&&($_.info("Live Metrics sending data",t),this.enableCollectors(t)),this._isCollectingData=t,r&&r.statusCode<300&&r.statusCode>=200?(this._lastSuccessTime=Date.now(),this._lastSendSucceeded=!0):this._lastSendSucceeded=!1):this._lastSendSucceeded=!1},e.MAX_POST_WAIT_TIME=2e4,e.MAX_PING_WAIT_TIME=6e4,e.FALLBACK_INTERVAL=6e4,e.PING_INTERVAL=5e3,e.POST_INTERVAL=1e3,e}();Nf.exports=Q_});var Ff=h(Pn=>{"use strict";var W_=Pn&&Pn.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e};Object.defineProperty(Pn,"__esModule",{value:!0});var Mf=Qi(),kn=In(),X_=de(),K_=function(){function e(t){this._disabledMetrics={},e.INSTANCE&&e.INSTANCE.dispose(),e.INSTANCE=this,this._client=t}return e.isNodeVersionCompatible=function(){var t=process.versions.node.split(".");return parseInt(t[0])>=6},e.prototype.enable=function(t,r,n){var i=this;if(r===void 0&&(r={}),n===void 0&&(n=6e4),!!e.isNodeVersionCompatible()){if(e._metricsAvailable==null&&t&&!this._isInitialized)try{var s=require("applicationinsights-native-metrics");e._emitter=new s,e._metricsAvailable=!0,X_.info("Native metrics module successfully loaded!")}catch{e._metricsAvailable=!1;return}this._isEnabled=t,this._disabledMetrics=r,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),this._isEnabled&&e._emitter?(e._emitter.enable(!0,n),this._handle=setInterval(function(){return i._trackNativeMetrics()},n),this._handle.unref()):e._emitter&&(e._emitter.enable(!1),this._handle&&(clearInterval(this._handle),this._handle=void 0))}},e.prototype.dispose=function(){this.enable(!1)},e.parseEnabled=function(t){var r=process.env[Mf.ENV_nativeMetricsDisableAll],n=process.env[Mf.ENV_nativeMetricsDisablers];if(r)return{isEnabled:!1,disabledMetrics:{}};if(n){var i=n.split(","),s={};if(i.length>0)for(var a=0,o=i;a<o.length;a++){var u=o[a];s[u]=!0}return typeof t=="object"?{isEnabled:!0,disabledMetrics:W_({},t,s)}:{isEnabled:t,disabledMetrics:s}}return typeof t=="boolean"?{isEnabled:t,disabledMetrics:{}}:{isEnabled:!0,disabledMetrics:t}},e.prototype._trackNativeMetrics=function(){var t=!0;typeof this._isEnabled!="object"&&(t=this._isEnabled),t&&(this._trackGarbageCollection(),this._trackEventLoop(),this._trackHeapUsage())},e.prototype._trackGarbageCollection=function(){if(!this._disabledMetrics.gc){var t=e._emitter.getGCData();for(var r in t){var n=t[r].metrics,i=r+" Garbage Collection Duration",s=Math.sqrt(n.sumSquares/n.count-Math.pow(n.total/n.count,2))||0;this._client.trackMetric({name:i,value:n.total,count:n.count,max:n.max,min:n.min,stdDev:s,tagOverrides:(a={},a[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+kn.sdkVersion,a)})}var a}},e.prototype._trackEventLoop=function(){if(!this._disabledMetrics.loop){var t=e._emitter.getLoopData(),r=t.loopUsage;if(r.count!=0){var n="Event Loop CPU Time",i=Math.sqrt(r.sumSquares/r.count-Math.pow(r.total/r.count,2))||0;this._client.trackMetric({name:n,value:r.total,count:r.count,min:r.min,max:r.max,stdDev:i,tagOverrides:(s={},s[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+kn.sdkVersion,s)});var s}}},e.prototype._trackHeapUsage=function(){if(!this._disabledMetrics.heap){var t=process.memoryUsage(),r=t.heapUsed,n=t.heapTotal,i=t.rss;this._client.trackMetric({name:"Memory Usage (Heap)",value:r,count:1,tagOverrides:(s={},s[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+kn.sdkVersion,s)}),this._client.trackMetric({name:"Memory Total (Heap)",value:n,count:1,tagOverrides:(a={},a[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+kn.sdkVersion,a)}),this._client.trackMetric({name:"Memory Usage (Non-Heap)",value:i-n,count:1,tagOverrides:(o={},o[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+kn.sdkVersion,o)});var s,a,o}},e}();Pn.AutoCollectNativePerformance=K_});var Uf=h((cw,jf)=>{"use strict";var Hf=de(),J_=function(){function e(t,r,n,i){this._buffer=[],this._lastSend=0,this._isDisabled=t,this._getBatchSize=r,this._getBatchIntervalMs=n,this._sender=i}return e.prototype.setUseDiskRetryCaching=function(t,r,n){this._sender.setDiskRetryMode(t,r,n)},e.prototype.send=function(t){var r=this;if(!this._isDisabled()){if(!t){Hf.warn("Cannot send null/undefined telemetry");return}var n=this._stringify(t);if(typeof n=="string"){if(this._buffer.push(n),this._buffer.length>=this._getBatchSize()){this.triggerSend(!1);return}!this._timeoutHandle&&this._buffer.length>0&&(this._timeoutHandle=setTimeout(function(){r._timeoutHandle=null,r.triggerSend(!1)},this._getBatchIntervalMs()))}}},e.prototype.triggerSend=function(t,r){var n=this._buffer.length<1;if(!n){var i=this._buffer.join(`
`);t?(this._sender.saveOnCrash(i),typeof r=="function"&&r("data saved on crash")):this._sender.send(Buffer.from?Buffer.from(i):new Buffer(i),r)}this._lastSend=+new Date,this._buffer.length=0,clearTimeout(this._timeoutHandle),this._timeoutHandle=null,n&&typeof r=="function"&&r("no data to send")},e.prototype._stringify=function(t){try{return JSON.stringify(t)}catch(r){Hf.warn("Failed to serialize payload",r,t)}},e}();jf.exports=J_});var $f=h(Eo=>{"use strict";Object.defineProperty(Eo,"__esModule",{value:!0});function Y_(e,t){process.env.WEBSITE_SITE_NAME&&(e.tags[t.keys.cloudRole]=process.env.WEBSITE_SITE_NAME)}Eo.azureRoleEnvironmentTelemetryProcessor=Y_});var Gf=h(Wi=>{"use strict";Object.defineProperty(Wi,"__esModule",{value:!0});var Vf=Oe();function Z_(e,t){var r=e.sampleRate,n=!1;return r==null||r>=100||e.data&&Vf.TelemetryType.Metric===Vf.baseTypeToTelemetryType(e.data.baseType)?!0:(t.correlationContext&&t.correlationContext.operation?n=Bf(t.correlationContext.operation.id)<r:n=Math.random()*100<r,n)}Wi.samplingTelemetryProcessor=Z_;function Bf(e){var t=-2147483648,r=2147483647,n=5381;if(!e)return 0;for(;e.length<8;)e=e+e;for(var i=0;i<e.length;i++)n=((n<<5)+n|0)+e.charCodeAt(i)|0;return n=n<=t?r:Math.abs(n),n/r*100}Wi.getSamplingHashCode=Bf});var zf=h(wo=>{"use strict";Object.defineProperty(wo,"__esModule",{value:!0});var bo=Gi(),To=Oe();function eC(e,t){switch(t&&t.addDocument(e),e.data.baseType){case To.TelemetryTypeString.Exception:bo.countException();break;case To.TelemetryTypeString.Request:var r=e.data.baseData;bo.countRequest(r.duration,r.success);break;case To.TelemetryTypeString.Dependency:var n=e.data.baseData;bo.countDependency(n.duration,n.success);break}return!0}wo.performanceMetricsTelemetryProcessor=eC});var Qf=h(Xi=>{"use strict";function Io(e){for(var t in e)Xi.hasOwnProperty(t)||(Xi[t]=e[t])}Object.defineProperty(Xi,"__esModule",{value:!0});Io($f());Io(Gf());Io(zf())});var Xf=h((hw,Wf)=>{"use strict";var Ie=require("fs"),Ki=require("os"),mt=require("path"),tC=require("zlib"),Fr=require("child_process"),Ee=de(),rC=Mr(),nC=Re(),iC=function(){function e(t,r,n){if(this._config=t,this._onSuccess=r,this._onError=n,this._enableDiskRetryMode=!1,this._resendInterval=e.WAIT_BETWEEN_RESEND,this._maxBytesOnDisk=e.MAX_BYTES_ON_DISK,this._numConsecutiveFailures=0,this._resendTimer=null,!e.OS_PROVIDES_FILE_PROTECTION)if(e.USE_ICACLS){try{e.OS_PROVIDES_FILE_PROTECTION=Ie.existsSync(e.ICACLS_PATH)}catch{}e.OS_PROVIDES_FILE_PROTECTION||Ee.warn(e.TAG,"Could not find ICACLS in expected location! This is necessary to use disk retry mode on Windows.")}else e.OS_PROVIDES_FILE_PROTECTION=!0}return e.prototype.setDiskRetryMode=function(t,r,n){this._enableDiskRetryMode=e.OS_PROVIDES_FILE_PROTECTION&&t,typeof r=="number"&&r>=0&&(this._resendInterval=Math.floor(r)),typeof n=="number"&&n>=0&&(this._maxBytesOnDisk=Math.floor(n)),t&&!e.OS_PROVIDES_FILE_PROTECTION&&(this._enableDiskRetryMode=!1,Ee.warn(e.TAG,"Ignoring request to enable disk retry mode. Sufficient file protection capabilities were not detected."))},e.prototype.send=function(t,r){var n=this,i=this._config.endpointUrl,s={method:"POST",withCredentials:!1,headers:{"Content-Type":"application/x-json-stream"}};tC.gzip(t,function(a,o){var u=o;a?(Ee.warn(a),u=t,s.headers["Content-Length"]=t.length.toString()):(s.headers["Content-Encoding"]="gzip",s.headers["Content-Length"]=o.length),Ee.info(e.TAG,s),s[rC.disableCollectionRequestOption]=!0;var c=function(p){p.setEncoding("utf-8");var f="";p.on("data",function(d){f+=d}),p.on("end",function(){n._numConsecutiveFailures=0,Ee.info(e.TAG,f),typeof n._onSuccess=="function"&&n._onSuccess(f),typeof r=="function"&&r(f),n._enableDiskRetryMode&&(p.statusCode===200?n._resendTimer||(n._resendTimer=setTimeout(function(){n._resendTimer=null,n._sendFirstFileOnDisk()},n._resendInterval),n._resendTimer.unref()):(p.statusCode===408||p.statusCode===429||p.statusCode===439||p.statusCode===500||p.statusCode===503)&&n._storeToDisk(t))})},l=nC.makeRequest(n._config,i,s,c);l.on("error",function(p){if(n._numConsecutiveFailures++,!n._enableDiskRetryMode||n._numConsecutiveFailures>0&&n._numConsecutiveFailures%e.MAX_CONNECTION_FAILURES_BEFORE_WARN===0){var f="Ingestion endpoint could not be reached. This batch of telemetry items has been lost. Use Disk Retry Caching to enable resending of failed telemetry. Error:";n._enableDiskRetryMode&&(f="Ingestion endpoint could not be reached "+n._numConsecutiveFailures+" consecutive times. There may be resulting telemetry loss. Most recent error:"),Ee.warn(e.TAG,f,p)}else{var f="Transient failure to reach ingestion endpoint. This batch of telemetry items will be retried. Error:";Ee.info(e.TAG,f,p)}if(n._onErrorHelper(p),typeof r=="function"){var d="error sending telemetry";p&&typeof p.toString=="function"&&(d=p.toString()),r(d)}n._enableDiskRetryMode&&n._storeToDisk(t)}),l.write(u),l.end()})},e.prototype.saveOnCrash=function(t){this._enableDiskRetryMode&&this._storeToDiskSync(t)},e.prototype._runICACLS=function(t,r){var n=Fr.spawn(e.ICACLS_PATH,t,{windowsHide:!0});n.on("error",function(i){return r(i)}),n.on("close",function(i,s){return r(i===0?null:new Error("Setting ACL restrictions did not succeed (ICACLS returned code "+i+")"))})},e.prototype._runICACLSSync=function(t){if(Fr.spawnSync){var r=Fr.spawnSync(e.ICACLS_PATH,t,{windowsHide:!0});if(r.error)throw r.error;if(r.status!==0)throw new Error("Setting ACL restrictions did not succeed (ICACLS returned code "+r.status+")")}else throw new Error("Could not synchronously call ICACLS under current version of Node.js")},e.prototype._getACLIdentity=function(t){if(e.ACL_IDENTITY)return t(null,e.ACL_IDENTITY);var r=Fr.spawn(e.POWERSHELL_PATH,["-Command","[System.Security.Principal.WindowsIdentity]::GetCurrent().Name"],{windowsHide:!0,stdio:["ignore","pipe","pipe"]}),n="";r.stdout.on("data",function(i){return n+=i}),r.on("error",function(i){return t(i,null)}),r.on("close",function(i,s){return e.ACL_IDENTITY=n&&n.trim(),t(i===0?null:new Error("Getting ACL identity did not succeed (PS returned code "+i+")"),e.ACL_IDENTITY)})},e.prototype._getACLIdentitySync=function(){if(e.ACL_IDENTITY)return e.ACL_IDENTITY;if(Fr.spawnSync){var t=Fr.spawnSync(e.POWERSHELL_PATH,["-Command","[System.Security.Principal.WindowsIdentity]::GetCurrent().Name"],{windowsHide:!0,stdio:["ignore","pipe","pipe"]});if(t.error)throw t.error;if(t.status!==0)throw new Error("Getting ACL identity did not succeed (PS returned code "+t.status+")");return e.ACL_IDENTITY=t.stdout&&t.stdout.toString().trim(),e.ACL_IDENTITY}else throw new Error("Could not synchronously get ACL identity under current version of Node.js")},e.prototype._getACLArguments=function(t,r){return[t,"/grant","*S-1-5-32-544:(OI)(CI)F","/grant",r+":(OI)(CI)F","/inheritance:r"]},e.prototype._applyACLRules=function(t,r){var n=this;if(!e.USE_ICACLS)return r(null);if(e.ACLED_DIRECTORIES[t]===void 0)e.ACLED_DIRECTORIES[t]=!1,this._getACLIdentity(function(i,s){if(i)return e.ACLED_DIRECTORIES[t]=!1,r(i);n._runICACLS(n._getACLArguments(t,s),function(a){return e.ACLED_DIRECTORIES[t]=!a,r(a)})});else return r(e.ACLED_DIRECTORIES[t]?null:new Error("Setting ACL restrictions did not succeed (cached result)"))},e.prototype._applyACLRulesSync=function(t){if(e.USE_ICACLS){if(e.ACLED_DIRECTORIES[t]===void 0){this._runICACLSSync(this._getACLArguments(t,this._getACLIdentitySync())),e.ACLED_DIRECTORIES[t]=!0;return}else if(!e.ACLED_DIRECTORIES[t])throw new Error("Setting ACL restrictions did not succeed (cached result)")}},e.prototype._confirmDirExists=function(t,r){var n=this;Ie.lstat(t,function(i,s){i&&i.code==="ENOENT"?Ie.mkdir(t,function(a){a&&a.code!=="EEXIST"?r(a):n._applyACLRules(t,r)}):!i&&s.isDirectory()?n._applyACLRules(t,r):r(i||new Error("Path existed but was not a directory"))})},e.prototype._getShallowDirectorySize=function(t,r){Ie.readdir(t,function(n,i){if(n)return r(n,-1);var s=null,a=0,o=0;if(i.length===0){r(null,0);return}for(var u=0;u<i.length;u++)Ie.stat(mt.join(t,i[u]),function(c,l){o++,c?s=c:l.isFile()&&(a+=l.size),o===i.length&&(s?r(s,-1):r(s,a))})})},e.prototype._getShallowDirectorySizeSync=function(t){for(var r=Ie.readdirSync(t),n=0,i=0;i<r.length;i++)n+=Ie.statSync(mt.join(t,r[i])).size;return n},e.prototype._storeToDisk=function(t){var r=this,n=mt.join(Ki.tmpdir(),e.TEMPDIR_PREFIX+this._config.instrumentationKey);Ee.info(e.TAG,"Checking existence of data storage directory: "+n),this._confirmDirExists(n,function(i){if(i){Ee.warn(e.TAG,"Error while checking/creating directory: "+(i&&i.message)),r._onErrorHelper(i);return}r._getShallowDirectorySize(n,function(s,a){if(s||a<0){Ee.warn(e.TAG,"Error while checking directory size: "+(s&&s.message)),r._onErrorHelper(s);return}else if(a>r._maxBytesOnDisk){Ee.warn(e.TAG,"Not saving data due to max size limit being met. Directory size in bytes is: "+a);return}var o=new Date().getTime()+".ai.json",u=mt.join(n,o);Ee.info(e.TAG,"saving data to disk at: "+u),Ie.writeFile(u,t,{mode:384},function(c){return r._onErrorHelper(c)})})})},e.prototype._storeToDiskSync=function(t){var r=mt.join(Ki.tmpdir(),e.TEMPDIR_PREFIX+this._config.instrumentationKey);try{Ee.info(e.TAG,"Checking existence of data storage directory: "+r),Ie.existsSync(r)||Ie.mkdirSync(r),this._applyACLRulesSync(r);var n=this._getShallowDirectorySizeSync(r);if(n>this._maxBytesOnDisk){Ee.info(e.TAG,"Not saving data due to max size limit being met. Directory size in bytes is: "+n);return}var i=new Date().getTime()+".ai.json",s=mt.join(r,i);Ee.info(e.TAG,"saving data before crash to disk at: "+s),Ie.writeFileSync(s,t,{mode:384})}catch(a){Ee.warn(e.TAG,"Error while saving data to disk: "+(a&&a.message)),this._onErrorHelper(a)}},e.prototype._sendFirstFileOnDisk=function(){var t=this,r=mt.join(Ki.tmpdir(),e.TEMPDIR_PREFIX+this._config.instrumentationKey);Ie.exists(r,function(n){n&&Ie.readdir(r,function(i,s){if(i)t._onErrorHelper(i);else if(s=s.filter(function(u){return mt.basename(u).indexOf(".ai.json")>-1}),s.length>0){var a=s[0],o=mt.join(r,a);Ie.readFile(o,function(u,c){u?t._onErrorHelper(u):Ie.unlink(o,function(l){l?t._onErrorHelper(l):t.send(c)})})}})})},e.prototype._onErrorHelper=function(t){typeof this._onError=="function"&&this._onError(t)},e.TAG="Sender",e.ICACLS_PATH=process.env.systemdrive+"/windows/system32/icacls.exe",e.POWERSHELL_PATH=process.env.systemdrive+"/windows/system32/windowspowershell/v1.0/powershell.exe",e.ACLED_DIRECTORIES={},e.ACL_IDENTITY=null,e.WAIT_BETWEEN_RESEND=60*1e3,e.MAX_BYTES_ON_DISK=50*1e3*1e3,e.MAX_CONNECTION_FAILURES_BEFORE_WARN=5,e.TEMPDIR_PREFIX="appInsights-node",e.OS_PROVIDES_FILE_PROTECTION=!1,e.USE_ICACLS=Ki.type()==="Windows_NT",e}();Wf.exports=iC});var Yf=h((vw,Jf)=>{"use strict";var S=Oe(),je=Re(),sC=Ft(),aC=function(){function e(){}return e.createEnvelope=function(t,r,n,i,s){var a=null;switch(r){case S.TelemetryType.Trace:a=e.createTraceData(t);break;case S.TelemetryType.Dependency:a=e.createDependencyData(t);break;case S.TelemetryType.Event:a=e.createEventData(t);break;case S.TelemetryType.Exception:a=e.createExceptionData(t);break;case S.TelemetryType.Request:a=e.createRequestData(t);break;case S.TelemetryType.Metric:a=e.createMetricData(t);break;case S.TelemetryType.Availability:a=e.createAvailabilityData(t);break;case S.TelemetryType.PageView:a=e.createPageViewData(t);break}if(n&&S.domainSupportsProperties(a.baseData)){if(a&&a.baseData)if(!a.baseData.properties)a.baseData.properties=n;else for(var o in n)a.baseData.properties[o]||(a.baseData.properties[o]=n[o]);a.baseData.properties=je.validateStringMap(a.baseData.properties)}var u=s&&s.instrumentationKey||"",c=new S.Envelope;return c.data=a,c.iKey=u,c.name="Microsoft.ApplicationInsights."+u.replace(/-/g,"")+"."+a.baseType.substr(0,a.baseType.length-4),c.tags=this.getTags(i,t.tagOverrides),c.time=new Date().toISOString(),c.ver=1,c.sampleRate=s?s.samplingPercentage:100,r===S.TelemetryType.Metric&&(c.sampleRate=100),c},e.createTraceData=function(t){var r=new S.MessageData;r.message=t.message,r.properties=t.properties,isNaN(t.severity)?r.severityLevel=S.SeverityLevel.Information:r.severityLevel=t.severity;var n=new S.Data;return n.baseType=S.telemetryTypeToBaseType(S.TelemetryType.Trace),n.baseData=r,n},e.createDependencyData=function(t){var r=new S.RemoteDependencyData;typeof t.name=="string"&&(r.name=t.name.length>1024?t.name.slice(0,1021)+"...":t.name),r.data=t.data,r.target=t.target,r.duration=je.msToTimeSpan(t.duration),r.success=t.success,r.type=t.dependencyTypeName,r.properties=t.properties,r.resultCode=t.resultCode?t.resultCode+"":"",t.id?r.id=t.id:r.id=je.w3cTraceId();var n=new S.Data;return n.baseType=S.telemetryTypeToBaseType(S.TelemetryType.Dependency),n.baseData=r,n},e.createEventData=function(t){var r=new S.EventData;r.name=t.name,r.properties=t.properties,r.measurements=t.measurements;var n=new S.Data;return n.baseType=S.telemetryTypeToBaseType(S.TelemetryType.Event),n.baseData=r,n},e.createExceptionData=function(t){var r=new S.ExceptionData;r.properties=t.properties,isNaN(t.severity)?r.severityLevel=S.SeverityLevel.Error:r.severityLevel=t.severity,r.measurements=t.measurements,r.exceptions=[];var n=t.exception.stack,i=new S.ExceptionDetails;i.message=t.exception.message,i.typeName=t.exception.name,i.parsedStack=this.parseStack(n),i.hasFullStack=je.isArray(i.parsedStack)&&i.parsedStack.length>0,r.exceptions.push(i);var s=new S.Data;return s.baseType=S.telemetryTypeToBaseType(S.TelemetryType.Exception),s.baseData=r,s},e.createRequestData=function(t){var r=new S.RequestData;t.id?r.id=t.id:r.id=je.w3cTraceId(),r.name=t.name,r.url=t.url,r.source=t.source,r.duration=je.msToTimeSpan(t.duration),r.responseCode=t.resultCode?t.resultCode+"":"",r.success=t.success,r.properties=t.properties;var n=new S.Data;return n.baseType=S.telemetryTypeToBaseType(S.TelemetryType.Request),n.baseData=r,n},e.createMetricData=function(t){var r=new S.MetricData;r.metrics=[];var n=new S.DataPoint;n.count=isNaN(t.count)?1:t.count,n.kind=S.DataPointType.Aggregation,n.max=isNaN(t.max)?t.value:t.max,n.min=isNaN(t.min)?t.value:t.min,n.name=t.name,n.stdDev=isNaN(t.stdDev)?0:t.stdDev,n.value=t.value,r.metrics.push(n),r.properties=t.properties;var i=new S.Data;return i.baseType=S.telemetryTypeToBaseType(S.TelemetryType.Metric),i.baseData=r,i},e.createAvailabilityData=function(t){var r=new S.AvailabilityData;t.id?r.id=t.id:r.id=je.w3cTraceId(),r.name=t.name,r.duration=je.msToTimeSpan(t.duration),r.success=t.success,r.runLocation=t.runLocation,r.message=t.message,r.measurements=t.measurements,r.properties=t.properties;var n=new S.Data;return n.baseType=S.telemetryTypeToBaseType(S.TelemetryType.Availability),n.baseData=r,n},e.createPageViewData=function(t){var r=new S.PageViewData;r.name=t.name,r.duration=je.msToTimeSpan(t.duration),r.url=t.url,r.measurements=t.measurements,r.properties=t.properties;var n=new S.Data;return n.baseType=S.telemetryTypeToBaseType(S.TelemetryType.PageView),n.baseData=r,n},e.getTags=function(t,r){var n=sC.CorrelationContextManager.getCurrentContext(),i={};if(t&&t.tags)for(var s in t.tags)i[s]=t.tags[s];if(r)for(var s in r)i[s]=r[s];return n&&(i[t.keys.operationId]=i[t.keys.operationId]||n.operation.id,i[t.keys.operationName]=i[t.keys.operationName]||n.operation.name,i[t.keys.operationParentId]=i[t.keys.operationParentId]||n.operation.parentId),i},e.parseStack=function(t){var r=void 0;if(typeof t=="string"){var n=t.split(`
`);r=[];for(var i=0,s=0,a=0;a<=n.length;a++){var o=n[a];if(Kf.regex.test(o)){var u=new Kf(n[a],i++);s+=u.sizeInBytes,r.push(u)}}var c=32*1024;if(s>c)for(var l=0,p=r.length-1,f=0,d=l,g=p;l<p;){var b=r[l].sizeInBytes,x=r[p].sizeInBytes;if(f+=b+x,f>c){var A=g-d+1;r.splice(d,A);break}d=l,g=p,l++,p--}}return r},e}(),Kf=function(){function e(t,r){this.sizeInBytes=0,this.level=r,this.method="<no_method>",this.assembly=je.trim(t);var n=t.match(e.regex);n&&n.length>=5&&(this.method=je.trim(n[2])||this.method,this.fileName=je.trim(n[4])||"<no_filename>",this.line=parseInt(n[5])||0),this.sizeInBytes+=this.method.length,this.sizeInBytes+=this.fileName.length,this.sizeInBytes+=this.assembly.length,this.sizeInBytes+=e.baseSize,this.sizeInBytes+=this.level.toString().length,this.sizeInBytes+=this.line.toString().length}return e.regex=/^(\s+at)?(.*?)(\@|\s\(|\s)([^\(\n]+):(\d+):(\d+)(\)?)$/,e.baseSize=58,e}();Jf.exports=aC});var rd=h((gw,td)=>{"use strict";var oC=require("url"),uC=Qi(),cC=In(),yt=Oe(),lC=Uf(),xo=Qf(),Zf=Ft(),pC=Xf(),fC=Re(),ed=de(),dC=Yf(),hC=function(){function e(t){this._telemetryProcessors=[],this._enableAzureProperties=!1;var r=new uC(t);this.config=r,this.context=new cC,this.commonProperties={};var n=new pC(this.config);this.channel=new lC(function(){return r.disableAppInsights},function(){return r.maxBatchSize},function(){return r.maxBatchIntervalMs},n)}return e.prototype.trackAvailability=function(t){this.track(t,yt.TelemetryType.Availability)},e.prototype.trackPageView=function(t){this.track(t,yt.TelemetryType.PageView)},e.prototype.trackTrace=function(t){this.track(t,yt.TelemetryType.Trace)},e.prototype.trackMetric=function(t){this.track(t,yt.TelemetryType.Metric)},e.prototype.trackException=function(t){t&&t.exception&&!fC.isError(t.exception)&&(t.exception=new Error(t.exception.toString())),this.track(t,yt.TelemetryType.Exception)},e.prototype.trackEvent=function(t){this.track(t,yt.TelemetryType.Event)},e.prototype.trackRequest=function(t){this.track(t,yt.TelemetryType.Request)},e.prototype.trackDependency=function(t){t&&!t.target&&t.data&&(t.target=oC.parse(t.data).host),this.track(t,yt.TelemetryType.Dependency)},e.prototype.flush=function(t){this.channel.triggerSend(t?!!t.isAppCrashing:!1,t?t.callback:void 0)},e.prototype.track=function(t,r){if(t&&yt.telemetryTypeToBaseType(r)){var n=dC.createEnvelope(t,r,this.commonProperties,this.context,this.config);t.time&&(n.time=t.time.toISOString()),this._enableAzureProperties&&xo.azureRoleEnvironmentTelemetryProcessor(n,this.context);var i=this.runTelemetryProcessors(n,t.contextObjects);i=i&&xo.samplingTelemetryProcessor(n,{correlationContext:Zf.CorrelationContextManager.getCurrentContext()}),i&&(xo.performanceMetricsTelemetryProcessor(n,this.quickPulseClient),this.channel.send(n))}else ed.warn("track() requires telemetry object and telemetryType to be specified.")},e.prototype.setAutoPopulateAzureProperties=function(t){this._enableAzureProperties=t},e.prototype.addTelemetryProcessor=function(t){this._telemetryProcessors.push(t)},e.prototype.clearTelemetryProcessors=function(){this._telemetryProcessors=[]},e.prototype.runTelemetryProcessors=function(t,r){var n=!0,i=this._telemetryProcessors.length;if(i===0)return n;r=r||{},r.correlationContext=Zf.CorrelationContextManager.getCurrentContext();for(var s=0;s<i;++s)try{var a=this._telemetryProcessors[s];if(a&&a.apply(null,[t,r])===!1){n=!1;break}}catch(o){n=!0,ed.warn("One of telemetry processors failed, telemetry item will be sent.",o,t)}return n},e}();td.exports=hC});var sd=h((So,id)=>{"use strict";var vC=So&&So.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),gC=rd(),nd=vo(),mC=Mr(),Ji=de(),yC=function(e){vC(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.trackNodeHttpRequestSync=function(r){r&&r.request&&r.response&&r.duration?nd.trackRequestSync(this,r):Ji.warn("trackNodeHttpRequestSync requires NodeHttpRequestTelemetry object with request, response and duration specified.")},t.prototype.trackNodeHttpRequest=function(r){(r.duration||r.error)&&Ji.warn("trackNodeHttpRequest will ignore supplied duration and error parameters. These values are collected from the request and response objects."),r&&r.request&&r.response?nd.trackRequest(this,r):Ji.warn("trackNodeHttpRequest requires NodeHttpRequestTelemetry object with request and response specified.")},t.prototype.trackNodeHttpDependency=function(r){r&&r.request?mC.trackRequest(this,r):Ji.warn("trackNodeHttpDependency requires NodeHttpDependencyTelemetry object with request specified.")},t}(gC);id.exports=yC});var od=h(ad=>{"use strict";Object.defineProperty(ad,"__esModule",{value:!0})});var Sd=h(I=>{"use strict";Object.defineProperty(I,"__esModule",{value:!0});var ko=Ft(),_C=jp(),CC=$p(),cd=Gi(),EC=vf(),bC=Mr(),TC=vo(),ld=Bt(),An=de(),wC=Lf(),pd=Ff();I.TelemetryClient=sd();I.Contracts=Oe();I.azureFunctionsTypes=od();var fd;(function(e){e[e.AI=0]="AI",e[e.AI_AND_W3C=1]="AI_AND_W3C"})(fd=I.DistributedTracingModes||(I.DistributedTracingModes={}));var dd=!0,hd=!1,vd=!0,gd=!0,md=!1,yd=!0,_d=!0,Cd=!0,Po=!0,Ed,Yi=!1,bd=!0,Td,wd=void 0,Id=void 0,Dn,Rn,On,qn,Hr,tr,Nn,_t=!1,ud;function IC(e){return I.defaultClient?An.info("The default client is already setup"):(I.defaultClient=new I.TelemetryClient(e),Dn=new _C(I.defaultClient),Rn=new CC(I.defaultClient),On=new cd(I.defaultClient),qn=new EC(I.defaultClient),tr=new TC(I.defaultClient),Nn=new bC(I.defaultClient),Hr||(Hr=new pd.AutoCollectNativePerformance(I.defaultClient))),I.defaultClient&&I.defaultClient.channel&&I.defaultClient.channel.setUseDiskRetryCaching(Cd,wd,Id),Ao}I.setup=IC;function xd(){return I.defaultClient?(_t=!0,Dn.enable(dd,hd),Rn.enable(vd),On.enable(gd),qn.enable(md,I.defaultClient.config),Hr.enable(bd,Td),tr.useAutoCorrelation(Po,Ed),tr.enable(yd),Nn.enable(_d),I.liveMetricsClient&&Yi&&I.liveMetricsClient.enable(Yi)):An.warn("Start cannot be called before setup"),Ao}I.start=xd;function xC(){return Po?ko.CorrelationContextManager.getCurrentContext():null}I.getCorrelationContext=xC;function SC(e,t){return ko.CorrelationContextManager.startOperation(e,t)}I.startOperation=SC;function kC(e,t){return ko.CorrelationContextManager.wrapCallback(e,t)}I.wrapWithCorrelationContext=kC;var Ao=function(){function e(){}return e.setDistributedTracingMode=function(t){return ld.w3cEnabled=t===fd.AI_AND_W3C,e},e.setAutoCollectConsole=function(t,r){return r===void 0&&(r=!1),dd=t,hd=r,_t&&Dn.enable(t,r),e},e.setAutoCollectExceptions=function(t){return vd=t,_t&&Rn.enable(t),e},e.setAutoCollectPerformance=function(t,r){r===void 0&&(r=!0),gd=t;var n=pd.AutoCollectNativePerformance.parseEnabled(r);return bd=n.isEnabled,Td=n.disabledMetrics,_t&&(On.enable(t),Hr.enable(n.isEnabled,n.disabledMetrics)),e},e.setAutoCollectHeartbeat=function(t){return md=t,_t&&qn.enable(t,I.defaultClient.config),e},e.setAutoCollectRequests=function(t){return yd=t,_t&&tr.enable(t),e},e.setAutoCollectDependencies=function(t){return _d=t,_t&&Nn.enable(t),e},e.setAutoDependencyCorrelation=function(t,r){return Po=t,Ed=r,_t&&tr.useAutoCorrelation(t,r),e},e.setUseDiskRetryCaching=function(t,r,n){return Cd=t,wd=r,Id=n,I.defaultClient&&I.defaultClient.channel&&I.defaultClient.channel.setUseDiskRetryCaching(t,r,n),e},e.setInternalLogging=function(t,r){return t===void 0&&(t=!1),r===void 0&&(r=!0),An.enableDebug=t,An.disableWarnings=!r,e},e.setSendLiveMetrics=function(t){return t===void 0&&(t=!1),I.defaultClient?(!I.liveMetricsClient&&t?(I.liveMetricsClient=new wC(I.defaultClient.config.instrumentationKey),ud=new cd(I.liveMetricsClient,1e3,!0),I.liveMetricsClient.addCollector(ud),I.defaultClient.quickPulseClient=I.liveMetricsClient):I.liveMetricsClient&&I.liveMetricsClient.enable(t),Yi=t,e):(An.warn("Live metrics client cannot be setup without the default client"),e)},e.start=xd,e}();I.Configuration=Ao;function PC(){ld.w3cEnabled=!0,I.defaultClient=null,_t=!1,Dn&&Dn.dispose(),Rn&&Rn.dispose(),On&&On.dispose(),qn&&qn.dispose(),Hr&&Hr.dispose(),tr&&tr.dispose(),Nn&&Nn.dispose(),I.liveMetricsClient&&(I.liveMetricsClient.enable(!1),Yi=!1,I.liveMetricsClient=void 0)}I.dispose=PC});var Do=h((Zi,kd)=>{"use strict";Object.defineProperty(Zi,"__esModule",{value:!0});Zi.default=RC;var AC=DC(require("crypto"));function DC(e){return e&&e.__esModule?e:{default:e}}function RC(){return AC.default.randomBytes(16)}kd.exports=Zi.default});var es=h((Mn,Ad)=>{"use strict";Object.defineProperty(Mn,"__esModule",{value:!0});Mn.default=void 0;var Pd=[];for(Ln=0;Ln<256;++Ln)Pd[Ln]=(Ln+256).toString(16).substr(1);var Ln;function OC(e,t){var r=t||0,n=Pd;return[n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]]].join("")}var qC=OC;Mn.default=qC;Ad.exports=Mn.default});var qd=h((Fn,Od)=>{"use strict";Object.defineProperty(Fn,"__esModule",{value:!0});Fn.default=void 0;var NC=Rd(Do()),LC=Rd(es());function Rd(e){return e&&e.__esModule?e:{default:e}}var Dd,Ro,Oo=0,qo=0;function MC(e,t,r){var n=t&&r||0,i=t||[];e=e||{};var s=e.node||Dd,a=e.clockseq!==void 0?e.clockseq:Ro;if(s==null||a==null){var o=e.random||(e.rng||NC.default)();s==null&&(s=Dd=[o[0]|1,o[1],o[2],o[3],o[4],o[5]]),a==null&&(a=Ro=(o[6]<<8|o[7])&16383)}var u=e.msecs!==void 0?e.msecs:new Date().getTime(),c=e.nsecs!==void 0?e.nsecs:qo+1,l=u-Oo+(c-qo)/1e4;if(l<0&&e.clockseq===void 0&&(a=a+1&16383),(l<0||u>Oo)&&e.nsecs===void 0&&(c=0),c>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");Oo=u,qo=c,Ro=a,u+=122192928e5;var p=((u&268435455)*1e4+c)%4294967296;i[n++]=p>>>24&255,i[n++]=p>>>16&255,i[n++]=p>>>8&255,i[n++]=p&255;var f=u/4294967296*1e4&268435455;i[n++]=f>>>8&255,i[n++]=f&255,i[n++]=f>>>24&15|16,i[n++]=f>>>16&255,i[n++]=a>>>8|128,i[n++]=a&255;for(var d=0;d<6;++d)i[n+d]=s[d];return t||(0,LC.default)(i)}var FC=MC;Fn.default=FC;Od.exports=Fn.default});var No=h(rr=>{"use strict";Object.defineProperty(rr,"__esModule",{value:!0});rr.default=VC;rr.URL=rr.DNS=void 0;var HC=jC(es());function jC(e){return e&&e.__esModule?e:{default:e}}function UC(e){var t=[];return e.replace(/[a-fA-F0-9]{2}/g,function(r){t.push(parseInt(r,16))}),t}function $C(e){e=unescape(encodeURIComponent(e));for(var t=new Array(e.length),r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}var Nd="6ba7b810-9dad-11d1-80b4-00c04fd430c8";rr.DNS=Nd;var Ld="6ba7b811-9dad-11d1-80b4-00c04fd430c8";rr.URL=Ld;function VC(e,t,r){var n=function(i,s,a,o){var u=a&&o||0;if(typeof i=="string"&&(i=$C(i)),typeof s=="string"&&(s=UC(s)),!Array.isArray(i))throw TypeError("value must be an array of bytes");if(!Array.isArray(s)||s.length!==16)throw TypeError("namespace must be uuid string or an Array of 16 byte values");var c=r(s.concat(i));if(c[6]=c[6]&15|t,c[8]=c[8]&63|128,a)for(var l=0;l<16;++l)a[u+l]=c[l];return a||(0,HC.default)(c)};try{n.name=e}catch{}return n.DNS=Nd,n.URL=Ld,n}});var Fd=h((Hn,Md)=>{"use strict";Object.defineProperty(Hn,"__esModule",{value:!0});Hn.default=void 0;var BC=GC(require("crypto"));function GC(e){return e&&e.__esModule?e:{default:e}}function zC(e){return Array.isArray(e)?e=Buffer.from(e):typeof e=="string"&&(e=Buffer.from(e,"utf8")),BC.default.createHash("md5").update(e).digest()}var QC=zC;Hn.default=QC;Md.exports=Hn.default});var Ud=h((jn,jd)=>{"use strict";Object.defineProperty(jn,"__esModule",{value:!0});jn.default=void 0;var WC=Hd(No()),XC=Hd(Fd());function Hd(e){return e&&e.__esModule?e:{default:e}}var KC=(0,WC.default)("v3",48,XC.default),JC=KC;jn.default=JC;jd.exports=jn.default});var Bd=h((Un,Vd)=>{"use strict";Object.defineProperty(Un,"__esModule",{value:!0});Un.default=void 0;var YC=$d(Do()),ZC=$d(es());function $d(e){return e&&e.__esModule?e:{default:e}}function e0(e,t,r){var n=t&&r||0;typeof e=="string"&&(t=e==="binary"?new Array(16):null,e=null),e=e||{};var i=e.random||(e.rng||YC.default)();if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,t)for(var s=0;s<16;++s)t[n+s]=i[s];return t||(0,ZC.default)(i)}var t0=e0;Un.default=t0;Vd.exports=Un.default});var zd=h(($n,Gd)=>{"use strict";Object.defineProperty($n,"__esModule",{value:!0});$n.default=void 0;var r0=n0(require("crypto"));function n0(e){return e&&e.__esModule?e:{default:e}}function i0(e){return Array.isArray(e)?e=Buffer.from(e):typeof e=="string"&&(e=Buffer.from(e,"utf8")),r0.default.createHash("sha1").update(e).digest()}var s0=i0;$n.default=s0;Gd.exports=$n.default});var Xd=h((Vn,Wd)=>{"use strict";Object.defineProperty(Vn,"__esModule",{value:!0});Vn.default=void 0;var a0=Qd(No()),o0=Qd(zd());function Qd(e){return e&&e.__esModule?e:{default:e}}var u0=(0,a0.default)("v5",80,o0.default),c0=u0;Vn.default=c0;Wd.exports=Vn.default});var Kd=h(jr=>{"use strict";Object.defineProperty(jr,"__esModule",{value:!0});Object.defineProperty(jr,"v1",{enumerable:!0,get:function(){return l0.default}});Object.defineProperty(jr,"v3",{enumerable:!0,get:function(){return p0.default}});Object.defineProperty(jr,"v4",{enumerable:!0,get:function(){return f0.default}});Object.defineProperty(jr,"v5",{enumerable:!0,get:function(){return d0.default}});var l0=ts(qd()),p0=ts(Ud()),f0=ts(Bd()),d0=ts(Xd());function ts(e){return e&&e.__esModule?e:{default:e}}});var Yd=h((Ew,Jd)=>{"use strict";function h0(e){for(var t=5381,r=e.length;r;)t=t*33^e.charCodeAt(--r);return t>>>0}Jd.exports=h0});var C0={};_h(C0,{activate:()=>y0,deactivate:()=>_0});module.exports=Ch(C0);var nh=require("vscode");var N=require("vscode");var cs=require("console"),zn=require("fs"),he=require("vscode");function Ze(e,t,r){return{range:e,kind:t,value:r}}var ce=class{constructor(){}clearCache(){this._cache=void 0}parse(t){let r;return this._cache&&this._cache.uri==t.uri&&this._cache.version==t.version?r=this._cache.value:(r=ce.parseValue(this.tokenize(t)),this._cache={uri:t.uri,version:t.version,value:r}),r}static next(t){if(t){let r=t.next();if(r&&!r.done)return r.value}}static parseValue(t){let r=ce.next(t);if(r){let n=r.range.end;switch(r.kind){case 8:case 9:case 10:case 6:return{range:r.range,value:r.value};case 2:let i=[],s=[];for(;;){let u=ce.parseValue(t);if(u)i.push(u),s.push(u.value);else break;let c=ce.next(t);if(c==null||(n=c.range.end,c.kind==3))break;if(c.kind==4)continue;break}return{range:new he.Range(r.range.start,n),value:s,items:i};case 0:let a=[],o={};for(;;){let u=!1,c=ce.next(t);if(c==null)break;for(n=c.range.end;;){let f=ce.next(t);if(f==null||f.kind!=5){if(a.push({name:c,value:void 0}),o[c.value]=void 0,f&&f.kind==6){c=f;continue}u=!0;break}break}if(u)break;let l=ce.parseValue(t);if(a.push({name:c,value:l}),o[c.value]=l==null?void 0:l.value,l==null)break;n=l.range.end;let p=ce.next(t);if(p==null||(n=p.range.end,p.kind==1))break;if(p.kind!=4)break}return{properties:a,range:new he.Range(r.range.start,n),value:o};default:break}}}traverse(t,r,n,i){return E(this,null,function*(){if(t==null)return;let s=yield Promise.resolve(r(t,i));if(typeof s!="undefined")return s;let a=t;if(Array.isArray(a.items)){let o=0;for(let u of a.items)if(s=yield this.traverse(u,r,n,`${i}[${o++}]`),typeof s!="undefined")return s}else if(a.properties)for(let o of a.properties){if(s=yield Promise.resolve(n(o.name,o.value,i)),typeof s!="undefined")return s;let u=i?`${i}.${o.name.value}`:o.name.value;if(s=yield this.traverse(o.value,r,n,u),typeof s!="undefined")return s}})}*tokenize(t){let r=t.getText();for(let n=0;n<r.length;){let i=r[n],s=t.positionAt(n),a=new he.Range(s,new he.Position(s.line,s.character+1));switch(i){case"{":yield Ze(a,0);break;case"}":yield Ze(a,1);break;case"[":yield Ze(a,2);break;case"]":yield Ze(a,3);break;case",":yield Ze(a,4);break;case":":yield Ze(a,5);break;case'"':let o=ce.parseString(r,n);yield Ze(new he.Range(s,t.positionAt(o.end)),6,o.value),n=o.end;continue;default:if(i>="0"&&i<="9"||i=="-"){let c=ce.parseNumber(r,n);if(c){yield Ze(new he.Range(s,t.positionAt(n+c.length)),7,c.value),n+=c.length;continue}}let u=ce.tryParseLiteral(r,n);if(u){yield Ze(new he.Range(s,t.positionAt(n+u.length)),u.token,u.value),n+=u.length;continue}if(ce.isIdentifierChar(i)){let c=ce.parseIdentifier(r,n);if(c&&c.length>0){yield Ze(new he.Range(s,t.positionAt(n+c.length)),6,c.value),n+=c.length;continue}}break}n++}}static isIdentifierChar(t){return t>="a"&&t<="z"||t>="A"&&t<="Z"||t=="\\"||t=="/"||t=="_"}static parseIdentifier(t,r){let n=r;for(;r<t.length&&ce.isIdentifierChar(t[r]);r++);return{start:n,end:r,length:r-n,value:t.substring(n,r)}}static tryParseLiteral(t,r){let n={null:[null,8],true:[!0,9],false:[!1,10]},i=t[r];for(let s in n)if(i==s[0]&&t.substring(r).match(`/^${s}/i`))return{length:s.length,value:n[s][0],token:n[s][1]}}static parseNumber(t,r){let n=t.substring(r).match(/^-?[0-9]*(\.[0-9]*)?([eE][+\-]?[0-9]+)?/i);if(n){let i=n[0],s;return i.includes(".")||i.includes("e")||i.includes("E")?s=parseFloat(i):s=parseInt(i),{value:s,length:i.length}}}static parseString(t,r){(0,cs.assert)(r<t.length,"argument out of range"),(0,cs.assert)(t[r]=='"',"expecting double quote");let n=r,i=!1,s="",a=!1;for(r++;r<t.length&&!a;r++){let o=t[r];if(i){switch(o){case"b":s+="\b";break;case"f":s+="\f";break;case"n":s+=`
`;break;case"r":s+="\r";break;case"t":s+="	";break;case"u":let u=t.substring(r+1).match(/^[0-9a-z]{1,4}/i);u?s+=String.fromCodePoint(parseInt(u[0],16)):s+="u";break;default:s+=o;break}i=!1}else switch(o){case"\\":i=!0;break;case'"':a=!0;break;default:s+=o;break}}return{value:s,start:n,end:r}}},De=class extends ce{constructor(){super()}static parseComposerJson(t){return E(this,null,function*(){if(t&&(0,zn.existsSync)(t.fsPath))try{let r=yield he.workspace.fs.readFile(t);if(r&&r.length!=0)return JSON.parse(Buffer.from(r).toString("utf-8"))}catch(r){}})}static parseComposerLock(t){return E(this,null,function*(){let r=he.Uri.joinPath(t,"..","composer.lock");if((0,zn.existsSync)(r.fsPath))try{let n=yield he.workspace.fs.readFile(r);if(n&&n.length!=0)return JSON.parse(Buffer.from(n).toString("utf-8"))}catch(n){}})}static parseComposerInstalledJson(t){return E(this,null,function*(){let r=he.Uri.joinPath(t,"..","vendor/composer/installed.json");if((0,zn.existsSync)(r.fsPath))try{let n=yield he.workspace.fs.readFile(r);if(n&&n.length!=0)return JSON.parse(Buffer.from(n).toString("utf-8"))}catch(n){}})}static parsePackagesMeta(t){let r={};if(t)for(let n of["packages","packages-dev"]){let i=t[n];Array.isArray(i)&&i.forEach(s=>{s.name&&(r[s.name]=s)})}return r}resolvePackagesMeta(t){return E(this,null,function*(){let r={};return r=Object.assign(r,De.parsePackagesMeta(yield De.parseComposerLock(t))),r=Object.assign(r,De.parsePackagesMeta(yield De.parseComposerInstalledJson(t))),r})}},or=new De;var bh=require("vscode"),Th=Rt(ls());var Go=require("vscode"),Ih=Rt(ls());var zo=require("fs");var ps=class{constructor(){this.dictionary={};this.locale="en";try{if(process&&process.env){let t=JSON.parse(process.env.VSCODE_NLS_CONFIG);t&&typeof t.locale=="string"&&(this.locale=t.locale)}}catch(t){}}read_i18n(t){try{let r=Buffer.from((0,zo.readFileSync)(t)).toString("utf-8");return JSON.parse(r)}catch(r){return{}}}localize(t){let r=this.dictionary[t];if(typeof r=="string")return r}load(t){try{this.dictionary=Object.assign({},this.read_i18n(t.asAbsolutePath("package.nls.json")),this.read_i18n(t.asAbsolutePath("package.nls.en.json")),this.read_i18n(t.asAbsolutePath(`package.nls.${this.locale}.json`)))}catch(r){}}},Qo=new ps;function Wo(e){return E(this,null,function*(){yield Qo.load(e)})}function j(e,t){return xh(e,t)}function xh(e,t){var r,n;return(n=(r=Qo.localize(e))!=null?r:t)!=null?n:e}var z=class{static get description(){return j("description")}static get installed_version(){return j("installed_version")}static get action_update(){return j("action.update")}static get action_remove(){return j("action.remove")}static get composer_workingPath_description(){return j("composer.workingPath.description")}static get error_missingComposerLock(){return j("error.missingComposerLock")}static get task_composer_args_description(){return j("task.composer.args.description")}static get task_composer_command_description(){return j("task.composer.command.description")}static get commands_download_title(){return j("commands.download.title")}static get error_couldntGetComposer(){return j("error.couldntGetComposer")}static get codelens_install(){return j("codelens.install")}static get action_choose_folder(){return j("action.choose-folder")}static get action_open_folder(){return j("action.open-folder")}static get authors(){return j("authors")}static get composer_diagnosticsEnabled_description(){return j("composer.diagnosticsEnabled.description")}static get abandoned(){return j("abandoned")}static get title(){return j("title")}static get open_folder_title(){return j("open-folder.title")}static get codelens_update(){return j("codelens.update")}static get action_dontshowagain(){return j("action.dontshowagain")}static get action_install(){return j("action.install")}static get commands_search_title(){return j("commands.search.title")}static get capabilities_virtualWorkspaces_description(){return j("capabilities.virtualWorkspaces.description")}static get capabilities_untrustedWorkspaces_description(){return j("capabilities.untrustedWorkspaces.description")}static get error_nonEmptyFolder(){return j("error.nonEmptyFolder")}static get composer_bin_description(){return j("composer.bin.description")}static get codelens_check(){return j("codelens.check")}static get composer_inlayVersionEnabled_description(){return j("composer.inlayVersionEnabled.description")}static get action_dismiss(){return j("action.dismiss")}};var Xo=require("fs");function Ko(e){return e.map(t=>String.fromCharCode(t)).join("")}function Jo(e,t){return E(this,null,function*(){let r=yield new Promise(n=>{(0,Xo.writeFile)(e,t,i=>{n(i)})});if(r)throw r})}var le=class{constructor(){this.disposables=[]}push(t){this.disposables.push(t)}onDispose(){}dispose(){try{this.onDispose()}catch(t){}for(let t of this.disposables)t.dispose();this.disposables=[]}};var Yo=require("fs");function Zo(e){return new Promise((t,r)=>{(0,Yo.readdir)(e,(n,i)=>{n?t(!0):i&&i.length!=0?t(!1):t(!0)})})}var fs=require("vscode");function eu(e){return e==null?!1:fs.tasks.taskExecutions.includes(e)==!1?!0:new Promise(t=>{let r=fs.tasks.onDidEndTask(n=>{n.execution==e&&(r.dispose(),t(!0))})})}var $r=require("vscode");function Vr(e){var t=$r.workspace.getConfiguration(null,e).get("composer.workingPath","");return t&&t!=""&&t!="."?$r.Uri.joinPath(e,t):e}function tu(){var e=$r.workspace.getConfiguration(null).get("composer.bin","");if(e&&e!=""&&e!=null&&typeof e=="string")return e}var ds=class extends le{constructor(r,n){super();this.taskProvider=r;this.packagist=n;this.parser=or}registerCommand(r,n,i){this.push(N.commands.registerCommand(r,(...s)=>E(this,null,function*(){let a;if(n&&(n.requiresCwd||n.requiresComposerJson)&&(a=yield this.pickCwd(s,n&&n.requiresComposerJson,n&&n.enableOpenFolder),typeof a=="undefined"))return!1;s&&s.length!=0&&typeof s[0]=="string"&&s[0].endsWith("composer.json")&&s.shift(),i(a,...s)})))}QuickPickPackage(r,n,i){return new Promise(s=>{let a=N.window.createQuickPick(),o="require",u="packagist.org";a.canSelectMany=!1,a.title=r!=null?r:"Search package to install ...",a.placeholder=n!=null?n:"package name",a.items=[],a.onDidAccept(c=>E(this,null,function*(){let l=a.selectedItems&&a.selectedItems.length!=0?a.selectedItems[0].label:a.value.trim();s(l),a.hide()})),a.onDidHide(c=>s(void 0)),a.onDidChangeValue(c=>E(this,null,function*(){let l=i?[{tooltip:o,iconPath:new N.ThemeIcon("cloud-download")},{tooltip:u,iconPath:new N.ThemeIcon("link-external")}]:void 0,p=yield this.packagist.search(c.trim());if(a.value==c&&p&&Array.isArray(p.results)){let f=[];p.results.forEach(d=>{var x,A;let g=(x=d.downloads)!=null?x:0,b=(A=d.favers)!=null?A:0;f.push({label:d.name,description:`    $(extensions-install-count) ${g.toLocaleString("en-US",{maximumFractionDigits:0})}  $(star-full) ${b.toLocaleString("en-US",{maximumFractionDigits:0})}`,detail:d.description,buttons:l})}),a.items=f}})),a.onDidTriggerItemButton(c=>E(this,null,function*(){switch(c.button.tooltip){case o:yield this.taskProvider.executeComposerTask("require",[c.item.label],void 0);break;case u:let l=`https://packagist.org/packages/${c.item.label}`;yield N.env.openExternal(N.Uri.parse(l));break}})),a.show()})}pickCwd(r,n,i){return E(this,null,function*(){if(r&&r.length>=1&&typeof r[0]=="string"&&r[0].endsWith("composer.json"))return N.Uri.joinPath(N.Uri.parse(r[0]),"..").fsPath;let s=N.workspace.workspaceFolders;if(s){if(s.length==1)return Vr(s[0].uri).fsPath;if(s.length>1){let a=yield N.window.showWorkspaceFolderPick({placeHolder:"Select the command's working directory ..."});if(a)return Vr(a.uri).fsPath}return}if(i){let a=yield N.window.showOpenDialog({canSelectMany:!1,canSelectFiles:!1,canSelectFolders:!0,openLabel:z.action_choose_folder});return a&&a.length==1?a[0].fsPath:void 0}if(N.window.activeTextEditor){let a=N.Uri.joinPath(N.window.activeTextEditor.document.uri,"..");if(a.scheme=="file")return a.fsPath}})}pickInstalledPackage(r,n,i){return E(this,null,function*(){var p,f;let s=N.Uri.joinPath(N.Uri.file(r),"composer.json"),a=yield De.parseComposerJson(s),o=[],u="(dev) ";if(a){let d=(g,b,x)=>{g!="php"&&!g.startsWith("ext-")&&o.push({label:g,description:`${x?u:""}${b}`})};for(let g in(p=a.require)!=null?p:{})d(g,a.require[g],!1);for(let g in(f=a["require-dev"])!=null?f:{})d(g,a["require-dev"][g],!0)}let c=d=>({pkgname:d.label,dev:d.description.startsWith(u)}),l=yield N.window.showQuickPick(o,{canPickMany:i!=null?i:!1,title:n!=null?n:"",placeHolder:"Package name"});return l?Array.isArray(l)?l.map(d=>c(d)):[c(l)]:[]})}},Qn=class extends ds{constructor(t,r,n){super(r,n),this.registerCommand("composer.install",{requiresComposerJson:!0},(i,...s)=>E(this,null,function*(){return yield r.executeComposerTask("install",s,i)})),this.registerCommand("composer.update",{requiresComposerJson:!0},(i,...s)=>E(this,null,function*(){return yield r.executeComposerTask("update",s,i)})),this.registerCommand("composer.remove",{requiresComposerJson:!0},(i,...s)=>E(this,null,function*(){if(s.length==0){let a=yield this.pickInstalledPackage(i,"Select package to remove",!0),o=a.filter(c=>c.dev).map(c=>c.pkgname),u=a.filter(c=>!c.dev).map(c=>c.pkgname);o.length!=0&&(yield r.executeComposerTask("remove",[...o,"--dev"],i)),u.length!=0&&(yield r.executeComposerTask("remove",u,i))}else return yield r.executeComposerTask("remove",s,i)})),this.registerCommand("composer.create-project",{requiresCwd:!0,enableOpenFolder:!0},(i,...s)=>E(this,null,function*(){if(t.appendLine(`Project will be created in '${i}' ...`),!(yield Zo(i)))throw t.appendLine(z.error_nonEmptyFolder),N.window.showErrorMessage(z.error_nonEmptyFolder),new Error(z.error_nonEmptyFolder);let a=s.length?s[0]:yield this.QuickPickPackage();if(a){t.appendLine(`About to create project from package '${a}' ...`);let o=yield this.taskProvider.executeComposerTask("create-project",[a,"."],i);N.workspace.workspaceFolders||(yield eu(o),(yield N.window.showInformationMessage(`${z.open_folder_title} (${i})`,z.action_open_folder,z.action_dismiss))==z.action_open_folder&&(yield N.commands.executeCommand("vscode.openFolder",N.Uri.file(i))))}})),this.registerCommand("composer.require",{requiresCwd:!0},(i,...s)=>E(this,null,function*(){let a=s.length?s[0]:yield this.QuickPickPackage();a&&(yield this.taskProvider.executeComposerTask("require",[a],i))})),this.registerCommand("composer.require-dev",{requiresCwd:!0},(i,...s)=>E(this,null,function*(){let a=s.length?s[0]:yield this.QuickPickPackage();a&&(yield this.taskProvider.executeComposerTask("require",[a,"--dev"],i))})),this.registerCommand("composer.run-script",{requiresComposerJson:!0},(i,...s)=>E(this,null,function*(){let a;if(s&&s.length>0)a=s[0];else{let o=N.Uri.joinPath(N.Uri.file(i),"composer.json"),u=yield De.parseComposerJson(o);if(u&&typeof u.scripts=="object"){let c=[];for(let l in u.scripts)c.push(l);a=yield N.window.showQuickPick(c,{title:"Select script to run ...",placeHolder:"script name"})}else{N.window.showErrorMessage(`'${"composer.json"}' could not be parsed`);return}}a&&(yield this.taskProvider.executeComposerTask("run-script",[a],i))})),this.registerCommand("composer.search",{},(i,...s)=>E(this,null,function*(){let a=yield this.QuickPickPackage("Search packages ...","filter",!0);if(a){let o=`https://packagist.org/packages/${a}`;yield N.env.openExternal(N.Uri.parse(o))}})),this.registerCommand("composer.about",{},()=>E(this,null,function*(){return yield this.taskProvider.executeComposerTask("about")})),this.registerCommand("composer.archive",{requiresCwd:!0},i=>E(this,null,function*(){let s=yield N.window.showInputBox({placeHolder:"[package] [version] --format=tar",title:"Create package archive.",prompt:'"composer archive" options'});typeof s!="undefined"&&(yield this.taskProvider.executeComposerTask("archive",s?s.split(" "):[],i))})),this.registerCommand("composer.clear-cache",{},()=>E(this,null,function*(){return yield this.taskProvider.executeComposerTask("clear-cache")})),this.registerCommand("composer.fund",{requiresComposerJson:!0},i=>E(this,null,function*(){return yield this.taskProvider.executeComposerTask("fund",[],i)})),this.registerCommand("composer.check-platform-reqs",{requiresComposerJson:!0},i=>E(this,null,function*(){return yield this.taskProvider.executeComposerTask("check-platform-reqs",[],i)})),this.registerCommand("composer.licenses",{requiresComposerJson:!0},i=>E(this,null,function*(){return yield this.taskProvider.executeComposerTask("licenses",[],i)})),this.registerCommand("composer.outdated",{requiresComposerJson:!0},i=>E(this,null,function*(){return yield this.taskProvider.executeComposerTask("outdated",[],i)})),this.registerCommand("composer.reinstall",{requiresComposerJson:!0},i=>E(this,null,function*(){return yield this.taskProvider.executeComposerTask("reinstall",[],i)})),this.registerCommand("composer.show-tree",{requiresComposerJson:!0},i=>E(this,null,function*(){return yield this.taskProvider.executeComposerTask("show",["--tree"],i)}))}};var V=require("vscode");function ru(e){return e&&(e.path.endsWith("composer.json")||e.path.endsWith("composer.lock"))}var Sh=-99999;function kh(e,t){let r=[...t.matchAll(/\r?\n/g)];return{uri:e,version:Sh++,getText:()=>t,positionAt:n=>{let i=new V.Position(0,n);if(r){let s=0;for(let a of r){let o=a.index+a.length;if(o<=n)i=new V.Position(++s,n-o);else break}}return i}}}var Wn=class extends le{constructor(){super();this.parser=or;this.documents=new Map;this.timeouts=new Map;this.push(this.collection=V.languages.createDiagnosticCollection("Composer"));let r;this.push(r=V.workspace.createFileSystemWatcher("**/composer.*")),this.push(V.workspace.onDidOpenTextDocument(n=>this.updateFromDocument(n))),this.push(V.workspace.onDidChangeTextDocument(n=>this.updateFromDocument(n.document))),this.push(V.workspace.onDidCloseTextDocument(n=>this.updateFromFs(n.uri))),this.push(V.workspace.onDidChangeConfiguration(n=>{n.affectsConfiguration("composer.diagnosticsEnabled")})),r.onDidChange(n=>this.updateFromFs(n)),r.onDidDelete(n=>this.updateFromFs(n)),r.onDidCreate(n=>this.updateFromFs(n)),V.workspace.workspaceFolders&&V.workspace.workspaceFolders.forEach(n=>E(this,null,function*(){yield this.updateFromFs(V.Uri.joinPath(n.uri,"composer.json")),yield this.updateFromFs(V.Uri.joinPath(n.uri,"composer.lock")),yield this.update(n.uri)}))}updateFromFs(r){return E(this,null,function*(){if(ru(r)){this.documents.delete(r.toString(!0));try{let n=yield V.workspace.fs.readFile(r);n&&n.length&&this.documents.set(r.toString(!0),kh(r,Buffer.from(n).toString("utf-8")))}catch(n){}yield this.setDirty(V.Uri.joinPath(r,".."))}})}updateFromDocument(r){return E(this,null,function*(){ru(r.uri)&&(this.documents.set(r.uri.toString(!0),r),yield this.setDirty(V.Uri.joinPath(r.uri,"..")))})}setDirty(r){return E(this,null,function*(){let n=r.toString(!0),i=this.timeouts.get(n);i?i.refresh():this.timeouts.set(n,setTimeout(()=>E(this,null,function*(){this.timeouts.delete(n),yield this.update(r)}),500))})}update(r){return E(this,null,function*(){let n=V.Uri.joinPath(r,"composer.json"),i=V.Uri.joinPath(r,"composer.lock"),s=this.documents.get(n.toString(!0)),a=this.documents.get(i.toString(!0)),o=[];if(s&&a&&V.workspace.getConfiguration().get("composer.diagnosticsEnabled",!0)!=!1){let u=De.parsePackagesMeta(JSON.parse(a.getText())),c=this.parser.parse(s);yield this.parser.traverse(c,(l,p)=>{},(l,p,f)=>{if(typeof l.value=="string"&&(f=="require"||f=="require-dev")){let d=u[l.value];if(d&&d.abandoned){let g=new V.Diagnostic(l.range,`'${l.value}' has been abandoned.`,V.DiagnosticSeverity.Warning);g.source="Composer",g.code="abandoned",g.tags=[V.DiagnosticTag.Deprecated],o.push(g)}}})}o.length?this.collection.set(n,o):this.collection.delete(n)})}};var P=require("vscode");var Br={scheme:"file",language:"json",pattern:"**/composer.json"},Ot=class extends le{constructor(r,n){super();this.taskProvider=r;this.packagist=n;this.parser=or;this.push(this.onDidChangeCodeLensesEmitter=new P.EventEmitter),this.onDidChangeCodeLenses=this.onDidChangeCodeLensesEmitter.event,this.push(this.onDidChangeInlayHintsEmitter=new P.EventEmitter),this.onDidChangeInlayHints=this.onDidChangeInlayHintsEmitter.event,this.push(P.languages.registerHoverProvider(Br,this)),this.push(P.languages.registerInlayHintsProvider(Br,this)),this.push(P.languages.registerCodeLensProvider(Br,this)),this.push(P.languages.registerCompletionItemProvider(Br,this,":",'"')),this.push(P.languages.registerCodeActionsProvider(Br,this,{})),this.push(P.workspace.onDidChangeConfiguration(s=>{s.affectsConfiguration("composer.inlayVersionEnabled")&&this.onDidChangeInlayHintsEmitter.fire()}));let i;this.push(i=P.workspace.createFileSystemWatcher("**/composer.lock")),i.onDidDelete(s=>this.onDidChangeInlayHintsEmitter.fire()),i.onDidCreate(s=>this.onDidChangeInlayHintsEmitter.fire()),i.onDidChange(s=>this.onDidChangeInlayHintsEmitter.fire())}provideCodeActions(r,n,i,s){return E(this,null,function*(){let a=[],o=this.parser.parse(r);return yield this.parser.traverse(o,u=>{},(u,c,l)=>E(this,null,function*(){if((l=="require"||l=="require-dev")&&(n.intersection(u.range)||c&&c.range.intersection(n))){if(u.value=="php"||u.value.startsWith("ext-"))return;let p=l=="require-dev";(yield this.parser.resolvePackagesMeta(r.uri))[u.value]==null&&a.push({command:p?"composer.require-dev":"composer.require",title:`require "${u.value}"${p?" --dev":""}`,tooltip:"",arguments:[r.uri.toString(!0),u.value]}),a.push({command:"composer.update",title:`${z.action_update} "${u.value}"`,tooltip:"",arguments:[r.uri.toString(!0),u.value]}),a.push({command:"composer.remove",title:`${z.action_remove} "${u.value}"`,tooltip:"",arguments:[r.uri.toString(!0),u.value,p?"--dev":""]})}})),a})}provideCompletionForVersions(r,n){return E(this,null,function*(){let i=yield this.packagist.packageData(n),s=i!=null&&i.packages?i.packages[n]:void 0,a=[];if(Array.isArray(s)&&s.length){let o=new Set;a=s.filter(u=>u.version_normalized).map((u,c)=>{let l=u.version_normalized.split("."),p=l&&l.length>=2?new P.CompletionItem(`"^${l[0]}.${l[1]}"`):new P.CompletionItem(`"${u.version}"`);return p.range=r,p.filterText=` ${p.label}`,p.sortText=c.toString().padStart(8,"0"),p}).filter(u=>typeof u.label=="string"&&!o.has(u.label)&&o.add(u.label))}return{items:a,isIncomplete:!1}})}provideCompletionItems(r,n,i,s){return E(this,null,function*(){let a=this.parser.parse(r);return yield this.parser.traverse(a,o=>{},(o,u,c)=>E(this,null,function*(){var l;if(c=="require"||c=="require-dev"){if(o.range.contains(n)&&typeof o.value=="string"){let p=o.value.trim();if(p.length==0)return;let f=[],d=(l=r.getWordRangeAtPosition(n))!=null?l:new P.Range(n,n),g=yield this.packagist.search(p);return g&&g.results&&g.results.forEach(b=>{let x=new P.CompletionItem(b.name,P.CompletionItemKind.Reference);x.detail=b.description,x.documentation=Ot.descriptionForPackage(b,!1,!0,!0),x.insertText=`"${b.name}"`,b.abandoned&&(x.tags=[P.CompletionItemTag.Deprecated]),x.commitCharacters=[":",'"'," "],x.additionalTextEdits=[P.TextEdit.delete(o.range.with({end:d.start})),P.TextEdit.delete(o.range.with({start:d.end}))],f.push(x)}),{items:f,isIncomplete:!0}}if(u&&u.range.contains(n))return yield this.provideCompletionForVersions(u.range,o.value);if(o.range.end.line==n.line&&o.range.end.character<n.character&&r.getText(new P.Range(o.range.end,n)).trim()==":")return yield this.provideCompletionForVersions(new P.Range(n,n),o.value)}}))})}provideCodeLenses(r,n){return E(this,null,function*(){let i=[],s=new P.Range(0,0,0,0);i.push(new P.CodeLens(s,{title:`$(desktop-download) ${z.codelens_install}`,tooltip:"composer install",command:"composer.install",arguments:[r.uri.toString(!1)]}),new P.CodeLens(s,{title:`$(refresh) ${z.codelens_update}`,tooltip:"composer update",command:"composer.update",arguments:[r.uri.toString(!1)]}),new P.CodeLens(s,{title:`$(check) ${z.codelens_check}`,tooltip:"composer check-platform-reqs",command:"composer.check-platform-reqs",arguments:[r.uri.toString(!1)]}));let a=this.parser.parse(r);return yield this.parser.traverse(a,o=>{},(o,u,c)=>{c=="scripts"&&typeof o.value=="string"&&i.push(new P.CodeLens(o.range,{title:"$(run) Run",tooltip:`Run the script '${o.value}'`,command:"composer.run-script",arguments:[r.uri.toString(!1),o.value]}))}),i})}provideInlayHints(r,n,i){return E(this,null,function*(){let s=[];if(P.workspace.getConfiguration().get("composer.inlayVersionEnabled",!0)==!1)return s;let a=yield this.parser.resolvePackagesMeta(r.uri),o=this.parser.parse(r);return yield this.parser.traverse(o,u=>{},(u,c,l)=>{if((l=="require"||l=="require-dev")&&n.contains(u.range)&&c){let p=a[u.value];if(p&&p.version){let f=new P.InlayHintLabelPart(`(${p.version})`);f.tooltip=`${z.installed_version}`;let d=new P.InlayHint(c.range.end,[f],P.InlayHintKind.Type);d.paddingLeft=!0,d.textEdits=[],s.push(d)}}}),s})}static descriptionForPackage(r,n,i,s){var a,o;if(r&&r.name){let u=new P.MarkdownString("",!0);u.supportHtml=!0;let c=[],l="";if(r.version&&(l=`_(${r.version})_`),u.appendMarkdown(`**${r.name}** ${l}

`),r.authors&&Array.isArray(r.authors)){let p=r.authors.map(f=>`$(person) ${f.name}`).filter(f=>f).join(", ");p&&u.appendMarkdown(`**${z.authors}:** ${p}<br/>`)}if(r.abandoned&&u.appendMarkdown(`$(stop) **${z.abandoned}** ${r.abandoned}<br/>`),i&&typeof r.downloads=="number"&&u.appendMarkdown(`$(extensions-install-count) ${r.downloads.toLocaleString("en-US",{maximumFractionDigits:0})}<br/>`),s&&typeof r.favers=="number"&&u.appendMarkdown(`$(star-full) ${r.favers.toLocaleString("en-US",{maximumFractionDigits:0})}<br/>`),u.appendMarkdown(`

`),(typeof n=="undefined"||n)&&u.appendMarkdown(`${(a=r.description)!=null?a:""}

`),c.push(`[Packagist](https://packagist.org/packages/${r.name})`),(o=r.source)!=null&&o.url){let p=r.source.url,f="Source",d=p.replace(/\.git$/,"");c.push(`[${f}](${d})`)}return r.homepage&&c.push(`[Homepage](${r.homepage})`),u.appendMarkdown(c.join(" | ")),u}}provideHover(r,n,i){return E(this,null,function*(){let s=yield this.parser.resolvePackagesMeta(r.uri),a=this.parser.parse(r);return yield this.parser.traverse(a,o=>{},(o,u,c)=>{if((c=="require"||c=="require-dev")&&o.range.contains(n)){let l=s[o.value];if(l&&l.name)return new P.Hover(Ot.descriptionForPackage(l),o.range)}})})}};var vs=require("fs"),et=require("vscode");var nu="composer.lock.check",Xn=class extends le{constructor(r,n){super();this.context=r;this.taskprovider=n;if(this.enabled){let i;this.push(et.workspace.onDidChangeWorkspaceFolders(s=>this.updateFolders(s.added))),this.push(i=et.workspace.createFileSystemWatcher("**/composer.lock",!0,!0,!1)),i.onDidDelete(s=>E(this,null,function*(){s.fsPath.endsWith("composer.lock")&&(yield this.updateFolder(et.workspace.getWorkspaceFolder(s)))})),this.updateFolders(et.workspace.workspaceFolders)}}updateFolders(r){r&&r.length!=0&&r.forEach(n=>this.updateFolder(n))}updateFolder(r){return E(this,null,function*(){if(!r||!r.uri||r.uri.scheme!="file")return;let n=et.Uri.joinPath(r.uri,"composer.json"),i=et.Uri.joinPath(r.uri,"composer.lock");try{(0,vs.existsSync)(n.fsPath)&&!(0,vs.existsSync)(i.fsPath)&&(yield this.popup(r))}catch(s){}})}get enabled(){return this.context.globalState.get(nu,!0)!=!1}set enabled(r){this.context.globalState.update(nu,r)}popup(r){return E(this,null,function*(){if(!r&&r.uri.scheme!="file"||!this.enabled)return;let n=z.action_install,i=z.action_dontshowagain,s=yield et.window.showWarningMessage(z.error_missingComposerLock,n,i);s==n?yield this.taskprovider.executeComposerTask("install",[],Vr(r.uri).fsPath):s==i&&(this.enabled=!1)})}};var Be=require("fs"),Ct=require("process"),cr=require("vscode");var Fu=Rt(require("https")),Hu=require("url");var Lu=require("url"),dv=Au(),hv=Nu();function vv(e){return e.protocol==="http:"?process.env.HTTP_PROXY||process.env.http_proxy||null:e.protocol==="https:"&&(process.env.HTTPS_PROXY||process.env.https_proxy||process.env.HTTP_PROXY||process.env.http_proxy)||null}function Mu(e,t,r){let n=t||vv(e);if(!n)return null;let i=(0,Lu.parse)(n);if(!/^https?:$/.test(i.protocol))return null;let s={host:i.hostname,port:Number(i.port),auth:i.auth,rejectUnauthorized:gv(r)?r:!0};return e.protocol==="http:"?new dv(s):new hv(s)}function gv(e){return e===!0||e===!1}function ju(e,t,r,n,i){return E(this,null,function*(){t.appendLine("Downloading "+e+" ..."),t.appendLine("  URL: "+n);try{return xs(e,n,t,r).then(s=>(t.appendLine("OK."),s))}catch(s){if(i){t.appendLine(`
  Alternative URL: `+i);try{let a=yield xs(e,i,t,r);return t.appendLine("OK."),a}catch(a){throw s}}else throw s}})}function xs(e,t,r,n){return E(this,null,function*(){let i=(0,Hu.parse)(t),s=n(),a=s.proxy,o=s.strictSSL,u={host:i.hostname,path:i.path,agent:Mu(i,a,o),port:i.port,timeout:15*60*1e3,rejectUnauthorized:mv(o)?o:!0},c=[];return new Promise((l,p)=>{let f=Fu.request(u,d=>{if(d.statusCode===301||d.statusCode===302)return r.appendLine(`
  Redirect: ${d.headers.location}`),l(xs(e,d.headers.location,r,n));if(d.statusCode!=200)return r.appendLine(`
  Download failure: status code '${d.statusCode}'`),p(new Error(d.statusCode.toString()));let g=parseInt(d.headers["content-length"]),b=0,x=0,A=`  Downloading (${Math.floor(g/1024)}kB):`;r.append(A),d.on("data",y=>{b+=y.length,c.push(y);let w=Math.ceil(A.length*(b/g));for(;x<w;)r.append("."),x++}),d.on("end",()=>{l(Buffer.concat(c))}),d.on("error",y=>{p(new Error(`Failed to download from ${t}. Error Message: ${y.message} || 'NONE'}`))})});f.on("error",d=>{r.appendLine(`
  Error: ${d.message}`),p(new Error(`Request error: ${d.message||"NONE"}`))}),f.end()})})}function mv(e){return e===!0||e===!1}var Uu=require("vscode"),ei=class{constructor(t,r){this.proxy=t;this.strictSSL=r}};function $u(){return()=>{let e=Uu.workspace.getConfiguration(),t=e.get("http.proxy"),r=e.get("http.proxyStrictSSL",!0);return new ei(t,r)}}var yv=["/usr/bin/composer","/usr/local/bin/composer"],Vu="latest.phar.timestamp",_v=30*24*60*60;function Bu(){return Date.now()/1e3}var ti=class extends le{constructor(r,n){super();this.context=r;this.log=n;cr.workspace.onDidChangeConfiguration(s=>{s.affectsConfiguration("composer.bin")&&this.updatePath()}),cr.commands.registerCommand("composer.download",()=>E(this,null,function*(){return yield this.getOrDownloadComposerPhar(!0)}));var i=this.updatePath();i.userbin!=!0&&this.tryUpdate()}getUserDir(){let r=Ct.platform=="win32"?"APPDATA":"HOME",n=Ct.env[r];if(n)return n.replace("\\","/").trim()}getHomeDir(){var s,a;let r=Ct.env["COMPOSER_HOME"];if(r)return r.trim();let n=this.getUserDir();if(n==null)return;if(Ct.platform=="win32")return`${n}/Composer`;let i=[];if((0,Be.existsSync)("/etc/xdg")){let o=(s=Ct.env.XDG_CONFIG_HOME)!=null?s:`${n}/.config`;i.push(`${o}/composer`)}return i.push(`${n}/.composer`),(a=i.find(o=>(0,Be.existsSync)(o)))!=null?a:i[0]}getComposerHome(){let r=this.getHomeDir();if(r==null||!r){this.log.appendLine(`Cannot determine composer home directory. Please set '${"COMPOSER_HOME"}' environment variable.`);return}if(r=r.replaceAll("\\","/").trim(),(0,Be.existsSync)(r))try{(0,Be.chmodSync)(r,511)}catch(n){}else{this.log.appendLine(`Creating folder '${r}' for 'composer.phar' installation.`),this.log.appendLine(`This can be customized using the '${"COMPOSER_HOME"}' environment variable.`);try{(0,Be.mkdirSync)(r,511)}catch(n){}}return r}resolveComposerPharPath(){var r=tu();if(r)return{path:r,userbin:!0};for(let s of yv)if((0,Be.existsSync)(s))return{path:s,userbin:!0};let n=this.getComposerHome(),i=`${n}/composer.phar`;return(0,Be.existsSync)(i)?{path:i,userbin:!0}:{path:`${n}/latest.phar`}}updatePath(){let r=this.resolveComposerPharPath();return this.path=r.path,Ct.platform=="win32"&&(this.path=this.path.replaceAll("/","\\")),console.log(`composer bin: '${this.path}'`),r}tryUpdate(){return E(this,null,function*(){var r=this.context.globalState.get(Vu,void 0);r===void 0?yield cr.commands.executeCommand("composer.download"):r&&typeof r=="number"&&Bu()-r>_v&&(this.log.appendLine("  Updating composer.phar since the local version is more than 30 days old ..."),yield cr.commands.executeCommand("composer.download"))})}getOrDownloadComposerPhar(r){return E(this,null,function*(){for(let n=0;n<3;n++){if(r||!(0,Be.existsSync)(this.path)){let i;try{i=yield ju("composer.phar",this.log,$u(),"https://getcomposer.org/composer.phar")}catch(s){}if(i&&i.byteLength>1024*1024)try{yield Jo(this.path,i),this.context.globalState.update(Vu,Bu()),this.log.appendLine(`  composer.phar downloaded to '${this.path}'.`)}catch(s){this.log.appendLine(`  Error writing file '${this.path}': ${s.message}`);continue}else{i&&i.byteLength>0&&this.log.appendLine(`  Error: only ${i.byteLength} bytes downloaded.`);continue}}return this.path}})}};var fe=require("vscode");var ri=class extends le{constructor(r){super();this.composerphar=r;this.push(fe.tasks.registerTaskProvider("composer",{provideTasks:()=>[],resolveTask:(n,i)=>E(this,null,function*(){let s;return typeof n.scope=="object"&&n.scope.uri&&(s=n.scope.uri.fsPath),yield this.createTask(n.definition,s)})}))}getPhpToolsApi(){return E(this,null,function*(){var r,n;if(this.phptools==null){let i=fe.extensions.getExtension("devsense.phptools-vscode");i?this.phptools=(r=yield i.activate())!=null?r:{}:this.phptools={}}return(n=this.phptools)!=null?n:{}})}getPhpCommand(){return E(this,null,function*(){let r=yield this.getPhpToolsApi();if(r&&r.phpBin){let i=yield r.phpBin();if(i)return i}let n=fe.workspace.getConfiguration().get("php.executablePath");return n!==void 0&&n&&typeof n=="string"&&n!="php"?n:"php"})}executeComposerTask(r,n,i){return E(this,null,function*(){return yield fe.tasks.executeTask(yield this.createComposerTask(r,n,i))})}createComposerTask(r,n,i){return E(this,null,function*(){return yield this.createTask({type:"composer",command:r,args:n},i)})}createTask(r,n){return E(this,null,function*(){var o,u;let i=yield this.composerphar.getOrDownloadComposerPhar();if(i===void 0){fe.window.showErrorMessage(z.error_couldntGetComposer);return}let s=yield this.getPhpCommand();s[0]=='"'&&s[s.length-1]=='"'&&(s=s.substring(1,s.length-1));let a=[{value:i,quoting:fe.ShellQuoting.Strong},r.command];return r.args&&r.args.forEach(c=>{a.push({value:c!=null?c:"",quoting:fe.ShellQuoting.Strong})}),new fe.Task(r,(o=r.scope)!=null?o:fe.TaskScope.Workspace,(u=r.name)!=null?u:`composer ${r.command}`,"composer",new fe.ShellExecution(s,a,{cwd:n}))})}};var Gu=Rt(require("https"));var Cv=5*60*1e3,ni=class extends le{constructor(){super();this.cache={}}request(r){let n=this.cache[r];return n&&n.json&&n.timestamp+Cv>Date.now()?n.json:new Promise((i,s)=>{let a=[];Gu.get(r,o=>{o.on("data",u=>{a.push(u)}),o.on("end",()=>{let u=JSON.parse(Buffer.concat(a).toString("utf-8"));this.cache[r]={json:u,timestamp:Date.now()},i(u)}),o.on("error",u=>{s(u)})})})}searchByTag(r){return E(this,null,function*(){return yield this.request(`https://packagist.org/search.json?tags=${r}`)})}search(r){return E(this,null,function*(){return yield this.request(`https://packagist.org/search.json?query=${r}`)})}packageData(r){return E(this,null,function*(){return yield this.request(`https://repo.packagist.org/p2/${r}.json`)})}};var rs=Rt(Sd()),Lo=require("os"),eh=require("vscode"),th=Rt(Kd());var v0=Rt(_a()),Ur,g0=[101,56,52,97,53,57,53,55,45,100,54,56,48,45,52,99,99,53,45,57,50,54,55,45,53,101,53,101,51,100,48,97,56,100,53,55],Zd={};function rh(e){rs.Configuration.setAutoCollectExceptions(!0).setUseDiskRetryCaching(!0).setAutoCollectConsole(!0,!0).setInternalLogging(!0,!0),Ur=new rs.TelemetryClient(Ko(g0)),Ur.context.tags["ai.device.model"]="Visual Studio Code "+eh.version,Ur.context.tags["ai.user.id"]=(0,Lo.userInfo)().username,Ur.context.tags["ai.user.accountId"]=Yd()((0,Lo.userInfo)().username).toString(),Ur.context.tags["ai.session.id"]=(0,th.v1)(),Mo("extension loaded (composer)")}function Mo(e,t){t==null&&(t={});for(let r in Zd)t[r]=Zd[r];Ur.trackEvent({name:e,properties:t})}var m0;function y0(e){return E(this,null,function*(){return rh(e),Wo(e),e.subscriptions.push(m0=new Fo(e)),{}})}function _0(){return E(this,null,function*(){Mo("extension unloaded (composer)")})}var Fo=class extends le{constructor(r){super();this.push(this.log=nh.window.createOutputChannel("Composer")),this.push(this.packagist=new ni),this.push(this.composerphar=new ti(r,this.log)),this.push(this.taskprovider=new ri(this.composerphar)),this.push(new Qn(this.log,this.taskprovider,this.packagist)),this.push(new Ot(this.taskprovider,this.packagist)),this.push(new Xn(r,this.taskprovider)),this.push(new Wn)}};0&&(module.exports={activate,deactivate});
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */
/**
 * Wrapper for built-in http.js to emulate the browser XMLHttpRequest object.
 *
 * This can be used with JS designed for browsers to improve reuse of code and
 * allow the use of existing libraries.
 *
 * Usage: include("XMLHttpRequest.js") and use XMLHttpRequest per W3C specs.
 *
 * @author Dan DeFelippi <dan@driverdan.com>
 * @contributor David Ellis <d.f.ellis@ieee.org>
 * @license MIT
 */
